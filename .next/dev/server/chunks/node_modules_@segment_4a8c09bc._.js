module.exports = [
"[project]/node_modules/@segment/analytics-core/dist/esm/utils/bind-all.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "bindAll",
    ()=>bindAll
]);
function bindAll(obj) {
    var proto = obj.constructor.prototype;
    for(var _i = 0, _a = Object.getOwnPropertyNames(proto); _i < _a.length; _i++){
        var key = _a[_i];
        if (key !== 'constructor') {
            var desc = Object.getOwnPropertyDescriptor(obj.constructor.prototype, key);
            if (!!desc && typeof desc.value === 'function') {
                obj[key] = obj[key].bind(obj);
            }
        }
    }
    return obj;
} //# sourceMappingURL=bind-all.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/callback/index.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "invokeCallback",
    ()=>invokeCallback,
    "pTimeout",
    ()=>pTimeout,
    "sleep",
    ()=>sleep
]);
function pTimeout(promise, timeout) {
    return new Promise(function(resolve, reject) {
        var timeoutId = setTimeout(function() {
            reject(Error('Promise timed out'));
        }, timeout);
        promise.then(function(val) {
            clearTimeout(timeoutId);
            return resolve(val);
        }).catch(reject);
    });
}
function sleep(timeoutInMs) {
    return new Promise(function(resolve) {
        return setTimeout(resolve, timeoutInMs);
    });
}
function invokeCallback(ctx, callback, delay) {
    var cb = function() {
        try {
            return Promise.resolve(callback(ctx));
        } catch (err) {
            return Promise.reject(err);
        }
    };
    return sleep(delay)// pTimeout ensures that the callback can't cause the context to hang
    .then(function() {
        return pTimeout(cb(), 1000);
    }).catch(function(err) {
        ctx === null || ctx === void 0 ? void 0 : ctx.log('warn', 'Callback Error', {
            error: err
        });
        ctx === null || ctx === void 0 ? void 0 : ctx.stats.increment('callback_error');
    }).then(function() {
        return ctx;
    });
} //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/validation/errors.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ValidationError",
    ()=>ValidationError
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/tslib/tslib.es6.mjs [app-route] (ecmascript)");
;
var ValidationError = function(_super) {
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__extends"])(ValidationError, _super);
    function ValidationError(field, message) {
        var _this = _super.call(this, "".concat(field, " ").concat(message)) || this;
        _this.field = field;
        return _this;
    }
    return ValidationError;
}(Error);
;
 //# sourceMappingURL=errors.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "backoff",
    ()=>backoff
]);
function backoff(params) {
    var random = Math.random() + 1;
    var _a = params.minTimeout, minTimeout = _a === void 0 ? 500 : _a, _b = params.factor, factor = _b === void 0 ? 2 : _b, attempt = params.attempt, _c = params.maxTimeout, maxTimeout = _c === void 0 ? Infinity : _c;
    return Math.min(random * minTimeout * Math.pow(factor, attempt), maxTimeout);
} //# sourceMappingURL=backoff.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/validation/helpers.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "exists",
    ()=>exists,
    "isFunction",
    ()=>isFunction,
    "isNumber",
    ()=>isNumber,
    "isPlainObject",
    ()=>isPlainObject,
    "isString",
    ()=>isString
]);
function isString(obj) {
    return typeof obj === 'string';
}
function isNumber(obj) {
    return typeof obj === 'number';
}
function isFunction(obj) {
    return typeof obj === 'function';
}
function exists(val) {
    return val !== undefined && val !== null;
}
function isPlainObject(obj) {
    return Object.prototype.toString.call(obj).slice(8, -1).toLowerCase() === 'object';
} //# sourceMappingURL=helpers.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/validation/assertions.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "assertEventExists",
    ()=>assertEventExists,
    "assertEventType",
    ()=>assertEventType,
    "assertMessageId",
    ()=>assertMessageId,
    "assertTrackEventName",
    ()=>assertTrackEventName,
    "assertTrackEventProperties",
    ()=>assertTrackEventProperties,
    "assertTraits",
    ()=>assertTraits,
    "assertUserIdentity",
    ()=>assertUserIdentity,
    "validateEvent",
    ()=>validateEvent
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/validation/errors.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$helpers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/validation/helpers.js [app-route] (ecmascript)");
;
;
var stringError = 'is not a string';
var objError = 'is not an object';
var nilError = 'is nil';
function assertUserIdentity(event) {
    var USER_FIELD_NAME = '.userId/anonymousId/previousId/groupId';
    var getAnyUserId = function(event) {
        var _a, _b, _c;
        return (_c = (_b = (_a = event.userId) !== null && _a !== void 0 ? _a : event.anonymousId) !== null && _b !== void 0 ? _b : event.groupId) !== null && _c !== void 0 ? _c : event.previousId;
    };
    var id = getAnyUserId(event);
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$helpers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["exists"])(id)) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"](USER_FIELD_NAME, nilError);
    } else if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$helpers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isString"])(id)) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"](USER_FIELD_NAME, stringError);
    }
}
function assertEventExists(event) {
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$helpers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["exists"])(event)) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"]('Event', nilError);
    }
    if (typeof event !== 'object') {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"]('Event', objError);
    }
}
function assertEventType(event) {
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$helpers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isString"])(event.type)) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"]('.type', stringError);
    }
}
function assertTrackEventName(event) {
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$helpers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isString"])(event.event)) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"]('.event', stringError);
    }
}
function assertTrackEventProperties(event) {
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$helpers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isPlainObject"])(event.properties)) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"]('.properties', objError);
    }
}
function assertTraits(event) {
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$helpers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isPlainObject"])(event.traits)) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"]('.traits', objError);
    }
}
function assertMessageId(event) {
    if (!(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$helpers$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isString"])(event.messageId)) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"]('.messageId', stringError);
    }
}
function validateEvent(event) {
    assertEventExists(event);
    assertEventType(event);
    assertMessageId(event);
    if (event.type === 'track') {
        assertTrackEventName(event);
        assertTrackEventProperties(event);
    }
    if ([
        'group',
        'identify'
    ].includes(event.type)) {
        assertTraits(event);
    }
} //# sourceMappingURL=assertions.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/utils/pick.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "pickBy",
    ()=>pickBy
]);
var pickBy = function(obj, fn) {
    return Object.keys(obj).filter(function(k) {
        return fn(k, obj[k]);
    }).reduce(function(acc, key) {
        return acc[key] = obj[key], acc;
    }, {});
}; //# sourceMappingURL=pick.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/events/index.js [app-route] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CoreEventFactory",
    ()=>CoreEventFactory
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/tslib/tslib.es6.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$dset$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/dset/dist/index.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$utils$2f$pick$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/utils/pick.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$assertions$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/validation/assertions.js [app-route] (ecmascript)");
;
;
;
;
;
/**
 * Internal settings object that is used internally by the factory
 */ var InternalEventFactorySettings = function() {
    function InternalEventFactorySettings(settings) {
        var _a, _b;
        this.settings = settings;
        this.createMessageId = settings.createMessageId;
        this.onEventMethodCall = (_a = settings.onEventMethodCall) !== null && _a !== void 0 ? _a : function() {};
        this.onFinishedEvent = (_b = settings.onFinishedEvent) !== null && _b !== void 0 ? _b : function() {};
    }
    return InternalEventFactorySettings;
}();
var CoreEventFactory = function() {
    function CoreEventFactory(settings) {
        this.settings = new InternalEventFactorySettings(settings);
    }
    CoreEventFactory.prototype.track = function(event, properties, options, integrationOptions) {
        this.settings.onEventMethodCall({
            type: 'track',
            options: options
        });
        return this.normalize((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, this.baseEvent()), {
            event: event,
            type: 'track',
            properties: properties !== null && properties !== void 0 ? properties : {},
            options: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, options),
            integrations: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, integrationOptions)
        }));
    };
    CoreEventFactory.prototype.page = function(category, page, properties, options, integrationOptions) {
        var _a;
        this.settings.onEventMethodCall({
            type: 'page',
            options: options
        });
        var event = {
            type: 'page',
            properties: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, properties),
            options: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, options),
            integrations: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, integrationOptions)
        };
        if (category !== null) {
            event.category = category;
            event.properties = (_a = event.properties) !== null && _a !== void 0 ? _a : {};
            event.properties.category = category;
        }
        if (page !== null) {
            event.name = page;
        }
        return this.normalize((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, this.baseEvent()), event));
    };
    CoreEventFactory.prototype.screen = function(category, screen, properties, options, integrationOptions) {
        this.settings.onEventMethodCall({
            type: 'screen',
            options: options
        });
        var event = {
            type: 'screen',
            properties: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, properties),
            options: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, options),
            integrations: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, integrationOptions)
        };
        if (category !== null) {
            event.category = category;
        }
        if (screen !== null) {
            event.name = screen;
        }
        return this.normalize((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, this.baseEvent()), event));
    };
    CoreEventFactory.prototype.identify = function(userId, traits, options, integrationsOptions) {
        this.settings.onEventMethodCall({
            type: 'identify',
            options: options
        });
        return this.normalize((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, this.baseEvent()), {
            type: 'identify',
            userId: userId,
            traits: traits !== null && traits !== void 0 ? traits : {},
            options: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, options),
            integrations: integrationsOptions
        }));
    };
    CoreEventFactory.prototype.group = function(groupId, traits, options, integrationOptions) {
        this.settings.onEventMethodCall({
            type: 'group',
            options: options
        });
        return this.normalize((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, this.baseEvent()), {
            type: 'group',
            traits: traits !== null && traits !== void 0 ? traits : {},
            options: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, options),
            integrations: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, integrationOptions),
            groupId: groupId
        }));
    };
    CoreEventFactory.prototype.alias = function(to, from, options, integrationOptions) {
        this.settings.onEventMethodCall({
            type: 'alias',
            options: options
        });
        var base = {
            userId: to,
            type: 'alias',
            options: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, options),
            integrations: (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, integrationOptions)
        };
        if (from !== null) {
            base.previousId = from;
        }
        if (to === undefined) {
            return this.normalize((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, base), this.baseEvent()));
        }
        return this.normalize((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, this.baseEvent()), base));
    };
    CoreEventFactory.prototype.baseEvent = function() {
        return {
            integrations: {},
            options: {}
        };
    };
    /**
     * Builds the context part of an event based on "foreign" keys that
     * are provided in the `Options` parameter for an Event
     */ CoreEventFactory.prototype.context = function(options) {
        var _a;
        /**
         * If the event options are known keys from this list, we move them to the top level of the event.
         * Any other options are moved to context.
         */ var eventOverrideKeys = [
            'userId',
            'anonymousId',
            'timestamp',
            'messageId'
        ];
        delete options['integrations'];
        var providedOptionsKeys = Object.keys(options);
        var context = (_a = options.context) !== null && _a !== void 0 ? _a : {};
        var eventOverrides = {};
        providedOptionsKeys.forEach(function(key) {
            if (key === 'context') {
                return;
            }
            if (eventOverrideKeys.includes(key)) {
                (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$dset$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["dset"])(eventOverrides, key, options[key]);
            } else {
                (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$dset$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["dset"])(context, key, options[key]);
            }
        });
        return [
            context,
            eventOverrides
        ];
    };
    CoreEventFactory.prototype.normalize = function(event) {
        var _a, _b;
        var integrationBooleans = Object.keys((_a = event.integrations) !== null && _a !== void 0 ? _a : {}).reduce(function(integrationNames, name) {
            var _a;
            var _b;
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, integrationNames), (_a = {}, _a[name] = Boolean((_b = event.integrations) === null || _b === void 0 ? void 0 : _b[name]), _a));
        }, {});
        // filter out any undefined options
        event.options = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$utils$2f$pick$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["pickBy"])(event.options || {}, function(_, value) {
            return value !== undefined;
        });
        // This is pretty trippy, but here's what's going on:
        // - a) We don't pass initial integration options as part of the event, only if they're true or false
        // - b) We do accept per integration overrides (like integrations.Amplitude.sessionId) at the event level
        // Hence the need to convert base integration options to booleans, but maintain per event integration overrides
        var allIntegrations = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, integrationBooleans), (_b = event.options) === null || _b === void 0 ? void 0 : _b.integrations);
        var _c = event.options ? this.context(event.options) : [], context = _c[0], overrides = _c[1];
        var options = event.options, rest = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__rest"])(event, [
            "options"
        ]);
        var evt = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({
            timestamp: new Date()
        }, rest), {
            context: context,
            integrations: allIntegrations
        }), overrides), {
            messageId: options.messageId || this.settings.createMessageId()
        });
        this.settings.onFinishedEvent(evt);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$assertions$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["validateEvent"])(evt);
        return evt;
    };
    return CoreEventFactory;
}();
;
 //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/analytics/dispatch.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "dispatch",
    ()=>dispatch,
    "getDelay",
    ()=>getDelay
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/tslib/tslib.es6.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$callback$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/callback/index.js [app-route] (ecmascript)");
;
;
var getDelay = function(startTimeInEpochMS, timeoutInMS) {
    var elapsedTime = Date.now() - startTimeInEpochMS;
    // increasing the timeout increases the delay by almost the same amount -- this is weird legacy behavior.
    return Math.max((timeoutInMS !== null && timeoutInMS !== void 0 ? timeoutInMS : 300) - elapsedTime, 0);
};
function dispatch(ctx, queue, emitter, options) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
        var startTime, dispatched;
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_a) {
            switch(_a.label){
                case 0:
                    emitter.emit('dispatch_start', ctx);
                    startTime = Date.now();
                    if (!queue.isEmpty()) return [
                        3 /*break*/ ,
                        2
                    ];
                    return [
                        4 /*yield*/ ,
                        queue.dispatchSingle(ctx)
                    ];
                case 1:
                    dispatched = _a.sent();
                    return [
                        3 /*break*/ ,
                        4
                    ];
                case 2:
                    return [
                        4 /*yield*/ ,
                        queue.dispatch(ctx)
                    ];
                case 3:
                    dispatched = _a.sent();
                    _a.label = 4;
                case 4:
                    if (!(options === null || options === void 0 ? void 0 : options.callback)) return [
                        3 /*break*/ ,
                        6
                    ];
                    return [
                        4 /*yield*/ ,
                        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$callback$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["invokeCallback"])(dispatched, options.callback, getDelay(startTime, options.timeout))
                    ];
                case 5:
                    dispatched = _a.sent();
                    _a.label = 6;
                case 6:
                    if (options === null || options === void 0 ? void 0 : options.debug) {
                        dispatched.flush();
                    }
                    return [
                        2 /*return*/ ,
                        dispatched
                    ];
            }
        });
    });
} //# sourceMappingURL=dispatch.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/logger/index.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CoreLogger",
    ()=>CoreLogger
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/tslib/tslib.es6.mjs [app-route] (ecmascript)");
;
var CoreLogger = function() {
    function CoreLogger() {
        this._logs = [];
    }
    CoreLogger.prototype.log = function(level, message, extras) {
        var time = new Date();
        this._logs.push({
            level: level,
            message: message,
            time: time,
            extras: extras
        });
    };
    Object.defineProperty(CoreLogger.prototype, "logs", {
        get: function() {
            return this._logs;
        },
        enumerable: false,
        configurable: true
    });
    CoreLogger.prototype.flush = function() {
        if (this.logs.length > 1) {
            var formatted = this._logs.reduce(function(logs, log) {
                var _a;
                var _b, _c;
                var line = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, log), {
                    json: JSON.stringify(log.extras, null, ' '),
                    extras: log.extras
                });
                delete line['time'];
                var key = (_c = (_b = log.time) === null || _b === void 0 ? void 0 : _b.toISOString()) !== null && _c !== void 0 ? _c : '';
                if (logs[key]) {
                    key = "".concat(key, "-").concat(Math.random());
                }
                return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, logs), (_a = {}, _a[key] = line, _a));
            }, {});
            // ie doesn't like console.table
            if (console.table) {
                console.table(formatted);
            } else {
                console.log(formatted);
            }
        } else {
            this.logs.forEach(function(logEntry) {
                var level = logEntry.level, message = logEntry.message, extras = logEntry.extras;
                if (level === 'info' || level === 'debug') {
                    console.log(message, extras !== null && extras !== void 0 ? extras : '');
                } else {
                    console[level](message, extras !== null && extras !== void 0 ? extras : '');
                }
            });
        }
        this._logs = [];
    };
    return CoreLogger;
}();
;
 //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/stats/index.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CoreStats",
    ()=>CoreStats,
    "NullStats",
    ()=>NullStats
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/tslib/tslib.es6.mjs [app-route] (ecmascript)");
;
var compactMetricType = function(type) {
    var enums = {
        gauge: 'g',
        counter: 'c'
    };
    return enums[type];
};
var CoreStats = function() {
    function CoreStats() {
        this.metrics = [];
    }
    CoreStats.prototype.increment = function(metric, by, tags) {
        if (by === void 0) {
            by = 1;
        }
        this.metrics.push({
            metric: metric,
            value: by,
            tags: tags !== null && tags !== void 0 ? tags : [],
            type: 'counter',
            timestamp: Date.now()
        });
    };
    CoreStats.prototype.gauge = function(metric, value, tags) {
        this.metrics.push({
            metric: metric,
            value: value,
            tags: tags !== null && tags !== void 0 ? tags : [],
            type: 'gauge',
            timestamp: Date.now()
        });
    };
    CoreStats.prototype.flush = function() {
        var formatted = this.metrics.map(function(m) {
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__assign"])({}, m), {
                tags: m.tags.join(',')
            });
        });
        // ie doesn't like console.table
        if (console.table) {
            console.table(formatted);
        } else {
            console.log(formatted);
        }
        this.metrics = [];
    };
    /**
     * compact keys for smaller payload
     */ CoreStats.prototype.serialize = function() {
        return this.metrics.map(function(m) {
            return {
                m: m.metric,
                v: m.value,
                t: m.tags,
                k: compactMetricType(m.type),
                e: m.timestamp
            };
        });
    };
    return CoreStats;
}();
;
var NullStats = function(_super) {
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__extends"])(NullStats, _super);
    function NullStats() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    NullStats.prototype.gauge = function() {
        var _args = [];
        for(var _i = 0; _i < arguments.length; _i++){
            _args[_i] = arguments[_i];
        }
    };
    NullStats.prototype.increment = function() {
        var _args = [];
        for(var _i = 0; _i < arguments.length; _i++){
            _args[_i] = arguments[_i];
        }
    };
    NullStats.prototype.flush = function() {
        var _args = [];
        for(var _i = 0; _i < arguments.length; _i++){
            _args[_i] = arguments[_i];
        }
    };
    NullStats.prototype.serialize = function() {
        var _args = [];
        for(var _i = 0; _i < arguments.length; _i++){
            _args[_i] = arguments[_i];
        }
        return [];
    };
    return NullStats;
}(CoreStats);
;
 //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/context/index.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ContextCancelation",
    ()=>ContextCancelation,
    "CoreContext",
    ()=>CoreContext
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$lukeed$2f$uuid$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@lukeed/uuid/dist/index.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$dset$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/dset/dist/index.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$logger$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/logger/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$stats$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/stats/index.js [app-route] (ecmascript)");
;
;
;
;
var ContextCancelation = function() {
    function ContextCancelation(options) {
        var _a, _b, _c;
        this.retry = (_a = options.retry) !== null && _a !== void 0 ? _a : true;
        this.type = (_b = options.type) !== null && _b !== void 0 ? _b : 'plugin Error';
        this.reason = (_c = options.reason) !== null && _c !== void 0 ? _c : '';
    }
    return ContextCancelation;
}();
;
var CoreContext = function() {
    function CoreContext(event, id, stats, logger) {
        if (id === void 0) {
            id = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$lukeed$2f$uuid$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["v4"])();
        }
        if (stats === void 0) {
            stats = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$stats$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NullStats"]();
        }
        if (logger === void 0) {
            logger = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$logger$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["CoreLogger"]();
        }
        this.attempts = 0;
        this.event = event;
        this._id = id;
        this.logger = logger;
        this.stats = stats;
    }
    CoreContext.system = function() {
    // This should be overridden by the subclass to return an instance of the subclass.
    };
    CoreContext.prototype.isSame = function(other) {
        return other.id === this.id;
    };
    CoreContext.prototype.cancel = function(error) {
        if (error) {
            throw error;
        }
        throw new ContextCancelation({
            reason: 'Context Cancel'
        });
    };
    CoreContext.prototype.log = function(level, message, extras) {
        this.logger.log(level, message, extras);
    };
    Object.defineProperty(CoreContext.prototype, "id", {
        get: function() {
            return this._id;
        },
        enumerable: false,
        configurable: true
    });
    CoreContext.prototype.updateEvent = function(path, val) {
        var _a;
        // Don't allow integrations that are set to false to be overwritten with integration settings.
        if (path.split('.')[0] === 'integrations') {
            var integrationName = path.split('.')[1];
            if (((_a = this.event.integrations) === null || _a === void 0 ? void 0 : _a[integrationName]) === false) {
                return this.event;
            }
        }
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$dset$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["dset"])(this.event, path, val);
        return this.event;
    };
    CoreContext.prototype.failedDelivery = function() {
        return this._failedDelivery;
    };
    CoreContext.prototype.setFailedDelivery = function(options) {
        this._failedDelivery = options;
    };
    CoreContext.prototype.logs = function() {
        return this.logger.logs;
    };
    CoreContext.prototype.flush = function() {
        this.logger.flush();
        this.stats.flush();
    };
    CoreContext.prototype.toJSON = function() {
        return {
            id: this._id,
            event: this.event,
            logs: this.logger.logs,
            metrics: this.stats.metrics
        };
    };
    return CoreContext;
}();
;
 //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/utils/group-by.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "groupBy",
    ()=>groupBy
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/tslib/tslib.es6.mjs [app-route] (ecmascript)");
;
function groupBy(collection, grouper) {
    var results = {};
    collection.forEach(function(item) {
        var _a;
        var key = undefined;
        if (typeof grouper === 'string') {
            var suggestedKey = item[grouper];
            key = typeof suggestedKey !== 'string' ? JSON.stringify(suggestedKey) : suggestedKey;
        } else if (grouper instanceof Function) {
            key = grouper(item);
        }
        if (key === undefined) {
            return;
        }
        results[key] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__spreadArray"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__spreadArray"])([], (_a = results[key]) !== null && _a !== void 0 ? _a : [], true), [
            item
        ], false);
    });
    return results;
} //# sourceMappingURL=group-by.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/priority-queue/index.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ON_REMOVE_FROM_FUTURE",
    ()=>ON_REMOVE_FROM_FUTURE,
    "PriorityQueue",
    ()=>PriorityQueue
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/tslib/tslib.es6.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$backoff$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js [app-route] (ecmascript)");
;
;
;
var ON_REMOVE_FROM_FUTURE = 'onRemoveFromFuture';
var PriorityQueue = function(_super) {
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__extends"])(PriorityQueue, _super);
    function PriorityQueue(maxAttempts, queue, seen) {
        var _this = _super.call(this) || this;
        _this.future = [];
        _this.maxAttempts = maxAttempts;
        _this.queue = queue;
        _this.seen = seen !== null && seen !== void 0 ? seen : {};
        return _this;
    }
    PriorityQueue.prototype.push = function() {
        var _this = this;
        var items = [];
        for(var _i = 0; _i < arguments.length; _i++){
            items[_i] = arguments[_i];
        }
        var accepted = items.map(function(operation) {
            var attempts = _this.updateAttempts(operation);
            if (attempts > _this.maxAttempts || _this.includes(operation)) {
                return false;
            }
            _this.queue.push(operation);
            return true;
        });
        this.queue = this.queue.sort(function(a, b) {
            return _this.getAttempts(a) - _this.getAttempts(b);
        });
        return accepted;
    };
    PriorityQueue.prototype.pushWithBackoff = function(item, minTimeout) {
        var _this = this;
        if (minTimeout === void 0) {
            minTimeout = 0;
        }
        // One immediate retry unless we have a minimum timeout (e.g. for rate limiting)
        if (minTimeout == 0 && this.getAttempts(item) === 0) {
            return this.push(item)[0];
        }
        var attempt = this.updateAttempts(item);
        if (attempt > this.maxAttempts || this.includes(item)) {
            return false;
        }
        var timeout = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$backoff$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["backoff"])({
            attempt: attempt - 1
        });
        if (minTimeout > 0 && timeout < minTimeout) {
            timeout = minTimeout;
        }
        setTimeout(function() {
            _this.queue.push(item);
            // remove from future list
            _this.future = _this.future.filter(function(f) {
                return f.id !== item.id;
            });
            // Lets listeners know that a 'future' message is now available in the queue
            _this.emit(ON_REMOVE_FROM_FUTURE);
        }, timeout);
        this.future.push(item);
        return true;
    };
    PriorityQueue.prototype.getAttempts = function(item) {
        var _a;
        return (_a = this.seen[item.id]) !== null && _a !== void 0 ? _a : 0;
    };
    PriorityQueue.prototype.updateAttempts = function(item) {
        this.seen[item.id] = this.getAttempts(item) + 1;
        return this.getAttempts(item);
    };
    PriorityQueue.prototype.includes = function(item) {
        return this.queue.includes(item) || this.future.includes(item) || Boolean(this.queue.find(function(i) {
            return i.id === item.id;
        })) || Boolean(this.future.find(function(i) {
            return i.id === item.id;
        }));
    };
    PriorityQueue.prototype.pop = function() {
        return this.queue.shift();
    };
    Object.defineProperty(PriorityQueue.prototype, "length", {
        get: function() {
            return this.queue.length;
        },
        enumerable: false,
        configurable: true
    });
    Object.defineProperty(PriorityQueue.prototype, "todo", {
        get: function() {
            return this.queue.length + this.future.length;
        },
        enumerable: false,
        configurable: true
    });
    return PriorityQueue;
}(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Emitter"]);
;
 //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/utils/is-thenable.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 *  Check if  thenable
 *  (instanceof Promise doesn't respect realms)
 */ __turbopack_context__.s([
    "isThenable",
    ()=>isThenable
]);
var isThenable = function(value) {
    return typeof value === 'object' && value !== null && 'then' in value && typeof value.then === 'function';
}; //# sourceMappingURL=is-thenable.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/task/task-group.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createTaskGroup",
    ()=>createTaskGroup
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$utils$2f$is$2d$thenable$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/utils/is-thenable.js [app-route] (ecmascript)");
;
var createTaskGroup = function() {
    var taskCompletionPromise;
    var resolvePromise;
    var count = 0;
    return {
        done: function() {
            return taskCompletionPromise;
        },
        run: function(op) {
            var returnValue = op();
            if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$utils$2f$is$2d$thenable$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isThenable"])(returnValue)) {
                if (++count === 1) {
                    taskCompletionPromise = new Promise(function(res) {
                        return resolvePromise = res;
                    });
                }
                returnValue.finally(function() {
                    return --count === 0 && resolvePromise();
                });
            }
            return returnValue;
        }
    };
}; //# sourceMappingURL=task-group.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/queue/delivery.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "attempt",
    ()=>attempt,
    "ensure",
    ()=>ensure
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/tslib/tslib.es6.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/context/index.js [app-route] (ecmascript)");
;
;
function tryAsync(fn) {
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
        var err_1;
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_a) {
            switch(_a.label){
                case 0:
                    _a.trys.push([
                        0,
                        2,
                        ,
                        3
                    ]);
                    return [
                        4 /*yield*/ ,
                        fn()
                    ];
                case 1:
                    return [
                        2 /*return*/ ,
                        _a.sent()
                    ];
                case 2:
                    err_1 = _a.sent();
                    return [
                        2 /*return*/ ,
                        Promise.reject(err_1)
                    ];
                case 3:
                    return [
                        2 /*return*/ 
                    ];
            }
        });
    });
}
function attempt(ctx, plugin) {
    ctx.log('debug', 'plugin', {
        plugin: plugin.name
    });
    var start = new Date().getTime();
    var hook = plugin[ctx.event.type];
    if (hook === undefined) {
        return Promise.resolve(ctx);
    }
    var newCtx = tryAsync(function() {
        return hook.apply(plugin, [
            ctx
        ]);
    }).then(function(ctx) {
        var done = new Date().getTime() - start;
        ctx.stats.gauge('plugin_time', done, [
            "plugin:".concat(plugin.name)
        ]);
        return ctx;
    }).catch(function(err) {
        if (err instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ContextCancelation"] && err.type === 'middleware_cancellation') {
            throw err;
        }
        if (err instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ContextCancelation"]) {
            ctx.log('warn', err.type, {
                plugin: plugin.name,
                error: err
            });
            return err;
        }
        ctx.log('error', 'plugin Error', {
            plugin: plugin.name,
            error: err
        });
        ctx.stats.increment('plugin_error', 1, [
            "plugin:".concat(plugin.name)
        ]);
        return err;
    });
    return newCtx;
}
function ensure(ctx, plugin) {
    return attempt(ctx, plugin).then(function(newContext) {
        if (newContext instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["CoreContext"]) {
            return newContext;
        }
        ctx.log('debug', 'Context canceled');
        ctx.stats.increment('context_canceled');
        ctx.cancel(newContext);
    });
} //# sourceMappingURL=delivery.js.map
}),
"[project]/node_modules/@segment/analytics-core/dist/esm/queue/event-queue.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "CoreEventQueue",
    ()=>CoreEventQueue
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/tslib/tslib.es6.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$utils$2f$group$2d$by$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/utils/group-by.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/priority-queue/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/context/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$task$2f$task$2d$group$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/task/task-group.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$queue$2f$delivery$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/queue/delivery.js [app-route] (ecmascript)");
;
;
;
;
;
;
;
var CoreEventQueue = function(_super) {
    (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__extends"])(CoreEventQueue, _super);
    function CoreEventQueue(priorityQueue) {
        var _this = _super.call(this) || this;
        /**
         * All event deliveries get suspended until all the tasks in this task group are complete.
         * For example: a middleware that augments the event object should be loaded safely as a
         * critical task, this way, event queue will wait for it to be ready before sending events.
         *
         * This applies to all the events already in the queue, and the upcoming ones
         */ _this.criticalTasks = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$task$2f$task$2d$group$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createTaskGroup"])();
        _this.plugins = [];
        _this.failedInitializations = [];
        _this.flushing = false;
        _this.queue = priorityQueue;
        _this.queue.on(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ON_REMOVE_FROM_FUTURE"], function() {
            _this.scheduleFlush(0);
        });
        return _this;
    }
    CoreEventQueue.prototype.register = function(ctx, plugin, instance) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
            var handleLoadError, err_1;
            var _this = this;
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_a) {
                switch(_a.label){
                    case 0:
                        this.plugins.push(plugin);
                        handleLoadError = function(err) {
                            _this.failedInitializations.push(plugin.name);
                            _this.emit('initialization_failure', plugin);
                            console.warn(plugin.name, err);
                            ctx.log('warn', 'Failed to load destination', {
                                plugin: plugin.name,
                                error: err
                            });
                            // Filter out the failed plugin by excluding it from the list
                            _this.plugins = _this.plugins.filter(function(p) {
                                return p !== plugin;
                            });
                        };
                        if (!(plugin.type === 'destination' && plugin.name !== 'Segment.io')) return [
                            3 /*break*/ ,
                            1
                        ];
                        plugin.load(ctx, instance).catch(handleLoadError);
                        return [
                            3 /*break*/ ,
                            4
                        ];
                    case 1:
                        _a.trys.push([
                            1,
                            3,
                            ,
                            4
                        ]);
                        return [
                            4 /*yield*/ ,
                            plugin.load(ctx, instance)
                        ];
                    case 2:
                        _a.sent();
                        return [
                            3 /*break*/ ,
                            4
                        ];
                    case 3:
                        err_1 = _a.sent();
                        handleLoadError(err_1);
                        return [
                            3 /*break*/ ,
                            4
                        ];
                    case 4:
                        return [
                            2 /*return*/ 
                        ];
                }
            });
        });
    };
    CoreEventQueue.prototype.deregister = function(ctx, plugin, instance) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
            var e_1;
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_a) {
                switch(_a.label){
                    case 0:
                        _a.trys.push([
                            0,
                            3,
                            ,
                            4
                        ]);
                        if (!plugin.unload) return [
                            3 /*break*/ ,
                            2
                        ];
                        return [
                            4 /*yield*/ ,
                            Promise.resolve(plugin.unload(ctx, instance))
                        ];
                    case 1:
                        _a.sent();
                        _a.label = 2;
                    case 2:
                        this.plugins = this.plugins.filter(function(p) {
                            return p.name !== plugin.name;
                        });
                        return [
                            3 /*break*/ ,
                            4
                        ];
                    case 3:
                        e_1 = _a.sent();
                        ctx.log('warn', 'Failed to unload destination', {
                            plugin: plugin.name,
                            error: e_1
                        });
                        return [
                            3 /*break*/ ,
                            4
                        ];
                    case 4:
                        return [
                            2 /*return*/ 
                        ];
                }
            });
        });
    };
    CoreEventQueue.prototype.dispatch = function(ctx) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
            var willDeliver;
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_a) {
                ctx.log('debug', 'Dispatching');
                ctx.stats.increment('message_dispatched');
                this.queue.push(ctx);
                willDeliver = this.subscribeToDelivery(ctx);
                this.scheduleFlush(0);
                return [
                    2 /*return*/ ,
                    willDeliver
                ];
            });
        });
    };
    CoreEventQueue.prototype.subscribeToDelivery = function(ctx) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
            var _this = this;
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_a) {
                return [
                    2 /*return*/ ,
                    new Promise(function(resolve) {
                        var onDeliver = function(flushed, delivered) {
                            if (flushed.isSame(ctx)) {
                                _this.off('flush', onDeliver);
                                if (delivered) {
                                    resolve(flushed);
                                } else {
                                    resolve(flushed);
                                }
                            }
                        };
                        _this.on('flush', onDeliver);
                    })
                ];
            });
        });
    };
    CoreEventQueue.prototype.dispatchSingle = function(ctx) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
            var _this = this;
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_a) {
                ctx.log('debug', 'Dispatching');
                ctx.stats.increment('message_dispatched');
                this.queue.updateAttempts(ctx);
                ctx.attempts = 1;
                return [
                    2 /*return*/ ,
                    this.deliver(ctx).catch(function(err) {
                        var accepted = _this.enqueuRetry(err, ctx);
                        if (!accepted) {
                            ctx.setFailedDelivery({
                                reason: err
                            });
                            return ctx;
                        }
                        return _this.subscribeToDelivery(ctx);
                    })
                ];
            });
        });
    };
    CoreEventQueue.prototype.isEmpty = function() {
        return this.queue.length === 0;
    };
    CoreEventQueue.prototype.scheduleFlush = function(timeout) {
        var _this = this;
        if (timeout === void 0) {
            timeout = 500;
        }
        if (this.flushing) {
            return;
        }
        this.flushing = true;
        setTimeout(function() {
            // eslint-disable-next-line @typescript-eslint/no-floating-promises
            _this.flush().then(function() {
                setTimeout(function() {
                    _this.flushing = false;
                    if (_this.queue.length) {
                        _this.scheduleFlush(0);
                    }
                }, 0);
            });
        }, timeout);
    };
    CoreEventQueue.prototype.deliver = function(ctx) {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
            var start, done, err_2, error;
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_a) {
                switch(_a.label){
                    case 0:
                        return [
                            4 /*yield*/ ,
                            this.criticalTasks.done()
                        ];
                    case 1:
                        _a.sent();
                        start = Date.now();
                        _a.label = 2;
                    case 2:
                        _a.trys.push([
                            2,
                            4,
                            ,
                            5
                        ]);
                        return [
                            4 /*yield*/ ,
                            this.flushOne(ctx)
                        ];
                    case 3:
                        ctx = _a.sent();
                        done = Date.now() - start;
                        this.emit('delivery_success', ctx);
                        ctx.stats.gauge('delivered', done);
                        ctx.log('debug', 'Delivered', ctx.event);
                        return [
                            2 /*return*/ ,
                            ctx
                        ];
                    case 4:
                        err_2 = _a.sent();
                        error = err_2;
                        ctx.log('error', 'Failed to deliver', error);
                        this.emit('delivery_failure', ctx, error);
                        ctx.stats.increment('delivery_failed');
                        throw err_2;
                    case 5:
                        return [
                            2 /*return*/ 
                        ];
                }
            });
        });
    };
    CoreEventQueue.prototype.enqueuRetry = function(err, ctx) {
        var retriable = !(err instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ContextCancelation"]) || err.retry;
        if (!retriable) {
            return false;
        }
        return this.queue.pushWithBackoff(ctx);
    };
    CoreEventQueue.prototype.flush = function() {
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
            var ctx, err_3, accepted;
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_a) {
                switch(_a.label){
                    case 0:
                        if (this.queue.length === 0) {
                            return [
                                2 /*return*/ ,
                                []
                            ];
                        }
                        ctx = this.queue.pop();
                        if (!ctx) {
                            return [
                                2 /*return*/ ,
                                []
                            ];
                        }
                        ctx.attempts = this.queue.getAttempts(ctx);
                        _a.label = 1;
                    case 1:
                        _a.trys.push([
                            1,
                            3,
                            ,
                            4
                        ]);
                        return [
                            4 /*yield*/ ,
                            this.deliver(ctx)
                        ];
                    case 2:
                        ctx = _a.sent();
                        this.emit('flush', ctx, true);
                        return [
                            3 /*break*/ ,
                            4
                        ];
                    case 3:
                        err_3 = _a.sent();
                        accepted = this.enqueuRetry(err_3, ctx);
                        if (!accepted) {
                            ctx.setFailedDelivery({
                                reason: err_3
                            });
                            this.emit('flush', ctx, false);
                        }
                        return [
                            2 /*return*/ ,
                            []
                        ];
                    case 4:
                        return [
                            2 /*return*/ ,
                            [
                                ctx
                            ]
                        ];
                }
            });
        });
    };
    CoreEventQueue.prototype.isReady = function() {
        // return this.plugins.every((p) => p.isLoaded())
        // should we wait for every plugin to load?
        return true;
    };
    CoreEventQueue.prototype.availableExtensions = function(denyList) {
        var available = this.plugins.filter(function(p) {
            var _a, _b, _c;
            // Only filter out destination plugins or the Segment.io plugin
            if (p.type !== 'destination' && p.name !== 'Segment.io') {
                return true;
            }
            var alternativeNameMatch = undefined;
            (_a = p.alternativeNames) === null || _a === void 0 ? void 0 : _a.forEach(function(name) {
                if (denyList[name] !== undefined) {
                    alternativeNameMatch = denyList[name];
                }
            });
            // Explicit integration option takes precedence, `All: false` does not apply to Segment.io
            return (_c = (_b = denyList[p.name]) !== null && _b !== void 0 ? _b : alternativeNameMatch) !== null && _c !== void 0 ? _c : (p.name === 'Segment.io' ? true : denyList.All) !== false;
        });
        var _a = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$utils$2f$group$2d$by$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["groupBy"])(available, 'type'), _b = _a.before, before = _b === void 0 ? [] : _b, _c = _a.enrichment, enrichment = _c === void 0 ? [] : _c, _d = _a.destination, destination = _d === void 0 ? [] : _d, _e = _a.after, after = _e === void 0 ? [] : _e;
        return {
            before: before,
            enrichment: enrichment,
            destinations: destination,
            after: after
        };
    };
    CoreEventQueue.prototype.flushOne = function(ctx) {
        var _a, _b;
        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__awaiter"])(this, void 0, void 0, function() {
            var _c, before, enrichment, _i, before_1, beforeWare, temp, _d, enrichment_1, enrichmentWare, temp, _e, destinations, after, afterCalls;
            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$tslib$2f$tslib$2e$es6$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["__generator"])(this, function(_f) {
                switch(_f.label){
                    case 0:
                        if (!this.isReady()) {
                            throw new Error('Not ready');
                        }
                        if (ctx.attempts > 1) {
                            this.emit('delivery_retry', ctx);
                        }
                        _c = this.availableExtensions((_a = ctx.event.integrations) !== null && _a !== void 0 ? _a : {}), before = _c.before, enrichment = _c.enrichment;
                        _i = 0, before_1 = before;
                        _f.label = 1;
                    case 1:
                        if (!(_i < before_1.length)) return [
                            3 /*break*/ ,
                            4
                        ];
                        beforeWare = before_1[_i];
                        return [
                            4 /*yield*/ ,
                            (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$queue$2f$delivery$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ensure"])(ctx, beforeWare)
                        ];
                    case 2:
                        temp = _f.sent();
                        if (temp instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["CoreContext"]) {
                            ctx = temp;
                        }
                        this.emit('message_enriched', ctx, beforeWare);
                        _f.label = 3;
                    case 3:
                        _i++;
                        return [
                            3 /*break*/ ,
                            1
                        ];
                    case 4:
                        _d = 0, enrichment_1 = enrichment;
                        _f.label = 5;
                    case 5:
                        if (!(_d < enrichment_1.length)) return [
                            3 /*break*/ ,
                            8
                        ];
                        enrichmentWare = enrichment_1[_d];
                        return [
                            4 /*yield*/ ,
                            (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$queue$2f$delivery$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["attempt"])(ctx, enrichmentWare)
                        ];
                    case 6:
                        temp = _f.sent();
                        if (temp instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["CoreContext"]) {
                            ctx = temp;
                        }
                        this.emit('message_enriched', ctx, enrichmentWare);
                        _f.label = 7;
                    case 7:
                        _d++;
                        return [
                            3 /*break*/ ,
                            5
                        ];
                    case 8:
                        _e = this.availableExtensions((_b = ctx.event.integrations) !== null && _b !== void 0 ? _b : {}), destinations = _e.destinations, after = _e.after;
                        return [
                            4 /*yield*/ ,
                            new Promise(function(resolve, reject) {
                                setTimeout(function() {
                                    var attempts = destinations.map(function(destination) {
                                        return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$queue$2f$delivery$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["attempt"])(ctx, destination);
                                    });
                                    Promise.all(attempts).then(resolve).catch(reject);
                                }, 0);
                            })
                        ];
                    case 9:
                        _f.sent();
                        ctx.stats.increment('message_delivered');
                        this.emit('message_delivered', ctx);
                        afterCalls = after.map(function(after) {
                            return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$queue$2f$delivery$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["attempt"])(ctx, after);
                        });
                        return [
                            4 /*yield*/ ,
                            Promise.all(afterCalls)
                        ];
                    case 10:
                        _f.sent();
                        return [
                            2 /*return*/ ,
                            ctx
                        ];
                }
            });
        });
    };
    return CoreEventQueue;
}(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Emitter"]);
;
 //# sourceMappingURL=event-queue.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/app/settings.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "validateSettings",
    ()=>validateSettings
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/validation/errors.js [app-route] (ecmascript)");
;
const validateSettings = (settings)=>{
    if (!settings.writeKey) {
        throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$errors$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ValidationError"]('writeKey', 'writeKey is missing.');
    }
}; //# sourceMappingURL=settings.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/generated/version.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// This file is generated.
__turbopack_context__.s([
    "version",
    ()=>version
]);
const version = '2.3.0'; //# sourceMappingURL=version.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/lib/create-url.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "tryCreateFormattedUrl",
    ()=>tryCreateFormattedUrl
]);
const stripTrailingSlash = (str)=>str.replace(/\/$/, '');
const tryCreateFormattedUrl = (host, path)=>{
    return stripTrailingSlash(new URL(path || '', host).href);
}; //# sourceMappingURL=create-url.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/lib/uuid.js [app-route] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$lukeed$2f$uuid$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@lukeed/uuid/dist/index.mjs [app-route] (ecmascript)"); //# sourceMappingURL=uuid.js.map
;
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/context-batch.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "ContextBatch",
    ()=>ContextBatch
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$uuid$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/uuid.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$lukeed$2f$uuid$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__v4__as__uuid$3e$__ = __turbopack_context__.i("[project]/node_modules/@lukeed/uuid/dist/index.mjs [app-route] (ecmascript) <export v4 as uuid>");
;
const MAX_EVENT_SIZE_IN_KB = 32;
const MAX_BATCH_SIZE_IN_KB = 480; //  (500 KB is the limit, leaving some padding)
class ContextBatch {
    id = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$lukeed$2f$uuid$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__v4__as__uuid$3e$__["uuid"])();
    items = [];
    sizeInBytes = 0;
    maxEventCount;
    constructor(maxEventCount){
        this.maxEventCount = Math.max(1, maxEventCount);
    }
    tryAdd(item) {
        if (this.length === this.maxEventCount) return {
            success: false,
            message: `Event limit of ${this.maxEventCount} has been exceeded.`
        };
        const eventSize = this.calculateSize(item.context);
        if (eventSize > MAX_EVENT_SIZE_IN_KB * 1024) {
            return {
                success: false,
                message: `Event exceeds maximum event size of ${MAX_EVENT_SIZE_IN_KB} KB`
            };
        }
        if (this.sizeInBytes + eventSize > MAX_BATCH_SIZE_IN_KB * 1024) {
            return {
                success: false,
                message: `Event has caused batch size to exceed ${MAX_BATCH_SIZE_IN_KB} KB`
            };
        }
        this.items.push(item);
        this.sizeInBytes += eventSize;
        return {
            success: true
        };
    }
    get length() {
        return this.items.length;
    }
    calculateSize(ctx) {
        return encodeURI(JSON.stringify(ctx.event)).split(/%..|i/).length;
    }
    getEvents() {
        const events = this.items.map(({ context })=>context.event);
        return events;
    }
    getContexts() {
        return this.items.map((item)=>item.context);
    }
    resolveEvents() {
        this.items.forEach(({ resolver, context })=>resolver(context));
    }
} //# sourceMappingURL=context-batch.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/lib/token-manager.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "TokenManager",
    ()=>TokenManager
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$uuid$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/uuid.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$lukeed$2f$uuid$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__v4__as__uuid$3e$__ = __turbopack_context__.i("[project]/node_modules/@lukeed/uuid/dist/index.mjs [app-route] (ecmascript) <export v4 as uuid>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$jose$2f$dist$2f$node$2f$esm$2f$jwt$2f$sign$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/jose/dist/node/esm/jwt/sign.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$jose$2f$dist$2f$node$2f$esm$2f$key$2f$import$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/jose/dist/node/esm/key/import.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$backoff$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$callback$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/callback/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js [app-route] (ecmascript)");
;
;
;
;
const isAccessToken = (thing)=>{
    return Boolean(thing && typeof thing === 'object' && 'access_token' in thing && 'expires_in' in thing && typeof thing.access_token === 'string' && typeof thing.expires_in === 'number');
};
const isValidCustomResponse = (response)=>{
    return typeof response.text === 'function';
};
function convertHeaders(headers) {
    const lowercaseHeaders = {};
    if (!headers) return {};
    if (isHeaders(headers)) {
        for (const [name, value] of headers.entries()){
            lowercaseHeaders[name.toLowerCase()] = value;
        }
        return lowercaseHeaders;
    }
    for (const [name, value] of Object.entries(headers)){
        lowercaseHeaders[name.toLowerCase()] = value;
    }
    return lowercaseHeaders;
}
function isHeaders(thing) {
    if (typeof thing === 'object' && thing !== null && 'entries' in Object(thing) && typeof Object(thing).entries === 'function') {
        return true;
    }
    return false;
}
class TokenManager {
    alg = 'RS256';
    grantType = 'client_credentials';
    clientAssertionType = 'urn:ietf:params:oauth:client-assertion-type:jwt-bearer';
    clientId;
    clientKey;
    keyId;
    scope;
    authServer;
    httpClient;
    maxRetries;
    clockSkewInSeconds = 0;
    accessToken;
    tokenEmitter = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Emitter"]();
    retryCount;
    pollerTimer;
    constructor(props){
        this.keyId = props.keyId;
        this.clientId = props.clientId;
        this.clientKey = props.clientKey;
        this.authServer = props.authServer ?? 'https://oauth2.segment.io';
        this.scope = props.scope ?? 'tracking_api:write';
        this.httpClient = props.httpClient;
        this.maxRetries = props.maxRetries;
        this.tokenEmitter.on('access_token', (event)=>{
            if ('token' in event) {
                this.accessToken = event.token;
            }
        });
        this.retryCount = 0;
    }
    stopPoller() {
        clearTimeout(this.pollerTimer);
    }
    async pollerLoop() {
        let timeUntilRefreshInMs = 25;
        let response;
        try {
            response = await this.requestAccessToken();
        } catch (err) {
            // Error without a status code - likely networking, retry
            return this.handleTransientError({
                error: err
            });
        }
        if (!isValidCustomResponse(response)) {
            return this.handleInvalidCustomResponse();
        }
        const headers = convertHeaders(response.headers);
        if (headers['date']) {
            this.updateClockSkew(Date.parse(headers['date']));
        }
        // Handle status codes!
        if (response.status === 200) {
            try {
                const body = await response.text();
                const token = JSON.parse(body);
                if (!isAccessToken(token)) {
                    throw new Error('Response did not contain a valid access_token and expires_in');
                }
                // Success, we have a token!
                token.expires_at = Math.round(Date.now() / 1000) + token.expires_in;
                this.tokenEmitter.emit('access_token', {
                    token
                });
                // Reset our failure count
                this.retryCount = 0;
                // Refresh the token after half the expiry time passes
                timeUntilRefreshInMs = token.expires_in / 2 * 1000;
                return this.queueNextPoll(timeUntilRefreshInMs);
            } catch (err) {
                // Something went really wrong with the body, lets surface an error and try again?
                return this.handleTransientError({
                    error: err,
                    forceEmitError: true
                });
            }
        } else if (response.status === 429) {
            // Rate limited, wait for the reset time
            return await this.handleRateLimited(response, headers, timeUntilRefreshInMs);
        } else if ([
            400,
            401,
            415
        ].includes(response.status)) {
            // Unrecoverable errors, stops the poller
            return this.handleUnrecoverableErrors(response);
        } else {
            return this.handleTransientError({
                error: new Error(`[${response.status}] ${response.statusText}`)
            });
        }
    }
    handleTransientError({ error, forceEmitError }) {
        this.incrementRetries({
            error,
            forceEmitError
        });
        const timeUntilRefreshInMs = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$backoff$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["backoff"])({
            attempt: this.retryCount,
            minTimeout: 25,
            maxTimeout: 1000
        });
        this.queueNextPoll(timeUntilRefreshInMs);
    }
    handleInvalidCustomResponse() {
        this.tokenEmitter.emit('access_token', {
            error: new Error('HTTPClient does not implement response.text method')
        });
    }
    async handleRateLimited(response, headers, timeUntilRefreshInMs) {
        this.incrementRetries({
            error: new Error(`[${response.status}] ${response.statusText}`)
        });
        if (headers['x-ratelimit-reset']) {
            const rateLimitResetTimestamp = parseInt(headers['x-ratelimit-reset'], 10);
            if (isFinite(rateLimitResetTimestamp)) {
                timeUntilRefreshInMs = rateLimitResetTimestamp - Date.now() + this.clockSkewInSeconds * 1000;
            } else {
                timeUntilRefreshInMs = 5 * 1000;
            }
            // We want subsequent calls to get_token to be able to interrupt our
            //  Timeout when it's waiting for e.g. a long normal expiration, but
            //  not when we're waiting for a rate limit reset. Sleep instead.
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$callback$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["sleep"])(timeUntilRefreshInMs);
            timeUntilRefreshInMs = 0;
        }
        this.queueNextPoll(timeUntilRefreshInMs);
    }
    handleUnrecoverableErrors(response) {
        this.retryCount = 0;
        this.tokenEmitter.emit('access_token', {
            error: new Error(`[${response.status}] ${response.statusText}`)
        });
        this.stopPoller();
    }
    updateClockSkew(dateInMs) {
        this.clockSkewInSeconds = (Date.now() - dateInMs) / 1000;
    }
    incrementRetries({ error, forceEmitError }) {
        this.retryCount++;
        if (forceEmitError || this.retryCount % this.maxRetries === 0) {
            this.retryCount = 0;
            this.tokenEmitter.emit('access_token', {
                error: error
            });
        }
    }
    queueNextPoll(timeUntilRefreshInMs) {
        this.pollerTimer = setTimeout(()=>this.pollerLoop(), timeUntilRefreshInMs);
        if (this.pollerTimer.unref) {
            this.pollerTimer.unref();
        }
    }
    /**
     * Solely responsible for building the HTTP request and calling the token service.
     */ async requestAccessToken() {
        // Set issued at time to 5 seconds in the past to account for clock skew
        const ISSUED_AT_BUFFER_IN_SECONDS = 5;
        const MAX_EXPIRY_IN_SECONDS = 60;
        // Final expiry time takes into account the issued at time, so need to subtract IAT buffer
        const EXPIRY_IN_SECONDS = MAX_EXPIRY_IN_SECONDS - ISSUED_AT_BUFFER_IN_SECONDS;
        const jti = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$lukeed$2f$uuid$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__v4__as__uuid$3e$__["uuid"])();
        const currentUTCInSeconds = Math.round(Date.now() / 1000) - this.clockSkewInSeconds;
        const jwtBody = {
            iss: this.clientId,
            sub: this.clientId,
            aud: this.authServer,
            iat: currentUTCInSeconds - ISSUED_AT_BUFFER_IN_SECONDS,
            exp: currentUTCInSeconds + EXPIRY_IN_SECONDS,
            jti
        };
        const key = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$jose$2f$dist$2f$node$2f$esm$2f$key$2f$import$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["importPKCS8"])(this.clientKey, 'RS256');
        const signedJwt = await new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$jose$2f$dist$2f$node$2f$esm$2f$jwt$2f$sign$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["SignJWT"](jwtBody).setProtectedHeader({
            alg: this.alg,
            kid: this.keyId,
            typ: 'JWT'
        }).sign(key);
        const requestBody = `grant_type=${this.grantType}&client_assertion_type=${this.clientAssertionType}&client_assertion=${signedJwt}&scope=${this.scope}`;
        const accessTokenEndpoint = `${this.authServer}/token`;
        const requestOptions = {
            method: 'POST',
            url: accessTokenEndpoint,
            body: requestBody,
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded'
            },
            httpRequestTimeout: 10000
        };
        return this.httpClient.makeRequest(requestOptions);
    }
    async getAccessToken() {
        // Use the cached token if it is still valid, otherwise wait for a new token.
        if (this.isValidToken(this.accessToken)) {
            return this.accessToken;
        }
        // stop poller first in order to make sure that it's not sleeping if we need a token immediately
        // Otherwise it could be hours before the expiration time passes normally
        this.stopPoller();
        // startPoller needs to be called somewhere, either lazily when a token is first requested, or at instantiation.
        // Doing it lazily currently
        this.pollerLoop().catch(()=>{});
        return new Promise((resolve, reject)=>{
            this.tokenEmitter.once('access_token', (event)=>{
                if ('token' in event) {
                    resolve(event.token);
                } else {
                    reject(event.error);
                }
            });
        });
    }
    clearToken() {
        this.accessToken = undefined;
    }
    isValidToken(token) {
        return typeof token !== 'undefined' && token !== null && token.expires_in < Date.now() / 1000;
    }
} //# sourceMappingURL=token-manager.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/publisher.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Publisher",
    ()=>Publisher
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$backoff$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$create$2d$url$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/create-url.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$create$2d$deferred$2f$create$2d$deferred$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-generic-utils/dist/esm/create-deferred/create-deferred.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$plugins$2f$segmentio$2f$context$2d$batch$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/context-batch.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$token$2d$manager$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/token-manager.js [app-route] (ecmascript)");
;
;
;
;
;
function sleep(timeoutInMs) {
    return new Promise((resolve)=>setTimeout(resolve, timeoutInMs));
}
function noop() {}
class Publisher {
    pendingFlushTimeout;
    _batch;
    _flushInterval;
    _flushAt;
    _maxRetries;
    _url;
    _flushPendingItemsCount;
    _httpRequestTimeout;
    _emitter;
    _disable;
    _httpClient;
    _writeKey;
    _tokenManager;
    constructor({ host, path, maxRetries, flushAt, flushInterval, writeKey, httpRequestTimeout, httpClient, disable, oauthSettings }, emitter){
        this._emitter = emitter;
        this._maxRetries = maxRetries;
        this._flushAt = Math.max(flushAt, 1);
        this._flushInterval = flushInterval;
        this._url = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$create$2d$url$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["tryCreateFormattedUrl"])(host ?? 'https://api.segment.io', path ?? '/v1/batch');
        this._httpRequestTimeout = httpRequestTimeout ?? 10000;
        this._disable = Boolean(disable);
        this._httpClient = httpClient;
        this._writeKey = writeKey;
        if (oauthSettings) {
            this._tokenManager = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$token$2d$manager$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["TokenManager"]({
                ...oauthSettings,
                httpClient: oauthSettings.httpClient ?? httpClient,
                maxRetries: oauthSettings.maxRetries ?? maxRetries
            });
        }
    }
    createBatch() {
        this.pendingFlushTimeout && clearTimeout(this.pendingFlushTimeout);
        const batch = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$plugins$2f$segmentio$2f$context$2d$batch$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["ContextBatch"](this._flushAt);
        this._batch = batch;
        this.pendingFlushTimeout = setTimeout(()=>{
            if (batch === this._batch) {
                this._batch = undefined;
            }
            this.pendingFlushTimeout = undefined;
            if (batch.length) {
                this.send(batch).catch(noop);
            }
        }, this._flushInterval);
        return batch;
    }
    clearBatch() {
        this.pendingFlushTimeout && clearTimeout(this.pendingFlushTimeout);
        this._batch = undefined;
    }
    flush(pendingItemsCount) {
        if (!pendingItemsCount) {
            // if number of pending items is 0, there will never be anything else entering the batch, since the app is closed.
            if (this._tokenManager) {
                this._tokenManager.stopPoller();
            }
            return;
        }
        this._flushPendingItemsCount = pendingItemsCount;
        // if batch is empty, there's nothing to flush, and when things come in, enqueue will handle them.
        if (!this._batch) return;
        // the number of globally pending items will always be larger or the same as batch size.
        // Any mismatch is because some globally pending items are in plugins.
        const isExpectingNoMoreItems = this._batch.length === pendingItemsCount;
        if (isExpectingNoMoreItems) {
            this.send(this._batch).catch(noop).finally(()=>{
                // stop poller so program can exit ().
                if (this._tokenManager) {
                    this._tokenManager.stopPoller();
                }
            });
            this.clearBatch();
        }
    }
    /**
     * Enqueues the context for future delivery.
     * @param ctx - Context containing a Segment event.
     * @returns a promise that resolves with the context after the event has been delivered.
     */ enqueue(ctx) {
        const batch = this._batch ?? this.createBatch();
        const { promise: ctxPromise, resolve } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$create$2d$deferred$2f$create$2d$deferred$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createDeferred"])();
        const pendingItem = {
            context: ctx,
            resolver: resolve
        };
        /*
          The following logic ensures that a batch is never orphaned,
          and is always sent before a new batch is created.
    
          Add an event to the existing batch.
            Success: Check if batch is full or no more items are expected to come in (i.e. closing). If so, send batch.
            Failure: Assume event is too big to fit in current batch - send existing batch.
              Add an event to the new batch.
                Success: Check if batch is full and send if it is.
                Failure: Event exceeds maximum size (it will never fit), fail the event.
        */ const addStatus = batch.tryAdd(pendingItem);
        if (addStatus.success) {
            const isExpectingNoMoreItems = batch.length === this._flushPendingItemsCount;
            const isFull = batch.length === this._flushAt;
            if (isFull || isExpectingNoMoreItems) {
                this.send(batch).catch(noop);
                this.clearBatch();
            }
            return ctxPromise;
        }
        // If the new item causes the maximimum event size to be exceeded, send the current batch and create a new one.
        if (batch.length) {
            this.send(batch).catch(noop);
            this.clearBatch();
        }
        const fallbackBatch = this.createBatch();
        const fbAddStatus = fallbackBatch.tryAdd(pendingItem);
        if (fbAddStatus.success) {
            const isExpectingNoMoreItems = fallbackBatch.length === this._flushPendingItemsCount;
            if (isExpectingNoMoreItems) {
                this.send(fallbackBatch).catch(noop);
                this.clearBatch();
            }
            return ctxPromise;
        } else {
            // this should only occur if max event size is exceeded
            ctx.setFailedDelivery({
                reason: new Error(fbAddStatus.message)
            });
            return Promise.resolve(ctx);
        }
    }
    async send(batch) {
        if (this._flushPendingItemsCount) {
            this._flushPendingItemsCount -= batch.length;
        }
        const events = batch.getEvents();
        const maxAttempts = this._maxRetries + 1;
        let currentAttempt = 0;
        while(currentAttempt < maxAttempts){
            currentAttempt++;
            let requestedRetryTimeout;
            let failureReason;
            try {
                if (this._disable) {
                    return batch.resolveEvents();
                }
                let authString = undefined;
                if (this._tokenManager) {
                    const token = await this._tokenManager.getAccessToken();
                    if (token && token.access_token) {
                        authString = `Bearer ${token.access_token}`;
                    }
                }
                const headers = {
                    'Content-Type': 'application/json',
                    'User-Agent': 'analytics-node-next/latest',
                    ...authString ? {
                        Authorization: authString
                    } : {}
                };
                const request = {
                    url: this._url,
                    method: 'POST',
                    headers: headers,
                    body: JSON.stringify({
                        batch: events,
                        writeKey: this._writeKey,
                        sentAt: new Date()
                    }),
                    httpRequestTimeout: this._httpRequestTimeout
                };
                this._emitter.emit('http_request', {
                    body: request.body,
                    method: request.method,
                    url: request.url,
                    headers: request.headers
                });
                const response = await this._httpClient.makeRequest(request);
                if (response.status >= 200 && response.status < 300) {
                    // Successfully sent events, so exit!
                    batch.resolveEvents();
                    return;
                } else if (this._tokenManager && (response.status === 400 || response.status === 401 || response.status === 403)) {
                    // Retry with a new OAuth token if we have OAuth data
                    this._tokenManager.clearToken();
                    failureReason = new Error(`[${response.status}] ${response.statusText}`);
                } else if (response.status === 400) {
                    // https://segment.com/docs/connections/sources/catalog/libraries/server/http-api/#max-request-size
                    // Request either malformed or size exceeded - don't retry.
                    resolveFailedBatch(batch, new Error(`[${response.status}] ${response.statusText}`));
                    return;
                } else if (response.status === 429) {
                    // Rate limited, wait for the reset time
                    if (response.headers && 'x-ratelimit-reset' in response.headers) {
                        const rateLimitResetTimestamp = parseInt(response.headers['x-ratelimit-reset'], 10);
                        if (isFinite(rateLimitResetTimestamp)) {
                            requestedRetryTimeout = rateLimitResetTimestamp - Date.now();
                        }
                    }
                    failureReason = new Error(`[${response.status}] ${response.statusText}`);
                } else {
                    // Treat other errors as transient and retry.
                    failureReason = new Error(`[${response.status}] ${response.statusText}`);
                }
            } catch (err) {
                // Network errors get thrown, retry them.
                failureReason = err;
            }
            // Final attempt failed, update context and resolve events.
            if (currentAttempt === maxAttempts) {
                resolveFailedBatch(batch, failureReason);
                return;
            }
            // Retry after attempt-based backoff.
            await sleep(requestedRetryTimeout ? requestedRetryTimeout : (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$backoff$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["backoff"])({
                attempt: currentAttempt,
                minTimeout: 25,
                maxTimeout: 1000
            }));
        }
    }
}
function resolveFailedBatch(batch, reason) {
    batch.getContexts().forEach((ctx)=>ctx.setFailedDelivery({
            reason
        }));
    batch.resolveEvents();
} //# sourceMappingURL=publisher.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/lib/env.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "detectRuntime",
    ()=>detectRuntime
]);
const detectRuntime = ()=>{
    if (typeof process === 'object' && process && typeof process.env === 'object' && process.env && typeof process.version === 'string') {
        return 'node';
    }
    if ("TURBOPACK compile-time falsy", 0) //TURBOPACK unreachable
    ;
    // @ts-ignore
    if (typeof WebSocketPair !== 'undefined') {
        return 'cloudflare-worker';
    }
    // @ts-ignore
    if (typeof EdgeRuntime === 'string') {
        return 'vercel-edge';
    }
    if (// @ts-ignore
    typeof WorkerGlobalScope !== 'undefined' && // @ts-ignore
    typeof importScripts === 'function') {
        return 'web-worker';
    }
    return 'unknown';
}; //# sourceMappingURL=env.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/index.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createConfiguredNodePlugin",
    ()=>createConfiguredNodePlugin,
    "createNodePlugin",
    ()=>createNodePlugin
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$plugins$2f$segmentio$2f$publisher$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/publisher.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$generated$2f$version$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/generated/version.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$env$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/env.js [app-route] (ecmascript)");
;
;
;
function normalizeEvent(ctx) {
    ctx.updateEvent('context.library.name', '@segment/analytics-node');
    ctx.updateEvent('context.library.version', __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$generated$2f$version$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["version"]);
    const runtime = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$env$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["detectRuntime"])();
    if (runtime === 'node') {
        // eslint-disable-next-line no-restricted-globals
        ctx.updateEvent('_metadata.nodeVersion', process.version);
    }
    ctx.updateEvent('_metadata.jsRuntime', runtime);
}
function createNodePlugin(publisher) {
    function action(ctx) {
        normalizeEvent(ctx);
        return publisher.enqueue(ctx);
    }
    return {
        name: 'Segment.io',
        type: 'destination',
        version: '1.0.0',
        isLoaded: ()=>true,
        load: ()=>Promise.resolve(),
        alias: action,
        group: action,
        identify: action,
        page: action,
        screen: action,
        track: action
    };
}
const createConfiguredNodePlugin = (props, emitter)=>{
    const publisher = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$plugins$2f$segmentio$2f$publisher$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Publisher"](props, emitter);
    return {
        publisher: publisher,
        plugin: createNodePlugin(publisher)
    };
}; //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/lib/get-message-id.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "createMessageId",
    ()=>createMessageId
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$uuid$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/uuid.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$lukeed$2f$uuid$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__v4__as__uuid$3e$__ = __turbopack_context__.i("[project]/node_modules/@lukeed/uuid/dist/index.mjs [app-route] (ecmascript) <export v4 as uuid>");
;
const createMessageId = ()=>{
    return `node-next-${Date.now()}-${(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$lukeed$2f$uuid$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__v4__as__uuid$3e$__["uuid"])()}`;
}; //# sourceMappingURL=get-message-id.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/app/event-factory.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "NodeEventFactory",
    ()=>NodeEventFactory
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$assertions$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/validation/assertions.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$events$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/events/index.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$get$2d$message$2d$id$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/get-message-id.js [app-route] (ecmascript)");
;
;
class NodeEventFactory extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$events$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["CoreEventFactory"] {
    constructor(){
        super({
            createMessageId: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$get$2d$message$2d$id$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createMessageId"],
            onFinishedEvent: (event)=>{
                (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$validation$2f$assertions$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["assertUserIdentity"])(event);
            }
        });
    }
} //# sourceMappingURL=event-factory.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/app/context.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

// create a derived class since we may want to add node specific things to Context later
__turbopack_context__.s([
    "Context",
    ()=>Context
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/context/index.js [app-route] (ecmascript)");
;
class Context extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$context$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["CoreContext"] {
    static system() {
        return new this({
            type: 'track',
            event: 'system'
        });
    }
} //# sourceMappingURL=context.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/app/dispatch-emit.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "dispatchAndEmit",
    ()=>dispatchAndEmit
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$analytics$2f$dispatch$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/analytics/dispatch.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$context$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/context.js [app-route] (ecmascript)");
;
;
const normalizeDispatchCb = (cb)=>(ctx)=>{
        const failedDelivery = ctx.failedDelivery();
        return failedDelivery ? cb(failedDelivery.reason, ctx) : cb(undefined, ctx);
    };
const dispatchAndEmit = async (event, queue, emitter, callback)=>{
    try {
        const context = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$context$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Context"](event);
        const ctx = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$analytics$2f$dispatch$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["dispatch"])(context, queue, emitter, {
            ...callback ? {
                callback: normalizeDispatchCb(callback)
            } : {}
        });
        const failedDelivery = ctx.failedDelivery();
        if (failedDelivery) {
            emitter.emit('error', {
                code: 'delivery_failure',
                reason: failedDelivery.reason,
                ctx: ctx
            });
        } else {
            emitter.emit(event.type, ctx);
        }
    } catch (err) {
        emitter.emit('error', {
            code: 'unknown',
            reason: err
        });
    }
}; //# sourceMappingURL=dispatch-emit.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/app/emitter.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "NodeEmitter",
    ()=>NodeEmitter
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js [app-route] (ecmascript)");
;
class NodeEmitter extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Emitter"] {
} //# sourceMappingURL=emitter.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/app/event-queue.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "NodeEventQueue",
    ()=>NodeEventQueue
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$queue$2f$event$2d$queue$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/queue/event-queue.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/priority-queue/index.js [app-route] (ecmascript)");
;
class NodePriorityQueue extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$priority$2d$queue$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["PriorityQueue"] {
    constructor(){
        super(1, []);
    }
    // do not use an internal "seen" map
    getAttempts(ctx) {
        return ctx.attempts ?? 0;
    }
    updateAttempts(ctx) {
        ctx.attempts = this.getAttempts(ctx) + 1;
        return this.getAttempts(ctx);
    }
}
class NodeEventQueue extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$queue$2f$event$2d$queue$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["CoreEventQueue"] {
    constructor(){
        super(new NodePriorityQueue());
    }
} //# sourceMappingURL=event-queue.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/lib/abort.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * use non-native event emitter for the benefit of non-node runtimes like CF workers.
 */ __turbopack_context__.s([
    "AbortController",
    ()=>AbortController,
    "AbortSignal",
    ()=>AbortSignal,
    "abortSignalAfterTimeout",
    ()=>abortSignalAfterTimeout
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$env$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/env.js [app-route] (ecmascript)");
;
;
class AbortSignal {
    onabort = null;
    aborted = false;
    eventEmitter = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$generic$2d$utils$2f$dist$2f$esm$2f$emitter$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Emitter"]();
    toString() {
        return '[object AbortSignal]';
    }
    get [Symbol.toStringTag]() {
        return 'AbortSignal';
    }
    removeEventListener(...args) {
        this.eventEmitter.off(...args);
    }
    addEventListener(...args) {
        this.eventEmitter.on(...args);
    }
    dispatchEvent(type) {
        const event = {
            type,
            target: this
        };
        const handlerName = `on${type}`;
        if (typeof this[handlerName] === 'function') {
            ;
            this[handlerName](event);
        }
        this.eventEmitter.emit(type, event);
    }
}
class AbortController {
    signal = new AbortSignal();
    abort() {
        if (this.signal.aborted) return;
        this.signal.aborted = true;
        this.signal.dispatchEvent('abort');
    }
    toString() {
        return '[object AbortController]';
    }
    get [Symbol.toStringTag]() {
        return 'AbortController';
    }
}
const abortSignalAfterTimeout = (timeoutMs)=>{
    if ((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$env$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["detectRuntime"])() === 'cloudflare-worker') {
        return []; // TODO: this is broken in cloudflare workers, otherwise results in "A hanging Promise was canceled..." error.
    }
    const ac = new (globalThis.AbortController || AbortController)();
    const timeoutId = setTimeout(()=>{
        ac.abort();
    }, timeoutMs);
    // Allow Node.js processes to exit early if only the timeout is running
    timeoutId?.unref?.();
    return [
        ac.signal,
        timeoutId
    ];
}; //# sourceMappingURL=abort.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/lib/fetch.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "fetch",
    ()=>fetch
]);
const fetch = async (...args)=>{
    if (globalThis.fetch) {
        return globalThis.fetch(...args);
    } else if (typeof EdgeRuntime !== 'string') {
        return (await __turbopack_context__.A("[project]/node_modules/node-fetch/lib/index.mjs [app-route] (ecmascript, async loader)")).default(...args);
    } else {
        throw new Error('Invariant: an edge runtime that does not support fetch should not exist');
    }
}; //# sourceMappingURL=fetch.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/lib/http-client.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "FetchHTTPClient",
    ()=>FetchHTTPClient
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$abort$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/abort.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$fetch$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/fetch.js [app-route] (ecmascript)");
;
;
class FetchHTTPClient {
    _fetch;
    constructor(fetchFn){
        this._fetch = fetchFn ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$fetch$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["fetch"];
    }
    async makeRequest(options) {
        const [signal, timeoutId] = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$abort$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["abortSignalAfterTimeout"])(options.httpRequestTimeout);
        const requestInit = {
            url: options.url,
            method: options.method,
            headers: options.headers,
            body: options.body,
            signal: signal
        };
        return this._fetch(options.url, requestInit).finally(()=>clearTimeout(timeoutId));
    }
} //# sourceMappingURL=http-client.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/app/analytics-node.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Analytics",
    ()=>Analytics
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$utils$2f$bind$2d$all$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/utils/bind-all.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$callback$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-core/dist/esm/callback/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$settings$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/settings.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$generated$2f$version$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/generated/version.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$plugins$2f$segmentio$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$event$2d$factory$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/event-factory.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$dispatch$2d$emit$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/dispatch-emit.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/emitter.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$context$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/context.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$event$2d$queue$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/event-queue.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$http$2d$client$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/http-client.js [app-route] (ecmascript)");
;
;
;
;
;
;
;
;
;
;
class Analytics extends __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$emitter$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NodeEmitter"] {
    _eventFactory;
    _isClosed = false;
    _pendingEvents = 0;
    _closeAndFlushDefaultTimeout;
    _publisher;
    _isFlushing = false;
    _queue;
    ready;
    constructor(settings){
        super();
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$settings$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["validateSettings"])(settings);
        this._eventFactory = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$event$2d$factory$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NodeEventFactory"]();
        this._queue = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$event$2d$queue$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NodeEventQueue"]();
        const flushInterval = settings.flushInterval ?? 10000;
        this._closeAndFlushDefaultTimeout = flushInterval * 1.25; // add arbitrary multiplier in case an event is in a plugin.
        const { plugin, publisher } = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$plugins$2f$segmentio$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createConfiguredNodePlugin"])({
            writeKey: settings.writeKey,
            host: settings.host,
            path: settings.path,
            maxRetries: settings.maxRetries ?? 3,
            flushAt: settings.flushAt ?? settings.maxEventsInBatch ?? 15,
            httpRequestTimeout: settings.httpRequestTimeout,
            disable: settings.disable,
            flushInterval,
            httpClient: typeof settings.httpClient === 'function' ? new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$http$2d$client$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["FetchHTTPClient"](settings.httpClient) : settings.httpClient ?? new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$http$2d$client$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["FetchHTTPClient"](),
            oauthSettings: settings.oauthSettings
        }, this);
        this._publisher = publisher;
        this.ready = this.register(plugin).then(()=>undefined);
        this.emit('initialize', settings);
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$utils$2f$bind$2d$all$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["bindAll"])(this);
    }
    get VERSION() {
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$generated$2f$version$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["version"];
    }
    /**
     * Call this method to stop collecting new events and flush all existing events.
     * This method also waits for any event method-specific callbacks to be triggered,
     * and any of their subsequent promises to be resolved/rejected.
     */ closeAndFlush({ timeout = this._closeAndFlushDefaultTimeout } = {}) {
        return this.flush({
            timeout,
            close: true
        });
    }
    /**
     * Call this method to flush all existing events..
     * This method also waits for any event method-specific callbacks to be triggered,
     * and any of their subsequent promises to be resolved/rejected.
     */ async flush({ timeout, close = false } = {}) {
        if (this._isFlushing) {
            // if we're already flushing, then we don't need to do anything
            console.warn('Overlapping flush calls detected. Please wait for the previous flush to finish before calling .flush again');
            return;
        } else {
            this._isFlushing = true;
        }
        if (close) {
            this._isClosed = true;
        }
        this._publisher.flush(this._pendingEvents);
        const promise = new Promise((resolve)=>{
            if (!this._pendingEvents) {
                resolve();
            } else {
                this.once('drained', ()=>{
                    resolve();
                });
            }
        }).finally(()=>{
            this._isFlushing = false;
        });
        return timeout ? (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$core$2f$dist$2f$esm$2f$callback$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["pTimeout"])(promise, timeout).catch(()=>undefined) : promise;
    }
    _dispatch(segmentEvent, callback) {
        if (this._isClosed) {
            this.emit('call_after_close', segmentEvent);
            return undefined;
        }
        this._pendingEvents++;
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$dispatch$2d$emit$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["dispatchAndEmit"])(segmentEvent, this._queue, this, callback).catch((ctx)=>ctx).finally(()=>{
            this._pendingEvents--;
            if (!this._pendingEvents) {
                this.emit('drained');
            }
        });
    }
    /**
     * Combines two unassociated user identities.
     * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#alias
     */ alias({ userId, previousId, context, timestamp, integrations, messageId }, callback) {
        const segmentEvent = this._eventFactory.alias(userId, previousId, {
            context,
            integrations,
            timestamp,
            messageId
        });
        this._dispatch(segmentEvent, callback);
    }
    /**
     * Associates an identified user with a collective.
     *  @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#group
     */ group({ timestamp, groupId, userId, anonymousId, traits = {}, context, integrations, messageId }, callback) {
        const segmentEvent = this._eventFactory.group(groupId, traits, {
            context,
            anonymousId,
            userId,
            timestamp,
            integrations,
            messageId
        });
        this._dispatch(segmentEvent, callback);
    }
    /**
     * Includes a unique userId and (maybe anonymousId) and any optional traits you know about them.
     * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#identify
     */ identify({ userId, anonymousId, traits = {}, context, timestamp, integrations, messageId }, callback) {
        const segmentEvent = this._eventFactory.identify(userId, traits, {
            context,
            anonymousId,
            userId,
            timestamp,
            integrations,
            messageId
        });
        this._dispatch(segmentEvent, callback);
    }
    /**
     * The page method lets you record page views on your website, along with optional extra information about the page being viewed.
     * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#page
     */ page({ userId, anonymousId, category, name, properties, context, timestamp, integrations, messageId }, callback) {
        const segmentEvent = this._eventFactory.page(category ?? null, name ?? null, properties, {
            context,
            anonymousId,
            userId,
            timestamp,
            integrations,
            messageId
        });
        this._dispatch(segmentEvent, callback);
    }
    /**
     * Records screen views on your app, along with optional extra information
     * about the screen viewed by the user.
     *
     * TODO: This is not documented on the segment docs ATM (for node).
     */ screen({ userId, anonymousId, category, name, properties, context, timestamp, integrations, messageId }, callback) {
        const segmentEvent = this._eventFactory.screen(category ?? null, name ?? null, properties, {
            context,
            anonymousId,
            userId,
            timestamp,
            integrations,
            messageId
        });
        this._dispatch(segmentEvent, callback);
    }
    /**
     * Records actions your users perform.
     * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#track
     */ track({ userId, anonymousId, event, properties, context, timestamp, integrations, messageId }, callback) {
        const segmentEvent = this._eventFactory.track(event, properties, {
            context,
            userId,
            anonymousId,
            timestamp,
            integrations,
            messageId
        });
        this._dispatch(segmentEvent, callback);
    }
    /**
     * Registers one or more plugins to augment Analytics functionality.
     * @param plugins
     */ register(...plugins) {
        return this._queue.criticalTasks.run(async ()=>{
            const ctx = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$context$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Context"].system();
            const registrations = plugins.map((xt)=>this._queue.register(ctx, xt, this));
            await Promise.all(registrations);
            this.emit('register', plugins.map((el)=>el.name));
        });
    }
    /**
     * Deregisters one or more plugins based on their names.
     * @param pluginNames - The names of one or more plugins to deregister.
     */ async deregister(...pluginNames) {
        const ctx = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$context$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Context"].system();
        const deregistrations = pluginNames.map((pl)=>{
            const plugin = this._queue.plugins.find((p)=>p.name === pl);
            if (plugin) {
                return this._queue.deregister(ctx, plugin, this);
            } else {
                ctx.log('warn', `plugin ${pl} not found`);
            }
        });
        await Promise.all(deregistrations);
        this.emit('deregister', pluginNames);
    }
} //# sourceMappingURL=analytics-node.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/index.common.js [app-route] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$analytics$2d$node$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/analytics-node.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$context$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/context.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$http$2d$client$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/http-client.js [app-route] (ecmascript)"); //# sourceMappingURL=index.common.js.map
;
;
;
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/index.js [app-route] (ecmascript) <locals>", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "default",
    ()=>__TURBOPACK__default__export__
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$index$2e$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/index.common.js [app-route] (ecmascript) <locals>");
// export Analytics as both a named export and a default export (for backwards-compat. reasons)
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$analytics$2d$node$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/analytics-node.js [app-route] (ecmascript)");
;
;
const __TURBOPACK__default__export__ = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$analytics$2d$node$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Analytics"];
 //# sourceMappingURL=index.js.map
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/index.common.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Analytics",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$analytics$2d$node$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Analytics"],
    "Context",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$context$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Context"],
    "FetchHTTPClient",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$http$2d$client$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["FetchHTTPClient"]
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$index$2e$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/index.common.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$analytics$2d$node$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/analytics-node.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$app$2f$context$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/app/context.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$lib$2f$http$2d$client$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/lib/http-client.js [app-route] (ecmascript)");
}),
"[project]/node_modules/@segment/analytics-node/dist/esm/index.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "Analytics",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$index$2e$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Analytics"],
    "Context",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$index$2e$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Context"],
    "FetchHTTPClient",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$index$2e$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["FetchHTTPClient"],
    "default",
    ()=>__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["default"]
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/index.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$segment$2f$analytics$2d$node$2f$dist$2f$esm$2f$index$2e$common$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@segment/analytics-node/dist/esm/index.common.js [app-route] (ecmascript)");
}),
"[project]/node_modules/@segment/analytics-generic-utils/dist/esm/create-deferred/create-deferred.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * Return a promise that can be externally resolved
 */ __turbopack_context__.s([
    "createDeferred",
    ()=>createDeferred
]);
var createDeferred = function() {
    var resolve;
    var reject;
    var settled = false;
    var promise = new Promise(function(_resolve, _reject) {
        resolve = function() {
            var args = [];
            for(var _i = 0; _i < arguments.length; _i++){
                args[_i] = arguments[_i];
            }
            settled = true;
            _resolve.apply(void 0, args);
        };
        reject = function() {
            var args = [];
            for(var _i = 0; _i < arguments.length; _i++){
                args[_i] = arguments[_i];
            }
            settled = true;
            _reject.apply(void 0, args);
        };
    });
    return {
        resolve: resolve,
        reject: reject,
        promise: promise,
        isSettled: function() {
            return settled;
        }
    };
}; //# sourceMappingURL=create-deferred.js.map
}),
"[project]/node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

/**
 * Event Emitter that takes the expected contract as a generic
 * @example
 * ```ts
 *  type Contract = {
 *    delivery_success: [DeliverySuccessResponse, Metrics],
 *    delivery_failure: [DeliveryError]
 * }
 *  new Emitter<Contract>()
 *  .on('delivery_success', (res, metrics) => ...)
 *  .on('delivery_failure', (err) => ...)
 * ```
 */ __turbopack_context__.s([
    "Emitter",
    ()=>Emitter
]);
var Emitter = function() {
    function Emitter(options) {
        var _a;
        this.callbacks = {};
        this.warned = false;
        this.maxListeners = (_a = options === null || options === void 0 ? void 0 : options.maxListeners) !== null && _a !== void 0 ? _a : 10;
    }
    Emitter.prototype.warnIfPossibleMemoryLeak = function(event) {
        if (this.warned) {
            return;
        }
        if (this.maxListeners && this.callbacks[event].length > this.maxListeners) {
            console.warn("Event Emitter: Possible memory leak detected; ".concat(String(event), " has exceeded ").concat(this.maxListeners, " listeners."));
            this.warned = true;
        }
    };
    Emitter.prototype.on = function(event, callback) {
        if (!this.callbacks[event]) {
            this.callbacks[event] = [
                callback
            ];
        } else {
            this.callbacks[event].push(callback);
            this.warnIfPossibleMemoryLeak(event);
        }
        return this;
    };
    Emitter.prototype.once = function(event, callback) {
        var _this = this;
        var on = function() {
            var args = [];
            for(var _i = 0; _i < arguments.length; _i++){
                args[_i] = arguments[_i];
            }
            _this.off(event, on);
            callback.apply(_this, args);
        };
        this.on(event, on);
        return this;
    };
    Emitter.prototype.off = function(event, callback) {
        var _a;
        var fns = (_a = this.callbacks[event]) !== null && _a !== void 0 ? _a : [];
        var without = fns.filter(function(fn) {
            return fn !== callback;
        });
        this.callbacks[event] = without;
        return this;
    };
    Emitter.prototype.emit = function(event) {
        var _this = this;
        var _a;
        var args = [];
        for(var _i = 1; _i < arguments.length; _i++){
            args[_i - 1] = arguments[_i];
        }
        var callbacks = (_a = this.callbacks[event]) !== null && _a !== void 0 ? _a : [];
        callbacks.forEach(function(callback) {
            callback.apply(_this, args);
        });
        return this;
    };
    return Emitter;
}();
;
 //# sourceMappingURL=emitter.js.map
}),
];

//# sourceMappingURL=node_modules_%40segment_4a8c09bc._.js.map