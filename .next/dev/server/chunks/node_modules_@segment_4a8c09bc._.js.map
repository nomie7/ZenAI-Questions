{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/utils/bind-all.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/utils/bind-all.ts"],"sourcesContent":["export function bindAll<\n  ObjType extends { [key: string]: any },\n  KeyType extends keyof ObjType\n>(obj: ObjType): ObjType {\n  const proto = obj.constructor.prototype\n  for (const key of Object.getOwnPropertyNames(proto)) {\n    if (key !== 'constructor') {\n      const desc = Object.getOwnPropertyDescriptor(\n        obj.constructor.prototype,\n        key\n      )\n      if (!!desc && typeof desc.value === 'function') {\n        obj[key as KeyType] = obj[key].bind(obj)\n      }\n    }\n  }\n\n  return obj\n}\n"],"names":[],"mappings":";;;;AAAM,SAAU,OAAO,CAGrB,GAAY;IACZ,IAAM,KAAK,GAAG,GAAG,CAAC,WAAW,CAAC,SAAS,CAAA;IACvC,IAAkB,IAAA,KAAA,CAAiC,EAAjC,KAAA,MAAM,CAAC,mBAAmB,CAAC,KAAK,CAAC,EAAjC,KAAA,GAAA,MAAiC,EAAjC,IAAiC,CAAE;QAAhD,IAAM,GAAG,GAAA,EAAA,CAAA,GAAA;QACZ,IAAI,GAAG,KAAK,aAAa,EAAE;YACzB,IAAM,IAAI,GAAG,MAAM,CAAC,wBAAwB,CAC1C,GAAG,CAAC,WAAW,CAAC,SAAS,EACzB,GAAG,CACJ,CAAA;YACD,IAAI,CAAC,CAAC,IAAI,IAAI,OAAO,IAAI,CAAC,KAAK,KAAK,UAAU,EAAE;gBAC9C,GAAG,CAAC,GAAc,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;aACzC;SACF;KACF;IAED,OAAO,GAAG,CAAA;AACZ,CAAC"}},
    {"offset": {"line": 25, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/callback/index.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/callback/index.ts"],"sourcesContent":["import { CoreContext } from '../context'\nimport type { Callback } from '../events'\n\nexport function pTimeout<T>(promise: Promise<T>, timeout: number): Promise<T> {\n  return new Promise((resolve, reject) => {\n    const timeoutId = setTimeout(() => {\n      reject(Error('Promise timed out'))\n    }, timeout)\n\n    promise\n      .then((val) => {\n        clearTimeout(timeoutId)\n        return resolve(val)\n      })\n      .catch(reject)\n  })\n}\n\nexport function sleep(timeoutInMs: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, timeoutInMs))\n}\n\n/**\n * @param ctx\n * @param callback - the function to invoke\n * @param delay - aka \"timeout\". The amount of time in ms to wait before invoking the callback.\n */\nexport function invokeCallback<Ctx extends CoreContext>(\n  ctx: Ctx,\n  callback: Callback<Ctx>,\n  delay: number\n): Promise<Ctx> {\n  const cb = () => {\n    try {\n      return Promise.resolve(callback(ctx))\n    } catch (err) {\n      return Promise.reject(err)\n    }\n  }\n\n  return (\n    sleep(delay)\n      // pTimeout ensures that the callback can't cause the context to hang\n      .then(() => pTimeout(cb(), 1000))\n      .catch((err) => {\n        ctx?.log('warn', 'Callback Error', { error: err })\n        ctx?.stats.increment('callback_error')\n      })\n      .then(() => ctx)\n  )\n}\n"],"names":[],"mappings":";;;;;;;;AAGM,SAAU,QAAQ,CAAI,OAAmB,EAAE,OAAe;IAC9D,OAAO,IAAI,OAAO,CAAC,SAAC,OAAO,EAAE,MAAM;QACjC,IAAM,SAAS,GAAG,UAAU,CAAC;YAC3B,MAAM,CAAC,KAAK,CAAC,mBAAmB,CAAC,CAAC,CAAA;QACpC,CAAC,EAAE,OAAO,CAAC,CAAA;QAEX,OAAO,CACJ,IAAI,CAAC,SAAC,GAAG;YACR,YAAY,CAAC,SAAS,CAAC,CAAA;YACvB,OAAO,OAAO,CAAC,GAAG,CAAC,CAAA;QACrB,CAAC,CAAC,CACD,KAAK,CAAC,MAAM,CAAC,CAAA;IAClB,CAAC,CAAC,CAAA;AACJ,CAAC;AAEK,SAAU,KAAK,CAAC,WAAmB;IACvC,OAAO,IAAI,OAAO,CAAC,SAAC,OAAO;QAAK,OAAA,UAAU,CAAC,OAAO,EAAE,WAAW,CAAC;IAAhC,CAAgC,CAAC,CAAA;AACnE,CAAC;AAOK,SAAU,cAAc,CAC5B,GAAQ,EACR,QAAuB,EACvB,KAAa;IAEb,IAAM,EAAE,GAAG;QACT,IAAI;YACF,OAAO,OAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAA;SACtC,CAAC,OAAO,GAAG,EAAE;YACZ,OAAO,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAA;SAC3B;IACH,CAAC,CAAA;IAED,OAAO,AACL,KAAK,CAAC,KAAK,CAAC,AACV,qEAAqE;KACpE,IAAI,CAAC;QAAM,OAAA,QAAQ,CAAC,EAAE,EAAE,EAAE,IAAI,CAAC;IAApB,CAAoB,CAAC,CAChC,KAAK,CAAC,SAAC,GAAG;QACT,GAAG,KAAA,QAAH,GAAG,KAAA,KAAA,IAAA,KAAA,IAAH,GAAG,CAAE,GAAG,CAAC,MAAM,EAAE,gBAAgB,EAAE;YAAE,KAAK,EAAE,GAAG;QAAA,CAAE,CAAC,CAAA;QAClD,GAAG,KAAA,QAAH,GAAG,KAAA,KAAA,IAAA,KAAA,IAAH,GAAG,CAAE,KAAK,CAAC,SAAS,CAAC,gBAAgB,CAAC,CAAA;IACxC,CAAC,CAAC,CACD,IAAI,CAAC;QAAM,OAAA,GAAG;IAAH,CAAG,CAAC,CACnB,CAAA;AACH,CAAC"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/validation/errors.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/validation/errors.ts"],"sourcesContent":["export class ValidationError extends Error {\n  field: string\n\n  constructor(field: string, message: string) {\n    super(`${field} ${message}`)\n    this.field = field\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA,IAAA,kBAAA,SAAA,MAAA;QAAqC,qJAAA,EAAA,iBAAA,QAAK;IAGxC,SAAA,gBAAY,KAAa,EAAE,OAAe;QAA1C,IAAA,QACE,OAAA,IAAA,CAAA,IAAA,EAAM,GAAA,MAAA,CAAG,KAAK,EAAA,KAAA,MAAA,CAAI,OAAO,CAAE,CAAC,IAAA,IAAA,CAE7B;QADC,KAAI,CAAC,KAAK,GAAG,KAAK,CAAA;;IACpB,CAAC;IACH,OAAA,eAAC;AAAD,CAAC,AAPD,CAAqC,KAAK,GAOzC"}},
    {"offset": {"line": 94, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/priority-queue/backoff.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/priority-queue/backoff.ts"],"sourcesContent":["type BackoffParams = {\n  /** The number of milliseconds before starting the first retry. Default is 500 */\n  minTimeout?: number\n\n  /** The maximum number of milliseconds between two retries. Default is Infinity */\n  maxTimeout?: number\n\n  /** The exponential factor to use. Default is 2. */\n  factor?: number\n\n  /** The current attempt */\n  attempt: number\n}\n\nexport function backoff(params: BackoffParams): number {\n  const random = Math.random() + 1\n  const {\n    minTimeout = 500,\n    factor = 2,\n    attempt,\n    maxTimeout = Infinity,\n  } = params\n  return Math.min(random * minTimeout * Math.pow(factor, attempt), maxTimeout)\n}\n"],"names":[],"mappings":";;;;AAcM,SAAU,OAAO,CAAC,MAAqB;IAC3C,IAAM,MAAM,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAA;IAE9B,IAAA,KAIE,MAAM,CAAA,UAJQ,EAAhB,UAAU,GAAA,OAAA,KAAA,IAAG,GAAG,GAAA,EAAA,EAChB,KAGE,MAAM,CAAA,MAHE,EAAV,MAAM,GAAA,OAAA,KAAA,IAAG,CAAC,GAAA,EAAA,EACV,OAAO,GAEL,MAAM,CAAA,OAFD,EACP,KACE,MAAM,CAAA,UADa,EAArB,UAAU,GAAA,OAAA,KAAA,IAAG,QAAQ,GAAA,EAAA,CACb;IACV,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG,UAAU,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,EAAE,OAAO,CAAC,EAAE,UAAU,CAAC,CAAA;AAC9E,CAAC"}},
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/validation/helpers.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/validation/helpers.ts"],"sourcesContent":["export function isString(obj: unknown): obj is string {\n  return typeof obj === 'string'\n}\n\nexport function isNumber(obj: unknown): obj is number {\n  return typeof obj === 'number'\n}\n\nexport function isFunction(obj: unknown): obj is Function {\n  return typeof obj === 'function'\n}\n\nexport function exists<T>(val: unknown): val is NonNullable<T> {\n  return val !== undefined && val !== null\n}\n\nexport function isPlainObject(\n  obj: unknown\n): obj is Record<string | symbol | number, unknown> {\n  return (\n    Object.prototype.toString.call(obj).slice(8, -1).toLowerCase() === 'object'\n  )\n}\n"],"names":[],"mappings":";;;;;;;;;;;;AAAM,SAAU,QAAQ,CAAC,GAAY;IACnC,OAAO,OAAO,GAAG,KAAK,QAAQ,CAAA;AAChC,CAAC;AAEK,SAAU,QAAQ,CAAC,GAAY;IACnC,OAAO,OAAO,GAAG,KAAK,QAAQ,CAAA;AAChC,CAAC;AAEK,SAAU,UAAU,CAAC,GAAY;IACrC,OAAO,OAAO,GAAG,KAAK,UAAU,CAAA;AAClC,CAAC;AAEK,SAAU,MAAM,CAAI,GAAY;IACpC,OAAO,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,IAAI,CAAA;AAC1C,CAAC;AAEK,SAAU,aAAa,CAC3B,GAAY;IAEZ,OAAO,AACL,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,KAAK,QAAQ,CAC5E,CAAA;AACH,CAAC"}},
    {"offset": {"line": 138, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/validation/assertions.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/validation/assertions.ts"],"sourcesContent":["import { CoreSegmentEvent } from '../events'\nimport { ValidationError } from './errors'\nimport { isString, isPlainObject, exists } from './helpers'\n\nconst stringError = 'is not a string'\nconst objError = 'is not an object'\nconst nilError = 'is nil'\n\n// user identity check could hypothetically could be used in the browser event factory, but not 100% sure -- so this is node only for now\nexport function assertUserIdentity(event: CoreSegmentEvent): void {\n  const USER_FIELD_NAME = '.userId/anonymousId/previousId/groupId'\n\n  const getAnyUserId = (event: CoreSegmentEvent) =>\n    event.userId ?? event.anonymousId ?? event.groupId ?? event.previousId\n\n  const id = getAnyUserId(event)\n  if (!exists(id)) {\n    throw new ValidationError(USER_FIELD_NAME, nilError)\n  } else if (!isString(id)) {\n    throw new ValidationError(USER_FIELD_NAME, stringError)\n  }\n}\n\nexport function assertEventExists(\n  event?: CoreSegmentEvent | null\n): asserts event is CoreSegmentEvent {\n  if (!exists(event)) {\n    throw new ValidationError('Event', nilError)\n  }\n  if (typeof event !== 'object') {\n    throw new ValidationError('Event', objError)\n  }\n}\n\nexport function assertEventType(event: CoreSegmentEvent): void {\n  if (!isString(event.type)) {\n    throw new ValidationError('.type', stringError)\n  }\n}\n\nexport function assertTrackEventName(event: CoreSegmentEvent): void {\n  if (!isString(event.event)) {\n    throw new ValidationError('.event', stringError)\n  }\n}\n\nexport function assertTrackEventProperties(event: CoreSegmentEvent): void {\n  if (!isPlainObject(event.properties)) {\n    throw new ValidationError('.properties', objError)\n  }\n}\n\nexport function assertTraits(event: CoreSegmentEvent): void {\n  if (!isPlainObject(event.traits)) {\n    throw new ValidationError('.traits', objError)\n  }\n}\n\nexport function assertMessageId(event: CoreSegmentEvent): void {\n  if (!isString(event.messageId)) {\n    throw new ValidationError('.messageId', stringError)\n  }\n}\n\nexport function validateEvent(event?: CoreSegmentEvent | null) {\n  assertEventExists(event)\n  assertEventType(event)\n  assertMessageId(event)\n\n  if (event.type === 'track') {\n    assertTrackEventName(event)\n    assertTrackEventProperties(event)\n  }\n\n  if (['group', 'identify'].includes(event.type)) {\n    assertTraits(event)\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 228, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/utils/pick.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/utils/pick.ts"],"sourcesContent":["export const pickBy = <T extends object, K extends keyof T>(\n  obj: T,\n  fn: (key: K, v: T[K]) => boolean\n) => {\n  return (Object.keys(obj) as K[])\n    .filter((k) => fn(k, obj[k]))\n    .reduce((acc, key) => ((acc[key] = obj[key]), acc), {} as Partial<T>)\n}\n"],"names":[],"mappings":";;;;AAAO,IAAM,MAAM,GAAG,SACpB,GAAM,EACN,EAAgC;IAEhC,OAAQ,MAAM,CAAC,IAAI,CAAC,GAAG,CAAS,CAC7B,MAAM,CAAC,SAAC,CAAC;QAAK,OAAA,EAAE,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC;IAAb,CAAa,CAAC,CAC5B,MAAM,CAAC,SAAC,GAAG,EAAE,GAAG;QAAK,OAAA,AAAC,AAAC,GAAG,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC,CAAE,GAAG,CAAC;IAA5B,CAA4B,EAAE,CAAA,CAAgB,CAAC,CAAA;AACzE,CAAC,CAAA"}},
    {"offset": {"line": 243, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/events/index.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/events/index.ts"],"sourcesContent":["export * from './interfaces'\nimport { dset } from 'dset'\nimport { ID } from '../user'\nimport {\n  IntegrationsOptions,\n  EventProperties,\n  CoreSegmentEvent,\n  CoreOptions,\n  CoreExtraContext,\n  UserTraits,\n  GroupTraits,\n} from './interfaces'\nimport { pickBy } from '../utils/pick'\nimport type { RemoveIndexSignature } from '../utils/ts-helpers'\nimport { validateEvent } from '../validation/assertions'\n\nexport type EventMethodCallHook = ({\n  type,\n  options,\n}: {\n  type: 'track' | 'identify' | 'page' | 'group' | 'alias' | 'screen'\n  options?: CoreOptions\n}) => void\n\nexport type EventHook = (event: CoreSegmentEvent) => void\n\nexport interface EventFactorySettings {\n  /**\n   * Universal `messageId` builder for all events (these must be unique)\n   */\n  createMessageId: () => string\n  /**\n   * Hook to do something with an event right before they are returned from the factory.\n   * This includes event modification or additional validation.\n   */\n  onFinishedEvent?: EventHook\n  /**\n   * Hook whenever an event method is called (track, page, etc.)\n   * Can be used to update Options (or just listen)\n   */\n  onEventMethodCall?: EventMethodCallHook\n}\n\n/**\n * Internal settings object that is used internally by the factory\n */\nclass InternalEventFactorySettings {\n  public createMessageId: EventFactorySettings['createMessageId']\n  public onEventMethodCall: EventMethodCallHook\n  public onFinishedEvent: EventHook\n\n  constructor(public settings: EventFactorySettings) {\n    this.createMessageId = settings.createMessageId\n    this.onEventMethodCall = settings.onEventMethodCall ?? (() => {})\n    this.onFinishedEvent = settings.onFinishedEvent ?? (() => {})\n  }\n}\n\nexport abstract class CoreEventFactory {\n  private settings: InternalEventFactorySettings\n\n  constructor(settings: EventFactorySettings) {\n    this.settings = new InternalEventFactorySettings(settings)\n  }\n\n  track(\n    event: string,\n    properties?: EventProperties,\n    options?: CoreOptions,\n    integrationOptions?: IntegrationsOptions\n  ) {\n    this.settings.onEventMethodCall({ type: 'track', options })\n    return this.normalize({\n      ...this.baseEvent(),\n      event,\n      type: 'track',\n      properties: properties ?? {}, // TODO: why is this not a shallow copy like everywhere else?\n      options: { ...options },\n      integrations: { ...integrationOptions },\n    })\n  }\n\n  page(\n    category: string | null,\n    page: string | null,\n    properties?: EventProperties,\n    options?: CoreOptions,\n    integrationOptions?: IntegrationsOptions\n  ): CoreSegmentEvent {\n    this.settings.onEventMethodCall({ type: 'page', options })\n    const event: CoreSegmentEvent = {\n      type: 'page',\n      properties: { ...properties },\n      options: { ...options },\n      integrations: { ...integrationOptions },\n    }\n\n    if (category !== null) {\n      event.category = category\n      event.properties = event.properties ?? {}\n      event.properties.category = category\n    }\n\n    if (page !== null) {\n      event.name = page\n    }\n\n    return this.normalize({\n      ...this.baseEvent(),\n      ...event,\n    })\n  }\n\n  screen(\n    category: string | null,\n    screen: string | null,\n    properties?: EventProperties,\n    options?: CoreOptions,\n    integrationOptions?: IntegrationsOptions\n  ): CoreSegmentEvent {\n    this.settings.onEventMethodCall({ type: 'screen', options })\n    const event: CoreSegmentEvent = {\n      type: 'screen',\n      properties: { ...properties },\n      options: { ...options },\n      integrations: { ...integrationOptions },\n    }\n\n    if (category !== null) {\n      event.category = category\n    }\n\n    if (screen !== null) {\n      event.name = screen\n    }\n\n    return this.normalize({\n      ...this.baseEvent(),\n      ...event,\n    })\n  }\n\n  identify(\n    userId: ID,\n    traits?: UserTraits,\n    options?: CoreOptions,\n    integrationsOptions?: IntegrationsOptions\n  ): CoreSegmentEvent {\n    this.settings.onEventMethodCall({ type: 'identify', options })\n    return this.normalize({\n      ...this.baseEvent(),\n      type: 'identify',\n      userId,\n      traits: traits ?? {},\n      options: { ...options },\n      integrations: integrationsOptions,\n    })\n  }\n\n  group(\n    groupId: ID,\n    traits?: GroupTraits,\n    options?: CoreOptions,\n    integrationOptions?: IntegrationsOptions\n  ): CoreSegmentEvent {\n    this.settings.onEventMethodCall({ type: 'group', options })\n    return this.normalize({\n      ...this.baseEvent(),\n      type: 'group',\n      traits: traits ?? {},\n      options: { ...options }, // this spreading is intentional\n      integrations: { ...integrationOptions }, //\n      groupId,\n    })\n  }\n\n  alias(\n    to: string,\n    from: string | null, // TODO: can we make this undefined?\n    options?: CoreOptions,\n    integrationOptions?: IntegrationsOptions\n  ): CoreSegmentEvent {\n    this.settings.onEventMethodCall({ type: 'alias', options })\n    const base: CoreSegmentEvent = {\n      userId: to,\n      type: 'alias',\n      options: { ...options },\n      integrations: { ...integrationOptions },\n    }\n\n    if (from !== null) {\n      base.previousId = from\n    }\n\n    if (to === undefined) {\n      return this.normalize({\n        ...base,\n        ...this.baseEvent(),\n      })\n    }\n\n    return this.normalize({\n      ...this.baseEvent(),\n      ...base,\n    })\n  }\n\n  private baseEvent(): Partial<CoreSegmentEvent> {\n    return {\n      integrations: {},\n      options: {},\n    }\n  }\n\n  /**\n   * Builds the context part of an event based on \"foreign\" keys that\n   * are provided in the `Options` parameter for an Event\n   */\n  private context(\n    options: CoreOptions\n  ): [CoreExtraContext, Partial<CoreSegmentEvent>] {\n    type CoreOptionKeys = keyof RemoveIndexSignature<CoreOptions>\n    /**\n     * If the event options are known keys from this list, we move them to the top level of the event.\n     * Any other options are moved to context.\n     */\n    const eventOverrideKeys: CoreOptionKeys[] = [\n      'userId',\n      'anonymousId',\n      'timestamp',\n      'messageId',\n    ]\n\n    delete options['integrations']\n    const providedOptionsKeys = Object.keys(options) as Exclude<\n      CoreOptionKeys,\n      'integrations'\n    >[]\n\n    const context = options.context ?? {}\n    const eventOverrides = {}\n\n    providedOptionsKeys.forEach((key) => {\n      if (key === 'context') {\n        return\n      }\n\n      if (eventOverrideKeys.includes(key)) {\n        dset(eventOverrides, key, options[key])\n      } else {\n        dset(context, key, options[key])\n      }\n    })\n\n    return [context, eventOverrides]\n  }\n\n  private normalize(event: CoreSegmentEvent): CoreSegmentEvent {\n    const integrationBooleans = Object.keys(event.integrations ?? {}).reduce(\n      (integrationNames, name) => {\n        return {\n          ...integrationNames,\n          [name]: Boolean(event.integrations?.[name]),\n        }\n      },\n      {} as Record<string, boolean>\n    )\n\n    // filter out any undefined options\n    event.options = pickBy(event.options || {}, (_, value) => {\n      return value !== undefined\n    })\n\n    // This is pretty trippy, but here's what's going on:\n    // - a) We don't pass initial integration options as part of the event, only if they're true or false\n    // - b) We do accept per integration overrides (like integrations.Amplitude.sessionId) at the event level\n    // Hence the need to convert base integration options to booleans, but maintain per event integration overrides\n    const allIntegrations = {\n      // Base config integrations object as booleans\n      ...integrationBooleans,\n\n      // Per event overrides, for things like amplitude sessionId, for example\n      ...event.options?.integrations,\n    }\n\n    const [context, overrides] = event.options\n      ? this.context(event.options)\n      : []\n\n    const { options, ...rest } = event\n\n    const evt: CoreSegmentEvent = {\n      timestamp: new Date(),\n      ...rest,\n      context,\n      integrations: allIntegrations,\n      ...overrides,\n      messageId: options.messageId || this.settings.createMessageId(),\n    }\n\n    this.settings.onFinishedEvent(evt)\n    validateEvent(evt)\n\n    return evt\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 450, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/analytics/dispatch.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/analytics/dispatch.ts"],"sourcesContent":["import { CoreContext } from '../context'\nimport { Callback } from '../events/interfaces'\nimport { CoreEventQueue } from '../queue/event-queue'\nimport { invokeCallback } from '../callback'\nimport { Emitter } from '@segment/analytics-generic-utils'\n\nexport type DispatchOptions<Ctx extends CoreContext = CoreContext> = {\n  timeout?: number\n  debug?: boolean\n  callback?: Callback<Ctx>\n}\n\n/* The amount of time in ms to wait before invoking the callback. */\nexport const getDelay = (startTimeInEpochMS: number, timeoutInMS?: number) => {\n  const elapsedTime = Date.now() - startTimeInEpochMS\n  // increasing the timeout increases the delay by almost the same amount -- this is weird legacy behavior.\n  return Math.max((timeoutInMS ?? 300) - elapsedTime, 0)\n}\n/**\n * Push an event into the dispatch queue and invoke any callbacks.\n *\n * @param event - Segment event to enqueue.\n * @param queue - Queue to dispatch against.\n * @param emitter - This is typically an instance of \"Analytics\" -- used for metrics / progress information.\n * @param options\n */\nexport async function dispatch<\n  Ctx extends CoreContext,\n  EQ extends CoreEventQueue<Ctx>\n>(\n  ctx: Ctx,\n  queue: EQ,\n  emitter: Emitter,\n  options?: DispatchOptions<Ctx>\n): Promise<Ctx> {\n  emitter.emit('dispatch_start', ctx)\n\n  const startTime = Date.now()\n  let dispatched: Ctx\n  if (queue.isEmpty()) {\n    dispatched = await queue.dispatchSingle(ctx)\n  } else {\n    dispatched = await queue.dispatch(ctx)\n  }\n\n  if (options?.callback) {\n    dispatched = await invokeCallback(\n      dispatched,\n      options.callback,\n      getDelay(startTime, options.timeout)\n    )\n  }\n  if (options?.debug) {\n    dispatched.flush()\n  }\n\n  return dispatched\n}\n"],"names":[],"mappings":";;;;;;;AAGA,OAAO,EAAE,cAAc,EAAE,MAAM,aAAa,CAAA;;;AAUrC,IAAM,QAAQ,GAAG,SAAC,kBAA0B,EAAE,WAAoB;IACvE,IAAM,WAAW,GAAG,IAAI,CAAC,GAAG,EAAE,GAAG,kBAAkB,CAAA;IACnD,yGAAyG;IACzG,OAAO,IAAI,CAAC,GAAG,CAAC,CAAC,WAAW,KAAA,QAAX,WAAW,KAAA,KAAA,IAAX,WAAW,GAAI,GAAG,CAAC,GAAG,WAAW,EAAE,CAAC,CAAC,CAAA;AACxD,CAAC,CAAA;AASK,SAAgB,QAAQ,CAI5B,GAAQ,EACR,KAAS,EACT,OAAgB,EAChB,OAA8B;;;;;;oBAE9B,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAE,GAAG,CAAC,CAAA;oBAE7B,SAAS,GAAG,IAAI,CAAC,GAAG,EAAE,CAAA;yBAExB,KAAK,CAAC,OAAO,EAAE,EAAf,OAAA;wBAAA,EAAA,OAAA;wBAAA;qBAAA,CAAe;oBACJ,OAAA;wBAAA,EAAA,OAAA;wBAAM,KAAK,CAAC,cAAc,CAAC,GAAG,CAAC;qBAAA,CAAA;;oBAA5C,UAAU,GAAG,GAAA,IAAA,EAA+B,CAAA;;;;;;oBAE/B,OAAA;wBAAA,EAAA,OAAA;wBAAM,KAAK,CAAC,QAAQ,CAAC,GAAG,CAAC;qBAAA,CAAA;;oBAAtC,UAAU,GAAG,GAAA,IAAA,EAAyB,CAAA;;;yBAGpC,CAAA,OAAO,KAAA,QAAP,OAAO,KAAA,KAAA,IAAA,KAAA,IAAP,OAAO,CAAE,QAAQ,CAAA,EAAjB,OAAA;wBAAA,EAAA,OAAA;wBAAA;qBAAA,CAAiB;oBACN,OAAA;wBAAA,EAAA,OAAA;4BAAM,sMAAc,EAC/B,UAAU,EACV,OAAO,CAAC,QAAQ,EAChB,QAAQ,CAAC,SAAS,EAAE,OAAO,CAAC,OAAO,CAAC,CACrC;qBAAA,CAAA;;oBAJD,UAAU,GAAG,GAAA,IAAA,EAIZ,CAAA;;;oBAEH,IAAI,OAAO,KAAA,QAAP,OAAO,KAAA,KAAA,IAAA,KAAA,IAAP,OAAO,CAAE,KAAK,EAAE;wBAClB,UAAU,CAAC,KAAK,EAAE,CAAA;qBACnB;oBAED,OAAA;wBAAA,EAAA,QAAA;wBAAO,UAAU;qBAAA,CAAA;;;;CAClB"}},
    {"offset": {"line": 523, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/logger/index.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/logger/index.ts"],"sourcesContent":["export type LogLevel = 'debug' | 'info' | 'warn' | 'error'\nexport type LogMessage = {\n  level: LogLevel\n  message: string\n  time?: Date\n  extras?: Record<string, any>\n}\n\nexport interface GenericLogger {\n  log(level: LogLevel, message: string, extras?: object): void\n  flush(): void\n  logs: LogMessage[]\n}\n\nexport class CoreLogger implements GenericLogger {\n  private _logs: LogMessage[] = []\n\n  log(level: LogLevel, message: string, extras?: object) {\n    const time = new Date()\n    this._logs.push({\n      level,\n      message,\n      time,\n      extras,\n    })\n  }\n\n  public get logs(): LogMessage[] {\n    return this._logs\n  }\n\n  public flush(): void {\n    if (this.logs.length > 1) {\n      const formatted = this._logs.reduce((logs, log) => {\n        const line = {\n          ...log,\n          json: JSON.stringify(log.extras, null, ' '),\n          extras: log.extras,\n        }\n\n        delete line['time']\n\n        let key = log.time?.toISOString() ?? ''\n        if (logs[key]) {\n          key = `${key}-${Math.random()}`\n        }\n\n        return {\n          ...logs,\n          [key]: line,\n        }\n      }, {} as Record<string, LogMessage>)\n\n      // ie doesn't like console.table\n      if (console.table) {\n        console.table(formatted)\n      } else {\n        console.log(formatted)\n      }\n    } else {\n      this.logs.forEach((logEntry) => {\n        const { level, message, extras } = logEntry\n\n        if (level === 'info' || level === 'debug') {\n          console.log(message, extras ?? '')\n        } else {\n          console[level](message, extras ?? '')\n        }\n      })\n    }\n\n    this._logs = []\n  }\n}\n"],"names":[],"mappings":";;;;;;AAcA,IAAA,aAAA;IAAA,SAAA;QACU,IAAA,CAAA,KAAK,GAAiB,EAAE,CAAA;IA0DlC,CAAC;IAxDC,WAAA,SAAA,CAAA,GAAG,GAAH,SAAI,KAAe,EAAE,OAAe,EAAE,MAAe;QACnD,IAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAA;QACvB,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;YACd,KAAK,EAAA,KAAA;YACL,OAAO,EAAA,OAAA;YACP,IAAI,EAAA,IAAA;YACJ,MAAM,EAAA,MAAA;SACP,CAAC,CAAA;IACJ,CAAC;IAED,OAAA,cAAA,CAAW,WAAA,SAAA,EAAA,MAAI,EAAA;aAAf;YACE,OAAO,IAAI,CAAC,KAAK,CAAA;QACnB,CAAC;;;OAAA;IAEM,WAAA,SAAA,CAAA,KAAK,GAAZ;QACE,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,EAAE;YACxB,IAAM,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,SAAC,IAAI,EAAE,GAAG;;;gBAC5C,IAAM,IAAI,GAAA,IAAA,oJAAA,EAAA,IAAA,oJAAA,EAAA,CAAA,GACL,GAAG,GAAA;oBACN,IAAI,EAAE,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,EAAE,GAAG,CAAC;oBAC3C,MAAM,EAAE,GAAG,CAAC,MAAM;gBAAA,EACnB,CAAA;gBAED,OAAO,IAAI,CAAC,MAAM,CAAC,CAAA;gBAEnB,IAAI,GAAG,GAAG,CAAA,KAAA,CAAA,KAAA,GAAG,CAAC,IAAI,MAAA,QAAA,OAAA,KAAA,IAAA,KAAA,IAAA,GAAE,WAAW,EAAE,MAAA,QAAA,OAAA,KAAA,IAAA,KAAI,EAAE,CAAA;gBACvC,IAAI,IAAI,CAAC,GAAG,CAAC,EAAE;oBACb,GAAG,GAAG,GAAA,MAAA,CAAG,GAAG,EAAA,KAAA,MAAA,CAAI,IAAI,CAAC,MAAM,EAAE,CAAE,CAAA;iBAChC;gBAED,OAAA,IAAA,oJAAA,EAAA,IAAA,oJAAA,EAAA,CAAA,GACK,IAAI,GAAA,CAAA,KAAA,CAAA,GAAA,EAAA,CACN,GAAG,CAAA,GAAG,IAAI,EAAA,EAAA,GACZ;YACH,CAAC,EAAE,CAAA,CAAgC,CAAC,CAAA;YAEpC,gCAAgC;YAChC,IAAI,OAAO,CAAC,KAAK,EAAE;gBACjB,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,CAAA;aACzB,MAAM;gBACL,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,CAAA;aACvB;SACF,MAAM;YACL,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAC,QAAQ;gBACjB,IAAA,KAAK,GAAsB,QAAQ,CAAA,KAA9B,EAAE,OAAO,GAAa,QAAQ,CAAA,OAArB,EAAE,MAAM,GAAK,QAAQ,CAAA,MAAb,CAAa;gBAE3C,IAAI,KAAK,KAAK,MAAM,IAAI,KAAK,KAAK,OAAO,EAAE;oBACzC,OAAO,CAAC,GAAG,CAAC,OAAO,EAAE,MAAM,KAAA,QAAN,MAAM,KAAA,KAAA,IAAN,MAAM,GAAI,EAAE,CAAC,CAAA;iBACnC,MAAM;oBACL,OAAO,CAAC,KAAK,CAAC,CAAC,OAAO,EAAE,MAAM,KAAA,QAAN,MAAM,KAAA,KAAA,IAAN,MAAM,GAAI,EAAE,CAAC,CAAA;iBACtC;YACH,CAAC,CAAC,CAAA;SACH;QAED,IAAI,CAAC,KAAK,GAAG,EAAE,CAAA;IACjB,CAAC;IACH,OAAA,UAAC;AAAD,CAAC,AA3DD,IA2DC"}},
    {"offset": {"line": 591, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/stats/index.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/stats/index.ts"],"sourcesContent":["type CompactMetricType = 'g' | 'c'\n\nexport type CoreMetricType = 'gauge' | 'counter'\n\nexport interface CoreMetric {\n  metric: string\n  value: number\n  type: CoreMetricType\n  tags: string[]\n  timestamp: number // unit milliseconds\n}\n\nexport interface CompactMetric {\n  m: string // metric name\n  v: number // value\n  k: CompactMetricType\n  t: string[] // tags\n  e: number // timestamp in unit milliseconds\n}\n\nconst compactMetricType = (type: CoreMetricType): CompactMetricType => {\n  const enums: Record<CoreMetricType, CompactMetricType> = {\n    gauge: 'g',\n    counter: 'c',\n  }\n  return enums[type]\n}\n\nexport abstract class CoreStats {\n  metrics: CoreMetric[] = []\n  increment(metric: string, by = 1, tags?: string[]): void {\n    this.metrics.push({\n      metric,\n      value: by,\n      tags: tags ?? [],\n      type: 'counter',\n      timestamp: Date.now(),\n    })\n  }\n\n  gauge(metric: string, value: number, tags?: string[]): void {\n    this.metrics.push({\n      metric,\n      value,\n      tags: tags ?? [],\n      type: 'gauge',\n      timestamp: Date.now(),\n    })\n  }\n\n  flush(): void {\n    const formatted = this.metrics.map((m) => ({\n      ...m,\n      tags: m.tags.join(','),\n    }))\n    // ie doesn't like console.table\n    if (console.table) {\n      console.table(formatted)\n    } else {\n      console.log(formatted)\n    }\n    this.metrics = []\n  }\n\n  /**\n   * compact keys for smaller payload\n   */\n  serialize(): CompactMetric[] {\n    return this.metrics.map((m) => {\n      return {\n        m: m.metric,\n        v: m.value,\n        t: m.tags,\n        k: compactMetricType(m.type),\n        e: m.timestamp,\n      }\n    })\n  }\n}\n\nexport class NullStats extends CoreStats {\n  override gauge(..._args: Parameters<CoreStats['gauge']>) {}\n  override increment(..._args: Parameters<CoreStats['increment']>) {}\n  override flush(..._args: Parameters<CoreStats['flush']>) {}\n  override serialize(..._args: Parameters<CoreStats['serialize']>) {\n    return []\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 699, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/context/index.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/context/index.ts"],"sourcesContent":["import { CoreSegmentEvent } from '../events/interfaces'\n\nimport { v4 as uuid } from '@lukeed/uuid'\nimport { dset } from 'dset'\nimport { CoreLogger, LogLevel, LogMessage } from '../logger'\nimport { CoreStats, CoreMetric, NullStats } from '../stats'\n\nexport interface SerializedContext {\n  id: string\n  event: CoreSegmentEvent\n  logs: LogMessage[]\n  metrics?: CoreMetric[]\n}\n\nexport interface ContextFailedDelivery {\n  reason: unknown\n}\n\nexport interface CancelationOptions {\n  retry?: boolean\n  reason?: string\n  type?: string\n}\n\nexport class ContextCancelation {\n  retry: boolean\n  type: string\n  reason?: string\n\n  constructor(options: CancelationOptions) {\n    this.retry = options.retry ?? true\n    this.type = options.type ?? 'plugin Error'\n    this.reason = options.reason ?? ''\n  }\n}\n\nexport abstract class CoreContext<\n  Event extends CoreSegmentEvent = CoreSegmentEvent\n> {\n  event: Event\n  logger: CoreLogger\n  stats: CoreStats\n  attempts = 0\n\n  private _failedDelivery?: ContextFailedDelivery\n  private _id: string\n\n  constructor(\n    event: Event,\n    id = uuid(),\n    stats: CoreStats = new NullStats(),\n    logger = new CoreLogger()\n  ) {\n    this.event = event\n    this._id = id\n    this.logger = logger\n    this.stats = stats\n  }\n\n  static system(): void {\n    // This should be overridden by the subclass to return an instance of the subclass.\n  }\n\n  isSame(other: CoreContext): boolean {\n    return other.id === this.id\n  }\n\n  cancel(error?: Error | ContextCancelation): never {\n    if (error) {\n      throw error\n    }\n\n    throw new ContextCancelation({ reason: 'Context Cancel' })\n  }\n\n  log(level: LogLevel, message: string, extras?: object): void {\n    this.logger.log(level, message, extras)\n  }\n\n  get id(): string {\n    return this._id\n  }\n\n  updateEvent(path: string, val: unknown): Event {\n    // Don't allow integrations that are set to false to be overwritten with integration settings.\n    if (path.split('.')[0] === 'integrations') {\n      const integrationName = path.split('.')[1]\n\n      if (this.event.integrations?.[integrationName] === false) {\n        return this.event\n      }\n    }\n\n    dset(this.event, path, val)\n    return this.event\n  }\n\n  failedDelivery(): ContextFailedDelivery | undefined {\n    return this._failedDelivery\n  }\n\n  setFailedDelivery(options: ContextFailedDelivery) {\n    this._failedDelivery = options\n  }\n\n  logs(): LogMessage[] {\n    return this.logger.logs\n  }\n\n  flush(): void {\n    this.logger.flush()\n    this.stats.flush()\n  }\n\n  toJSON(): SerializedContext {\n    return {\n      id: this._id,\n      event: this.event,\n      logs: this.logger.logs,\n      metrics: this.stats.metrics,\n    }\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 805, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/utils/group-by.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/utils/group-by.ts"],"sourcesContent":["type Grouper<T> = (obj: T) => string | number\n\nexport function groupBy<T>(\n  collection: T[],\n  grouper: keyof T | Grouper<T>\n): Record<string, T[]> {\n  const results: Record<string, T[]> = {}\n\n  collection.forEach((item) => {\n    let key: string | number | undefined = undefined\n\n    if (typeof grouper === 'string') {\n      const suggestedKey = item[grouper]\n      key =\n        typeof suggestedKey !== 'string'\n          ? JSON.stringify(suggestedKey)\n          : suggestedKey\n    } else if (grouper instanceof Function) {\n      key = grouper(item)\n    }\n\n    if (key === undefined) {\n      return\n    }\n\n    results[key] = [...(results[key] ?? []), item]\n  })\n\n  return results\n}\n"],"names":[],"mappings":";;;;;;AAEM,SAAU,OAAO,CACrB,UAAe,EACf,OAA6B;IAE7B,IAAM,OAAO,GAAwB,CAAA,CAAE,CAAA;IAEvC,UAAU,CAAC,OAAO,CAAC,SAAC,IAAI;;QACtB,IAAI,GAAG,GAAgC,SAAS,CAAA;QAEhD,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;YAC/B,IAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,CAAA;YAClC,GAAG,GACD,OAAO,YAAY,KAAK,QAAQ,GAC5B,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,GAC5B,YAAY,CAAA;SACnB,MAAM,IAAI,OAAO,YAAY,QAAQ,EAAE;YACtC,GAAG,GAAG,OAAO,CAAC,IAAI,CAAC,CAAA;SACpB;QAED,IAAI,GAAG,KAAK,SAAS,EAAE;YACrB,OAAM;SACP;QAED,OAAO,CAAC,GAAG,CAAC,GAAA,IAAA,yJAAA,EAAA,IAAA,yJAAA,EAAA,EAAA,EAAO,AAAC,CAAA,KAAA,OAAO,CAAC,GAAG,CAAC,MAAA,QAAA,OAAA,KAAA,IAAA,KAAI,EAAE,CAAC,CAAA,OAAA;YAAE,IAAI;SAAA,EAAA,MAAC,CAAA;IAChD,CAAC,CAAC,CAAA;IAEF,OAAO,OAAO,CAAA;AAChB,CAAC"}},
    {"offset": {"line": 835, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/priority-queue/index.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/priority-queue/index.ts"],"sourcesContent":["import { Emitter } from '@segment/analytics-generic-utils'\nimport { backoff } from './backoff'\n\n/**\n * @internal\n */\nexport const ON_REMOVE_FROM_FUTURE = 'onRemoveFromFuture'\n\ninterface QueueItem {\n  id: string\n}\n\nexport class PriorityQueue<Item extends QueueItem = QueueItem> extends Emitter {\n  protected future: Item[] = []\n  protected queue: Item[]\n  protected seen: Record<string, number>\n\n  public maxAttempts: number\n\n  constructor(\n    maxAttempts: number,\n    queue: Item[],\n    seen?: Record<string, number>\n  ) {\n    super()\n    this.maxAttempts = maxAttempts\n    this.queue = queue\n    this.seen = seen ?? {}\n  }\n\n  push(...items: Item[]): boolean[] {\n    const accepted = items.map((operation) => {\n      const attempts = this.updateAttempts(operation)\n\n      if (attempts > this.maxAttempts || this.includes(operation)) {\n        return false\n      }\n\n      this.queue.push(operation)\n      return true\n    })\n\n    this.queue = this.queue.sort(\n      (a, b) => this.getAttempts(a) - this.getAttempts(b)\n    )\n    return accepted\n  }\n\n  pushWithBackoff(item: Item, minTimeout = 0): boolean {\n    // One immediate retry unless we have a minimum timeout (e.g. for rate limiting)\n    if (minTimeout == 0 && this.getAttempts(item) === 0) {\n      return this.push(item)[0]\n    }\n\n    const attempt = this.updateAttempts(item)\n\n    if (attempt > this.maxAttempts || this.includes(item)) {\n      return false\n    }\n\n    let timeout = backoff({ attempt: attempt - 1 })\n    if (minTimeout > 0 && timeout < minTimeout) {\n      timeout = minTimeout\n    }\n\n    setTimeout(() => {\n      this.queue.push(item)\n      // remove from future list\n      this.future = this.future.filter((f) => f.id !== item.id)\n      // Lets listeners know that a 'future' message is now available in the queue\n      this.emit(ON_REMOVE_FROM_FUTURE)\n    }, timeout)\n\n    this.future.push(item)\n    return true\n  }\n\n  public getAttempts(item: Item): number {\n    return this.seen[item.id] ?? 0\n  }\n\n  public updateAttempts(item: Item): number {\n    this.seen[item.id] = this.getAttempts(item) + 1\n    return this.getAttempts(item)\n  }\n\n  includes(item: Item): boolean {\n    return (\n      this.queue.includes(item) ||\n      this.future.includes(item) ||\n      Boolean(this.queue.find((i) => i.id === item.id)) ||\n      Boolean(this.future.find((i) => i.id === item.id))\n    )\n  }\n\n  pop(): Item | undefined {\n    return this.queue.shift()\n  }\n\n  public get length(): number {\n    return this.queue.length\n  }\n\n  public get todo(): number {\n    return this.queue.length + this.future.length\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 948, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/utils/is-thenable.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/utils/is-thenable.ts"],"sourcesContent":["/**\n *  Check if  thenable\n *  (instanceof Promise doesn't respect realms)\n */\nexport const isThenable = (value: unknown): boolean =>\n  typeof value === 'object' &&\n  value !== null &&\n  'then' in value &&\n  typeof (value as any).then === 'function'\n"],"names":[],"mappings":"AAAA;;;GAGG;;;;AACI,IAAM,UAAU,GAAG,SAAC,KAAc;IACvC,OAAA,OAAO,KAAK,KAAK,QAAQ,IACzB,KAAK,KAAK,IAAI,IACd,MAAM,IAAI,KAAK,IACf,OAAQ,KAAa,CAAC,IAAI,KAAK,UAAU;AAHzC,CAGyC,CAAA"}},
    {"offset": {"line": 962, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/task/task-group.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/task/task-group.ts"],"sourcesContent":["import { isThenable } from '../utils/is-thenable'\n\nexport type TaskGroup = {\n  done: () => Promise<void>\n  run: <Operation extends (...args: any[]) => any>(\n    op: Operation\n  ) => ReturnType<Operation>\n}\n\nexport const createTaskGroup = (): TaskGroup => {\n  let taskCompletionPromise: Promise<void>\n  let resolvePromise: () => void\n  let count = 0\n\n  return {\n    done: () => taskCompletionPromise,\n    run: (op) => {\n      const returnValue = op()\n\n      if (isThenable(returnValue)) {\n        if (++count === 1) {\n          taskCompletionPromise = new Promise((res) => (resolvePromise = res))\n        }\n\n        returnValue.finally(() => --count === 0 && resolvePromise())\n      }\n\n      return returnValue\n    },\n  }\n}\n"],"names":[],"mappings":";;;;AAAA,OAAO,EAAE,UAAU,EAAE,MAAM,sBAAsB,CAAA;;AAS1C,IAAM,eAAe,GAAG;IAC7B,IAAI,qBAAoC,CAAA;IACxC,IAAI,cAA0B,CAAA;IAC9B,IAAI,KAAK,GAAG,CAAC,CAAA;IAEb,OAAO;QACL,IAAI,EAAE;YAAM,OAAA,qBAAqB;QAArB,CAAqB;QACjC,GAAG,EAAE,SAAC,EAAE;YACN,IAAM,WAAW,GAAG,EAAE,EAAE,CAAA;YAExB,QAAI,wMAAU,EAAC,WAAW,CAAC,EAAE;gBAC3B,IAAI,EAAE,KAAK,KAAK,CAAC,EAAE;oBACjB,qBAAqB,GAAG,IAAI,OAAO,CAAC,SAAC,GAAG;wBAAK,OAAA,AAAC,cAAc,GAAG,GAAG,CAAC;oBAAtB,CAAsB,CAAC,CAAA;iBACrE;gBAED,WAAW,CAAC,OAAO,CAAC;oBAAM,OAAA,EAAE,KAAK,KAAK,CAAC,IAAI,cAAc,EAAE;gBAAjC,CAAiC,CAAC,CAAA;aAC7D;YAED,OAAO,WAAW,CAAA;QACpB,CAAC;KACF,CAAA;AACH,CAAC,CAAA"}},
    {"offset": {"line": 996, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/queue/delivery.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/queue/delivery.ts"],"sourcesContent":["import { CoreContext, ContextCancelation } from '../context'\nimport { CorePlugin } from '../plugins'\n\nasync function tryAsync<T>(fn: () => T | Promise<T>): Promise<T> {\n  try {\n    return await fn()\n  } catch (err) {\n    return Promise.reject(err)\n  }\n}\n\nexport function attempt<Ctx extends CoreContext = CoreContext>(\n  ctx: Ctx,\n  plugin: CorePlugin<Ctx>\n): Promise<Ctx | ContextCancelation | Error> {\n  ctx.log('debug', 'plugin', { plugin: plugin.name })\n  const start = new Date().getTime()\n\n  const hook = plugin[ctx.event.type]\n  if (hook === undefined) {\n    return Promise.resolve(ctx)\n  }\n\n  const newCtx = tryAsync(() => hook.apply(plugin, [ctx]))\n    .then((ctx) => {\n      const done = new Date().getTime() - start\n      ctx.stats.gauge('plugin_time', done, [`plugin:${plugin.name}`])\n\n      return ctx\n    })\n    .catch((err: Error | ContextCancelation) => {\n      if (\n        err instanceof ContextCancelation &&\n        err.type === 'middleware_cancellation'\n      ) {\n        throw err\n      }\n\n      if (err instanceof ContextCancelation) {\n        ctx.log('warn', err.type, {\n          plugin: plugin.name,\n          error: err,\n        })\n\n        return err\n      }\n\n      ctx.log('error', 'plugin Error', {\n        plugin: plugin.name,\n        error: err,\n      })\n      ctx.stats.increment('plugin_error', 1, [`plugin:${plugin.name}`])\n\n      return err\n    })\n\n  return newCtx\n}\n\nexport function ensure<Ctx extends CoreContext = CoreContext>(\n  ctx: Ctx,\n  plugin: CorePlugin<Ctx>\n): Promise<Ctx | undefined> {\n  return attempt(ctx, plugin).then((newContext) => {\n    if (newContext instanceof CoreContext) {\n      return newContext\n    }\n\n    ctx.log('debug', 'Context canceled')\n    ctx.stats.increment('context_canceled')\n    ctx.cancel(newContext)\n  })\n}\n"],"names":[],"mappings":";;;;;;;AAAA,OAAO,EAAE,WAAW,EAAE,kBAAkB,EAAE,MAAM,YAAY,CAAA;;;AAG5D,SAAe,QAAQ,CAAI,EAAwB;;;;;;;;;;;;oBAExC,OAAA;wBAAA,EAAA,OAAA;wBAAM,EAAE,EAAE;qBAAA,CAAA;;oBAAjB,OAAA;wBAAA,EAAA,QAAA;wBAAO,GAAA,IAAA,EAAU;qBAAA,CAAA;;;oBAEjB,OAAA;wBAAA,EAAA,QAAA;wBAAO,OAAO,CAAC,MAAM,CAAC,KAAG,CAAC;qBAAA,CAAA;;;;;;;;CAE7B;AAEK,SAAU,OAAO,CACrB,GAAQ,EACR,MAAuB;IAEvB,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,QAAQ,EAAE;QAAE,MAAM,EAAE,MAAM,CAAC,IAAI;IAAA,CAAE,CAAC,CAAA;IACnD,IAAM,KAAK,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAA;IAElC,IAAM,IAAI,GAAG,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,CAAA;IACnC,IAAI,IAAI,KAAK,SAAS,EAAE;QACtB,OAAO,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;KAC5B;IAED,IAAM,MAAM,GAAG,QAAQ,CAAC;QAAM,OAAA,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;YAAC,GAAG;SAAC,CAAC;IAAzB,CAAyB,CAAC,CACrD,IAAI,CAAC,SAAC,GAAG;QACR,IAAM,IAAI,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,KAAK,CAAA;QACzC,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,aAAa,EAAE,IAAI,EAAE;YAAC,UAAA,MAAA,CAAU,MAAM,CAAC,IAAI,CAAE;SAAC,CAAC,CAAA;QAE/D,OAAO,GAAG,CAAA;IACZ,CAAC,CAAC,CACD,KAAK,CAAC,SAAC,GAA+B;QACrC,IACE,GAAG,YAAY,yMAAkB,IACjC,GAAG,CAAC,IAAI,KAAK,yBAAyB,EACtC;YACA,MAAM,GAAG,CAAA;SACV;QAED,IAAI,GAAG,YAAY,yMAAkB,EAAE;YACrC,GAAG,CAAC,GAAG,CAAC,MAAM,EAAE,GAAG,CAAC,IAAI,EAAE;gBACxB,MAAM,EAAE,MAAM,CAAC,IAAI;gBACnB,KAAK,EAAE,GAAG;aACX,CAAC,CAAA;YAEF,OAAO,GAAG,CAAA;SACX;QAED,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,cAAc,EAAE;YAC/B,MAAM,EAAE,MAAM,CAAC,IAAI;YACnB,KAAK,EAAE,GAAG;SACX,CAAC,CAAA;QACF,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,cAAc,EAAE,CAAC,EAAE;YAAC,UAAA,MAAA,CAAU,MAAM,CAAC,IAAI,CAAE;SAAC,CAAC,CAAA;QAEjE,OAAO,GAAG,CAAA;IACZ,CAAC,CAAC,CAAA;IAEJ,OAAO,MAAM,CAAA;AACf,CAAC;AAEK,SAAU,MAAM,CACpB,GAAQ,EACR,MAAuB;IAEvB,OAAO,OAAO,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,IAAI,CAAC,SAAC,UAAU;QAC1C,IAAI,UAAU,YAAY,kMAAW,EAAE;YACrC,OAAO,UAAU,CAAA;SAClB;QAED,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,kBAAkB,CAAC,CAAA;QACpC,GAAG,CAAC,KAAK,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAA;QACvC,GAAG,CAAC,MAAM,CAAC,UAAU,CAAC,CAAA;IACxB,CAAC,CAAC,CAAA;AACJ,CAAC"}},
    {"offset": {"line": 1096, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-core/dist/esm/queue/event-queue.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-core/src/queue/event-queue.ts"],"sourcesContent":["import { CoreAnalytics } from '../analytics'\nimport { groupBy } from '../utils/group-by'\nimport { ON_REMOVE_FROM_FUTURE, PriorityQueue } from '../priority-queue'\n\nimport { CoreContext, ContextCancelation } from '../context'\nimport { Emitter } from '@segment/analytics-generic-utils'\nimport { IntegrationsOptions } from '../events/interfaces'\nimport { CorePlugin } from '../plugins'\nimport { createTaskGroup, TaskGroup } from '../task/task-group'\nimport { attempt, ensure } from './delivery'\n\nexport type EventQueueEmitterContract<Ctx extends CoreContext> = {\n  message_delivered: [ctx: Ctx]\n  message_enriched: [ctx: Ctx, plugin: CorePlugin<Ctx>]\n  delivery_success: [ctx: Ctx]\n  delivery_retry: [ctx: Ctx]\n  delivery_failure: [ctx: Ctx, err: Ctx | Error | ContextCancelation]\n  flush: [ctx: Ctx, delivered: boolean]\n  initialization_failure: [CorePlugin<Ctx>]\n}\n\nexport abstract class CoreEventQueue<\n  Ctx extends CoreContext = CoreContext,\n  Plugin extends CorePlugin<Ctx> = CorePlugin<Ctx>\n> extends Emitter<EventQueueEmitterContract<Ctx>> {\n  /**\n   * All event deliveries get suspended until all the tasks in this task group are complete.\n   * For example: a middleware that augments the event object should be loaded safely as a\n   * critical task, this way, event queue will wait for it to be ready before sending events.\n   *\n   * This applies to all the events already in the queue, and the upcoming ones\n   */\n  criticalTasks: TaskGroup = createTaskGroup()\n  queue: PriorityQueue<Ctx>\n  plugins: Plugin[] = []\n  failedInitializations: string[] = []\n  private flushing = false\n\n  constructor(priorityQueue: PriorityQueue<Ctx>) {\n    super()\n\n    this.queue = priorityQueue\n    this.queue.on(ON_REMOVE_FROM_FUTURE, () => {\n      this.scheduleFlush(0)\n    })\n  }\n\n  async register(\n    ctx: Ctx,\n    plugin: Plugin,\n    instance: CoreAnalytics\n  ): Promise<void> {\n    this.plugins.push(plugin)\n\n    const handleLoadError = (err: any) => {\n      this.failedInitializations.push(plugin.name)\n      this.emit('initialization_failure', plugin)\n      console.warn(plugin.name, err)\n\n      ctx.log('warn', 'Failed to load destination', {\n        plugin: plugin.name,\n        error: err,\n      })\n\n      // Filter out the failed plugin by excluding it from the list\n      this.plugins = this.plugins.filter((p) => p !== plugin)\n    }\n\n    if (plugin.type === 'destination' && plugin.name !== 'Segment.io') {\n      plugin.load(ctx, instance).catch(handleLoadError)\n    } else {\n      // for non-destinations plugins, we do need to wait for them to load\n      // reminder: action destinations can require plugins that are not of type \"destination\".\n      // For example, GA4 loads a type 'before' plugins and addition to a type 'destination' plugin\n      try {\n        await plugin.load(ctx, instance)\n      } catch (err) {\n        handleLoadError(err)\n      }\n    }\n  }\n\n  async deregister(\n    ctx: Ctx,\n    plugin: CorePlugin<Ctx>,\n    instance: CoreAnalytics\n  ): Promise<void> {\n    try {\n      if (plugin.unload) {\n        await Promise.resolve(plugin.unload(ctx, instance))\n      }\n\n      this.plugins = this.plugins.filter((p) => p.name !== plugin.name)\n    } catch (e) {\n      ctx.log('warn', 'Failed to unload destination', {\n        plugin: plugin.name,\n        error: e,\n      })\n    }\n  }\n\n  async dispatch(ctx: Ctx): Promise<Ctx> {\n    ctx.log('debug', 'Dispatching')\n    ctx.stats.increment('message_dispatched')\n\n    this.queue.push(ctx)\n    const willDeliver = this.subscribeToDelivery(ctx)\n    this.scheduleFlush(0)\n    return willDeliver\n  }\n\n  private async subscribeToDelivery(ctx: Ctx): Promise<Ctx> {\n    return new Promise((resolve) => {\n      const onDeliver = (flushed: Ctx, delivered: boolean): void => {\n        if (flushed.isSame(ctx)) {\n          this.off('flush', onDeliver)\n          if (delivered) {\n            resolve(flushed)\n          } else {\n            resolve(flushed)\n          }\n        }\n      }\n\n      this.on('flush', onDeliver)\n    })\n  }\n\n  async dispatchSingle(ctx: Ctx): Promise<Ctx> {\n    ctx.log('debug', 'Dispatching')\n    ctx.stats.increment('message_dispatched')\n\n    this.queue.updateAttempts(ctx)\n    ctx.attempts = 1\n\n    return this.deliver(ctx).catch((err) => {\n      const accepted = this.enqueuRetry(err, ctx)\n      if (!accepted) {\n        ctx.setFailedDelivery({ reason: err })\n        return ctx\n      }\n\n      return this.subscribeToDelivery(ctx)\n    })\n  }\n\n  isEmpty(): boolean {\n    return this.queue.length === 0\n  }\n\n  private scheduleFlush(timeout = 500): void {\n    if (this.flushing) {\n      return\n    }\n\n    this.flushing = true\n\n    setTimeout(() => {\n      // eslint-disable-next-line @typescript-eslint/no-floating-promises\n      this.flush().then(() => {\n        setTimeout(() => {\n          this.flushing = false\n\n          if (this.queue.length) {\n            this.scheduleFlush(0)\n          }\n        }, 0)\n      })\n    }, timeout)\n  }\n\n  private async deliver(ctx: Ctx): Promise<Ctx> {\n    await this.criticalTasks.done()\n\n    const start = Date.now()\n    try {\n      ctx = await this.flushOne(ctx)\n      const done = Date.now() - start\n      this.emit('delivery_success', ctx)\n      ctx.stats.gauge('delivered', done)\n      ctx.log('debug', 'Delivered', ctx.event)\n      return ctx\n    } catch (err: any) {\n      const error = err as Ctx | Error | ContextCancelation\n      ctx.log('error', 'Failed to deliver', error)\n      this.emit('delivery_failure', ctx, error)\n      ctx.stats.increment('delivery_failed')\n      throw err\n    }\n  }\n\n  private enqueuRetry(err: Error, ctx: Ctx): boolean {\n    const retriable = !(err instanceof ContextCancelation) || err.retry\n    if (!retriable) {\n      return false\n    }\n\n    return this.queue.pushWithBackoff(ctx)\n  }\n\n  async flush(): Promise<Ctx[]> {\n    if (this.queue.length === 0) {\n      return []\n    }\n\n    let ctx = this.queue.pop()\n    if (!ctx) {\n      return []\n    }\n\n    ctx.attempts = this.queue.getAttempts(ctx)\n\n    try {\n      ctx = await this.deliver(ctx)\n      this.emit('flush', ctx, true)\n    } catch (err: any) {\n      const accepted = this.enqueuRetry(err, ctx)\n\n      if (!accepted) {\n        ctx.setFailedDelivery({ reason: err })\n        this.emit('flush', ctx, false)\n      }\n\n      return []\n    }\n\n    return [ctx]\n  }\n\n  private isReady(): boolean {\n    // return this.plugins.every((p) => p.isLoaded())\n    // should we wait for every plugin to load?\n    return true\n  }\n\n  private availableExtensions(denyList: IntegrationsOptions) {\n    const available = this.plugins.filter((p) => {\n      // Only filter out destination plugins or the Segment.io plugin\n      if (p.type !== 'destination' && p.name !== 'Segment.io') {\n        return true\n      }\n\n      let alternativeNameMatch: boolean | Record<string, unknown> | undefined =\n        undefined\n      p.alternativeNames?.forEach((name) => {\n        if (denyList[name] !== undefined) {\n          alternativeNameMatch = denyList[name]\n        }\n      })\n\n      // Explicit integration option takes precedence, `All: false` does not apply to Segment.io\n      return (\n        denyList[p.name] ??\n        alternativeNameMatch ??\n        (p.name === 'Segment.io' ? true : denyList.All) !== false\n      )\n    })\n\n    const {\n      before = [],\n      enrichment = [],\n      destination = [],\n      after = [],\n    } = groupBy(available, 'type')\n\n    return {\n      before,\n      enrichment,\n      destinations: destination,\n      after,\n    }\n  }\n\n  private async flushOne(ctx: Ctx): Promise<Ctx> {\n    if (!this.isReady()) {\n      throw new Error('Not ready')\n    }\n\n    if (ctx.attempts > 1) {\n      this.emit('delivery_retry', ctx)\n    }\n\n    const { before, enrichment } = this.availableExtensions(\n      ctx.event.integrations ?? {}\n    )\n\n    for (const beforeWare of before) {\n      const temp = await ensure(ctx, beforeWare)\n      if (temp instanceof CoreContext) {\n        ctx = temp\n      }\n\n      this.emit('message_enriched', ctx, beforeWare)\n    }\n\n    for (const enrichmentWare of enrichment) {\n      const temp = await attempt(ctx, enrichmentWare)\n      if (temp instanceof CoreContext) {\n        ctx = temp\n      }\n\n      this.emit('message_enriched', ctx, enrichmentWare)\n    }\n\n    // Enrichment and before plugins can re-arrange the deny list dynamically\n    // so we need to pluck them at the end\n    const { destinations, after } = this.availableExtensions(\n      ctx.event.integrations ?? {}\n    )\n\n    await new Promise((resolve, reject) => {\n      setTimeout(() => {\n        const attempts = destinations.map((destination) =>\n          attempt(ctx, destination)\n        )\n        Promise.all(attempts).then(resolve).catch(reject)\n      }, 0)\n    })\n\n    ctx.stats.increment('message_delivered')\n\n    this.emit('message_delivered', ctx)\n\n    const afterCalls = after.map((after) => attempt(ctx, after))\n    await Promise.all(afterCalls)\n\n    return ctx\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1588, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/app/settings.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/app/settings.ts"],"sourcesContent":["import { ValidationError } from '@segment/analytics-core'\nimport { HTTPClient, HTTPFetchFn } from '../lib/http-client'\nimport { OAuthSettings } from '../lib/types'\n\nexport interface AnalyticsSettings {\n  /**\n   * Key that corresponds to your Segment.io project\n   */\n  writeKey: string\n  /**\n   * The base URL of the API. Default: \"https://api.segment.io\"\n   */\n  host?: string\n  /**\n   * The API path route. Default: \"/v1/batch\"\n   */\n  path?: string\n  /**\n   * The number of times to retry flushing a batch. Default: 3\n   */\n  maxRetries?: number\n  /**\n   * The number of events to enqueue before flushing. Default: 15.\n   */\n  flushAt?: number\n  /**\n   * @deprecated\n   * The number of events to enqueue before flushing. This is deprecated in favor of `flushAt`. Default: 15.\n   */\n  maxEventsInBatch?: number\n  /**\n   * The number of milliseconds to wait before flushing the queue automatically. Default: 10000\n   */\n  flushInterval?: number\n  /**\n   * The maximum number of milliseconds to wait for an http request. Default: 10000\n   */\n  httpRequestTimeout?: number\n  /**\n   * Disable the analytics library. All calls will be a noop. Default: false.\n   */\n  disable?: boolean\n  /**\n   * Supply a default http client implementation (such as one supporting proxy).\n   * Accepts either an HTTPClient instance or a fetch function.\n   * Default: an HTTP client that uses globalThis.fetch, with node-fetch as a fallback.\n   */\n  httpClient?: HTTPFetchFn | HTTPClient\n  /**\n   * Set up OAuth2 authentication between the client and Segment's endpoints\n   */\n  oauthSettings?: OAuthSettings\n}\n\nexport const validateSettings = (settings: AnalyticsSettings) => {\n  if (!settings.writeKey) {\n    throw new ValidationError('writeKey', 'writeKey is missing.')\n  }\n}\n"],"names":[],"mappings":";;;;AAAA,OAAO,EAAE,eAAe,EAAE,MAAM,yBAAyB,CAAA;;AAsDlD,MAAM,gBAAgB,GAAG,CAAC,QAA2B,EAAE,EAAE;IAC9D,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE;QACtB,MAAM,IAAI,0MAAe,CAAC,UAAU,EAAE,sBAAsB,CAAC,CAAA;KAC9D;AACH,CAAC,CAAA"}},
    {"offset": {"line": 1603, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/generated/version.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/generated/version.ts"],"sourcesContent":["// This file is generated.\nexport const version = '2.3.0'\n"],"names":[],"mappings":"AAAA,0BAA0B;;;;;AACnB,MAAM,OAAO,GAAG,OAAO,CAAA"}},
    {"offset": {"line": 1613, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/lib/create-url.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/lib/create-url.ts"],"sourcesContent":["const stripTrailingSlash = (str: string) => str.replace(/\\/$/, '')\n\n/**\n *\n * @param host e.g. \"http://foo.com\"\n * @param path e.g. \"/bar\"\n * @returns \"e.g.\" \"http://foo.com/bar\"\n */\nexport const tryCreateFormattedUrl = (host: string, path?: string) => {\n  return stripTrailingSlash(new URL(path || '', host).href)\n}\n"],"names":[],"mappings":";;;;AAAA,MAAM,kBAAkB,GAAG,CAAC,GAAW,EAAE,CAAG,CAAD,EAAI,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAA;AAQ3D,MAAM,qBAAqB,GAAG,CAAC,IAAY,EAAE,IAAa,EAAE,EAAE;IACnE,OAAO,kBAAkB,CAAC,IAAI,GAAG,CAAC,IAAI,IAAI,EAAE,EAAE,IAAI,CAAC,CAAC,IAAI,CAAC,CAAA;AAC3D,CAAC,CAAA"}},
    {"offset": {"line": 1625, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/lib/uuid.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/lib/uuid.ts"],"sourcesContent":["export { v4 as uuid } from '@lukeed/uuid'\n"],"names":[],"mappings":";AAAA,OAAO,EAAE,EAAE,IAAI,IAAI,EAAE,MAAM,cAAc,CAAA"}},
    {"offset": {"line": 1632, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/context-batch.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/plugins/segmentio/context-batch.ts"],"sourcesContent":["import { uuid } from '../../lib/uuid'\nimport type { Context } from '../../app/context'\nimport { SegmentEvent } from '../../app/types'\n\nconst MAX_EVENT_SIZE_IN_KB = 32\nconst MAX_BATCH_SIZE_IN_KB = 480 //  (500 KB is the limit, leaving some padding)\n\ninterface PendingItem {\n  resolver: (ctx: Context) => void\n  context: Context\n}\n\nexport class ContextBatch {\n  public id = uuid()\n  private items: PendingItem[] = []\n  private sizeInBytes = 0\n  private maxEventCount: number\n\n  constructor(maxEventCount: number) {\n    this.maxEventCount = Math.max(1, maxEventCount)\n  }\n  public tryAdd(\n    item: PendingItem\n  ): { success: true } | { success: false; message: string } {\n    if (this.length === this.maxEventCount)\n      return {\n        success: false,\n        message: `Event limit of ${this.maxEventCount} has been exceeded.`,\n      }\n\n    const eventSize = this.calculateSize(item.context)\n    if (eventSize > MAX_EVENT_SIZE_IN_KB * 1024) {\n      return {\n        success: false,\n        message: `Event exceeds maximum event size of ${MAX_EVENT_SIZE_IN_KB} KB`,\n      }\n    }\n\n    if (this.sizeInBytes + eventSize > MAX_BATCH_SIZE_IN_KB * 1024) {\n      return {\n        success: false,\n        message: `Event has caused batch size to exceed ${MAX_BATCH_SIZE_IN_KB} KB`,\n      }\n    }\n\n    this.items.push(item)\n    this.sizeInBytes += eventSize\n    return { success: true }\n  }\n\n  get length(): number {\n    return this.items.length\n  }\n\n  private calculateSize(ctx: Context): number {\n    return encodeURI(JSON.stringify(ctx.event)).split(/%..|i/).length\n  }\n\n  getEvents(): SegmentEvent[] {\n    const events = this.items.map(({ context }) => context.event)\n    return events\n  }\n\n  getContexts(): Context[] {\n    return this.items.map((item) => item.context)\n  }\n\n  resolveEvents(): void {\n    this.items.forEach(({ resolver, context }) => resolver(context))\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,OAAO,EAAE,IAAI,EAAE,MAAM,gBAAgB,CAAA;;AAIrC,MAAM,oBAAoB,GAAG,EAAE,CAAA;AAC/B,MAAM,oBAAoB,GAAG,GAAG,CAAA,CAAC,+CAA+C;AAO1E,MAAO,YAAY;IAChB,EAAE,OAAG,0LAAI,EAAE,EAAA;IACV,KAAK,GAAkB,EAAE,CAAA;IACzB,WAAW,GAAG,CAAC,CAAA;IACf,aAAa,CAAQ;IAE7B,YAAY,aAAqB,CAAA;QAC/B,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,aAAa,CAAC,CAAA;IACjD,CAAC;IACM,MAAM,CACX,IAAiB,EAAA;QAEjB,IAAI,IAAI,CAAC,MAAM,KAAK,IAAI,CAAC,aAAa,EACpC,OAAO;YACL,OAAO,EAAE,KAAK;YACd,OAAO,EAAE,CAAA,eAAA,EAAkB,IAAI,CAAC,aAAa,CAAA,mBAAA,CAAqB;SACnE,CAAA;QAEH,MAAM,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,OAAO,CAAC,CAAA;QAClD,IAAI,SAAS,GAAG,oBAAoB,GAAG,IAAI,EAAE;YAC3C,OAAO;gBACL,OAAO,EAAE,KAAK;gBACd,OAAO,EAAE,CAAA,oCAAA,EAAuC,oBAAoB,CAAA,GAAA,CAAK;aAC1E,CAAA;SACF;QAED,IAAI,IAAI,CAAC,WAAW,GAAG,SAAS,GAAG,oBAAoB,GAAG,IAAI,EAAE;YAC9D,OAAO;gBACL,OAAO,EAAE,KAAK;gBACd,OAAO,EAAE,CAAA,sCAAA,EAAyC,oBAAoB,CAAA,GAAA,CAAK;aAC5E,CAAA;SACF;QAED,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;QACrB,IAAI,CAAC,WAAW,IAAI,SAAS,CAAA;QAC7B,OAAO;YAAE,OAAO,EAAE,IAAI;QAAA,CAAE,CAAA;IAC1B,CAAC;IAED,IAAI,MAAM,GAAA;QACR,OAAO,IAAI,CAAC,KAAK,CAAC,MAAM,CAAA;IAC1B,CAAC;IAEO,aAAa,CAAC,GAAY,EAAA;QAChC,OAAO,SAAS,CAAC,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,MAAM,CAAA;IACnE,CAAC;IAED,SAAS,GAAA;QACP,MAAM,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE,OAAO,EAAE,EAAE,CAAG,CAAD,MAAQ,CAAC,KAAK,CAAC,CAAA;QAC7D,OAAO,MAAM,CAAA;IACf,CAAC;IAED,WAAW,GAAA;QACT,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAG,CAAD,GAAK,CAAC,OAAO,CAAC,CAAA;IAC/C,CAAC;IAED,aAAa,GAAA;QACX,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,EAAE,QAAQ,EAAE,OAAO,EAAE,EAAE,CAAG,CAAD,OAAS,CAAC,OAAO,CAAC,CAAC,CAAA;IAClE,CAAC;CACF"}},
    {"offset": {"line": 1694, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/lib/token-manager.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/lib/token-manager.ts"],"sourcesContent":["import { uuid } from './uuid'\nimport { HTTPClient, HTTPClientRequest, HTTPResponse } from './http-client'\nimport { SignJWT, importPKCS8 } from 'jose'\nimport { backoff, sleep } from '@segment/analytics-core'\nimport { Emitter } from '@segment/analytics-generic-utils'\nimport type {\n  AccessToken,\n  OAuthSettings,\n  TokenManager as ITokenManager,\n} from './types'\n\nconst isAccessToken = (thing: unknown): thing is AccessToken => {\n  return Boolean(\n    thing &&\n      typeof thing === 'object' &&\n      'access_token' in thing &&\n      'expires_in' in thing &&\n      typeof thing.access_token === 'string' &&\n      typeof thing.expires_in === 'number'\n  )\n}\n\nconst isValidCustomResponse = (\n  response: HTTPResponse\n): response is HTTPResponse & Required<Pick<HTTPResponse, 'text'>> => {\n  return typeof response.text === 'function'\n}\n\nfunction convertHeaders(\n  headers: HTTPResponse['headers']\n): Record<string, string> {\n  const lowercaseHeaders: Record<string, string> = {}\n  if (!headers) return {}\n  if (isHeaders(headers)) {\n    for (const [name, value] of headers.entries()) {\n      lowercaseHeaders[name.toLowerCase()] = value\n    }\n    return lowercaseHeaders\n  }\n  for (const [name, value] of Object.entries(headers)) {\n    lowercaseHeaders[name.toLowerCase()] = value as string\n  }\n  return lowercaseHeaders\n}\n\nfunction isHeaders(thing: unknown): thing is HTTPResponse['headers'] {\n  if (\n    typeof thing === 'object' &&\n    thing !== null &&\n    'entries' in Object(thing) &&\n    typeof Object(thing).entries === 'function'\n  ) {\n    return true\n  }\n  return false\n}\n\nexport interface TokenManagerSettings extends OAuthSettings {\n  httpClient: HTTPClient\n  maxRetries: number\n}\n\nexport class TokenManager implements ITokenManager {\n  private alg = 'RS256' as const\n  private grantType = 'client_credentials' as const\n  private clientAssertionType =\n    'urn:ietf:params:oauth:client-assertion-type:jwt-bearer' as const\n  private clientId: string\n  private clientKey: string\n  private keyId: string\n  private scope: string\n  private authServer: string\n  private httpClient: HTTPClient\n  private maxRetries: number\n  private clockSkewInSeconds = 0\n\n  private accessToken?: AccessToken\n  private tokenEmitter = new Emitter<{\n    access_token: [{ token: AccessToken } | { error: unknown }]\n  }>()\n  private retryCount: number\n  private pollerTimer?: ReturnType<typeof setTimeout>\n\n  constructor(props: TokenManagerSettings) {\n    this.keyId = props.keyId\n    this.clientId = props.clientId\n    this.clientKey = props.clientKey\n    this.authServer = props.authServer ?? 'https://oauth2.segment.io'\n    this.scope = props.scope ?? 'tracking_api:write'\n    this.httpClient = props.httpClient\n    this.maxRetries = props.maxRetries\n    this.tokenEmitter.on('access_token', (event) => {\n      if ('token' in event) {\n        this.accessToken = event.token\n      }\n    })\n    this.retryCount = 0\n  }\n\n  stopPoller() {\n    clearTimeout(this.pollerTimer)\n  }\n\n  async pollerLoop() {\n    let timeUntilRefreshInMs = 25\n    let response: HTTPResponse\n\n    try {\n      response = await this.requestAccessToken()\n    } catch (err) {\n      // Error without a status code - likely networking, retry\n      return this.handleTransientError({ error: err })\n    }\n\n    if (!isValidCustomResponse(response)) {\n      return this.handleInvalidCustomResponse()\n    }\n\n    const headers = convertHeaders(response.headers)\n    if (headers['date']) {\n      this.updateClockSkew(Date.parse(headers['date']))\n    }\n\n    // Handle status codes!\n    if (response.status === 200) {\n      try {\n        const body = await response.text()\n        const token = JSON.parse(body)\n\n        if (!isAccessToken(token)) {\n          throw new Error(\n            'Response did not contain a valid access_token and expires_in'\n          )\n        }\n\n        // Success, we have a token!\n        token.expires_at = Math.round(Date.now() / 1000) + token.expires_in\n        this.tokenEmitter.emit('access_token', { token })\n\n        // Reset our failure count\n        this.retryCount = 0\n        // Refresh the token after half the expiry time passes\n        timeUntilRefreshInMs = (token.expires_in / 2) * 1000\n        return this.queueNextPoll(timeUntilRefreshInMs)\n      } catch (err) {\n        // Something went really wrong with the body, lets surface an error and try again?\n        return this.handleTransientError({ error: err, forceEmitError: true })\n      }\n    } else if (response.status === 429) {\n      // Rate limited, wait for the reset time\n      return await this.handleRateLimited(\n        response,\n        headers,\n        timeUntilRefreshInMs\n      )\n    } else if ([400, 401, 415].includes(response.status)) {\n      // Unrecoverable errors, stops the poller\n      return this.handleUnrecoverableErrors(response)\n    } else {\n      return this.handleTransientError({\n        error: new Error(`[${response.status}] ${response.statusText}`),\n      })\n    }\n  }\n\n  private handleTransientError({\n    error,\n    forceEmitError,\n  }: {\n    error: unknown\n    forceEmitError?: boolean\n  }) {\n    this.incrementRetries({ error, forceEmitError })\n\n    const timeUntilRefreshInMs = backoff({\n      attempt: this.retryCount,\n      minTimeout: 25,\n      maxTimeout: 1000,\n    })\n    this.queueNextPoll(timeUntilRefreshInMs)\n  }\n\n  private handleInvalidCustomResponse() {\n    this.tokenEmitter.emit('access_token', {\n      error: new Error('HTTPClient does not implement response.text method'),\n    })\n  }\n\n  private async handleRateLimited(\n    response: HTTPResponse,\n    headers: Record<string, string>,\n    timeUntilRefreshInMs: number\n  ) {\n    this.incrementRetries({\n      error: new Error(`[${response.status}] ${response.statusText}`),\n    })\n\n    if (headers['x-ratelimit-reset']) {\n      const rateLimitResetTimestamp = parseInt(headers['x-ratelimit-reset'], 10)\n      if (isFinite(rateLimitResetTimestamp)) {\n        timeUntilRefreshInMs =\n          rateLimitResetTimestamp - Date.now() + this.clockSkewInSeconds * 1000\n      } else {\n        timeUntilRefreshInMs = 5 * 1000\n      }\n      // We want subsequent calls to get_token to be able to interrupt our\n      //  Timeout when it's waiting for e.g. a long normal expiration, but\n      //  not when we're waiting for a rate limit reset. Sleep instead.\n      await sleep(timeUntilRefreshInMs)\n      timeUntilRefreshInMs = 0\n    }\n\n    this.queueNextPoll(timeUntilRefreshInMs)\n  }\n\n  private handleUnrecoverableErrors(response: HTTPResponse) {\n    this.retryCount = 0\n    this.tokenEmitter.emit('access_token', {\n      error: new Error(`[${response.status}] ${response.statusText}`),\n    })\n    this.stopPoller()\n  }\n\n  private updateClockSkew(dateInMs: number) {\n    this.clockSkewInSeconds = (Date.now() - dateInMs) / 1000\n  }\n\n  private incrementRetries({\n    error,\n    forceEmitError,\n  }: {\n    error: unknown\n    forceEmitError?: boolean\n  }) {\n    this.retryCount++\n    if (forceEmitError || this.retryCount % this.maxRetries === 0) {\n      this.retryCount = 0\n      this.tokenEmitter.emit('access_token', { error: error })\n    }\n  }\n\n  private queueNextPoll(timeUntilRefreshInMs: number) {\n    this.pollerTimer = setTimeout(() => this.pollerLoop(), timeUntilRefreshInMs)\n    if (this.pollerTimer.unref) {\n      this.pollerTimer.unref()\n    }\n  }\n\n  /**\n   * Solely responsible for building the HTTP request and calling the token service.\n   */\n  private async requestAccessToken(): Promise<HTTPResponse> {\n    // Set issued at time to 5 seconds in the past to account for clock skew\n    const ISSUED_AT_BUFFER_IN_SECONDS = 5\n    const MAX_EXPIRY_IN_SECONDS = 60\n    // Final expiry time takes into account the issued at time, so need to subtract IAT buffer\n    const EXPIRY_IN_SECONDS =\n      MAX_EXPIRY_IN_SECONDS - ISSUED_AT_BUFFER_IN_SECONDS\n    const jti = uuid()\n    const currentUTCInSeconds =\n      Math.round(Date.now() / 1000) - this.clockSkewInSeconds\n    const jwtBody = {\n      iss: this.clientId,\n      sub: this.clientId,\n      aud: this.authServer,\n      iat: currentUTCInSeconds - ISSUED_AT_BUFFER_IN_SECONDS,\n      exp: currentUTCInSeconds + EXPIRY_IN_SECONDS,\n      jti,\n    }\n\n    const key = await importPKCS8(this.clientKey, 'RS256')\n    const signedJwt = await new SignJWT(jwtBody)\n      .setProtectedHeader({ alg: this.alg, kid: this.keyId, typ: 'JWT' })\n      .sign(key)\n\n    const requestBody = `grant_type=${this.grantType}&client_assertion_type=${this.clientAssertionType}&client_assertion=${signedJwt}&scope=${this.scope}`\n    const accessTokenEndpoint = `${this.authServer}/token`\n\n    const requestOptions: HTTPClientRequest = {\n      method: 'POST',\n      url: accessTokenEndpoint,\n      body: requestBody,\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      httpRequestTimeout: 10000,\n    }\n    return this.httpClient.makeRequest(requestOptions)\n  }\n\n  async getAccessToken(): Promise<AccessToken> {\n    // Use the cached token if it is still valid, otherwise wait for a new token.\n    if (this.isValidToken(this.accessToken)) {\n      return this.accessToken\n    }\n\n    // stop poller first in order to make sure that it's not sleeping if we need a token immediately\n    // Otherwise it could be hours before the expiration time passes normally\n    this.stopPoller()\n\n    // startPoller needs to be called somewhere, either lazily when a token is first requested, or at instantiation.\n    // Doing it lazily currently\n    this.pollerLoop().catch(() => {})\n\n    return new Promise((resolve, reject) => {\n      this.tokenEmitter.once('access_token', (event) => {\n        if ('token' in event) {\n          resolve(event.token)\n        } else {\n          reject(event.error)\n        }\n      })\n    })\n  }\n\n  clearToken() {\n    this.accessToken = undefined\n  }\n\n  isValidToken(token?: AccessToken): token is AccessToken {\n    return (\n      typeof token !== 'undefined' &&\n      token !== null &&\n      token.expires_in < Date.now() / 1000\n    )\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1958, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/publisher.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/plugins/segmentio/publisher.ts"],"sourcesContent":["import { backoff } from '@segment/analytics-core'\nimport type { Context } from '../../app/context'\nimport { tryCreateFormattedUrl } from '../../lib/create-url'\nimport { createDeferred } from '@segment/analytics-generic-utils'\nimport { ContextBatch } from './context-batch'\nimport { NodeEmitter } from '../../app/emitter'\nimport { HTTPClient, HTTPClientRequest } from '../../lib/http-client'\nimport { OAuthSettings } from '../../lib/types'\nimport { TokenManager } from '../../lib/token-manager'\n\nfunction sleep(timeoutInMs: number): Promise<void> {\n  return new Promise((resolve) => setTimeout(resolve, timeoutInMs))\n}\n\nfunction noop() {}\n\ninterface PendingItem {\n  resolver: (ctx: Context) => void\n  context: Context\n}\n\nexport interface PublisherProps {\n  host?: string\n  path?: string\n  flushInterval: number\n  flushAt: number\n  maxRetries: number\n  writeKey: string\n  httpRequestTimeout?: number\n  disable?: boolean\n  httpClient: HTTPClient\n  oauthSettings?: OAuthSettings\n}\n\n/**\n * The Publisher is responsible for batching events and sending them to the Segment API.\n */\nexport class Publisher {\n  private pendingFlushTimeout?: ReturnType<typeof setTimeout>\n  private _batch?: ContextBatch\n\n  private _flushInterval: number\n  private _flushAt: number\n  private _maxRetries: number\n  private _url: string\n  private _flushPendingItemsCount?: number\n  private _httpRequestTimeout: number\n  private _emitter: NodeEmitter\n  private _disable: boolean\n  private _httpClient: HTTPClient\n  private _writeKey: string\n  private _tokenManager: TokenManager | undefined\n\n  constructor(\n    {\n      host,\n      path,\n      maxRetries,\n      flushAt,\n      flushInterval,\n      writeKey,\n      httpRequestTimeout,\n      httpClient,\n      disable,\n      oauthSettings,\n    }: PublisherProps,\n    emitter: NodeEmitter\n  ) {\n    this._emitter = emitter\n    this._maxRetries = maxRetries\n    this._flushAt = Math.max(flushAt, 1)\n    this._flushInterval = flushInterval\n    this._url = tryCreateFormattedUrl(\n      host ?? 'https://api.segment.io',\n      path ?? '/v1/batch'\n    )\n    this._httpRequestTimeout = httpRequestTimeout ?? 10000\n    this._disable = Boolean(disable)\n    this._httpClient = httpClient\n    this._writeKey = writeKey\n\n    if (oauthSettings) {\n      this._tokenManager = new TokenManager({\n        ...oauthSettings,\n        httpClient: oauthSettings.httpClient ?? httpClient,\n        maxRetries: oauthSettings.maxRetries ?? maxRetries,\n      })\n    }\n  }\n\n  private createBatch(): ContextBatch {\n    this.pendingFlushTimeout && clearTimeout(this.pendingFlushTimeout)\n    const batch = new ContextBatch(this._flushAt)\n    this._batch = batch\n    this.pendingFlushTimeout = setTimeout(() => {\n      if (batch === this._batch) {\n        this._batch = undefined\n      }\n      this.pendingFlushTimeout = undefined\n      if (batch.length) {\n        this.send(batch).catch(noop)\n      }\n    }, this._flushInterval)\n    return batch\n  }\n\n  private clearBatch() {\n    this.pendingFlushTimeout && clearTimeout(this.pendingFlushTimeout)\n    this._batch = undefined\n  }\n\n  flush(pendingItemsCount: number): void {\n    if (!pendingItemsCount) {\n      // if number of pending items is 0, there will never be anything else entering the batch, since the app is closed.\n      if (this._tokenManager) {\n        this._tokenManager.stopPoller()\n      }\n      return\n    }\n\n    this._flushPendingItemsCount = pendingItemsCount\n\n    // if batch is empty, there's nothing to flush, and when things come in, enqueue will handle them.\n    if (!this._batch) return\n\n    // the number of globally pending items will always be larger or the same as batch size.\n    // Any mismatch is because some globally pending items are in plugins.\n    const isExpectingNoMoreItems = this._batch.length === pendingItemsCount\n    if (isExpectingNoMoreItems) {\n      this.send(this._batch)\n        .catch(noop)\n        .finally(() => {\n          // stop poller so program can exit ().\n          if (this._tokenManager) {\n            this._tokenManager.stopPoller()\n          }\n        })\n      this.clearBatch()\n    }\n  }\n\n  /**\n   * Enqueues the context for future delivery.\n   * @param ctx - Context containing a Segment event.\n   * @returns a promise that resolves with the context after the event has been delivered.\n   */\n  enqueue(ctx: Context): Promise<Context> {\n    const batch = this._batch ?? this.createBatch()\n\n    const { promise: ctxPromise, resolve } = createDeferred<Context>()\n\n    const pendingItem: PendingItem = {\n      context: ctx,\n      resolver: resolve,\n    }\n\n    /*\n      The following logic ensures that a batch is never orphaned,\n      and is always sent before a new batch is created.\n\n      Add an event to the existing batch.\n        Success: Check if batch is full or no more items are expected to come in (i.e. closing). If so, send batch.\n        Failure: Assume event is too big to fit in current batch - send existing batch.\n          Add an event to the new batch.\n            Success: Check if batch is full and send if it is.\n            Failure: Event exceeds maximum size (it will never fit), fail the event.\n    */\n    const addStatus = batch.tryAdd(pendingItem)\n    if (addStatus.success) {\n      const isExpectingNoMoreItems =\n        batch.length === this._flushPendingItemsCount\n      const isFull = batch.length === this._flushAt\n      if (isFull || isExpectingNoMoreItems) {\n        this.send(batch).catch(noop)\n        this.clearBatch()\n      }\n      return ctxPromise\n    }\n\n    // If the new item causes the maximimum event size to be exceeded, send the current batch and create a new one.\n    if (batch.length) {\n      this.send(batch).catch(noop)\n      this.clearBatch()\n    }\n\n    const fallbackBatch = this.createBatch()\n\n    const fbAddStatus = fallbackBatch.tryAdd(pendingItem)\n\n    if (fbAddStatus.success) {\n      const isExpectingNoMoreItems =\n        fallbackBatch.length === this._flushPendingItemsCount\n      if (isExpectingNoMoreItems) {\n        this.send(fallbackBatch).catch(noop)\n        this.clearBatch()\n      }\n      return ctxPromise\n    } else {\n      // this should only occur if max event size is exceeded\n      ctx.setFailedDelivery({\n        reason: new Error(fbAddStatus.message),\n      })\n      return Promise.resolve(ctx)\n    }\n  }\n\n  private async send(batch: ContextBatch) {\n    if (this._flushPendingItemsCount) {\n      this._flushPendingItemsCount -= batch.length\n    }\n    const events = batch.getEvents()\n    const maxAttempts = this._maxRetries + 1\n\n    let currentAttempt = 0\n    while (currentAttempt < maxAttempts) {\n      currentAttempt++\n\n      let requestedRetryTimeout: number | undefined\n      let failureReason: unknown\n      try {\n        if (this._disable) {\n          return batch.resolveEvents()\n        }\n\n        let authString = undefined\n        if (this._tokenManager) {\n          const token = await this._tokenManager.getAccessToken()\n          if (token && token.access_token) {\n            authString = `Bearer ${token.access_token}`\n          }\n        }\n\n        const headers: Record<string, string> = {\n          'Content-Type': 'application/json',\n          'User-Agent': 'analytics-node-next/latest',\n          ...(authString ? { Authorization: authString } : {}),\n        }\n\n        const request: HTTPClientRequest = {\n          url: this._url,\n          method: 'POST',\n          headers: headers,\n          body: JSON.stringify({\n            batch: events,\n            writeKey: this._writeKey,\n            sentAt: new Date(),\n          }),\n          httpRequestTimeout: this._httpRequestTimeout,\n        }\n\n        this._emitter.emit('http_request', {\n          body: request.body,\n          method: request.method,\n          url: request.url,\n          headers: request.headers,\n        })\n\n        const response = await this._httpClient.makeRequest(request)\n\n        if (response.status >= 200 && response.status < 300) {\n          // Successfully sent events, so exit!\n          batch.resolveEvents()\n          return\n        } else if (\n          this._tokenManager &&\n          (response.status === 400 ||\n            response.status === 401 ||\n            response.status === 403)\n        ) {\n          // Retry with a new OAuth token if we have OAuth data\n          this._tokenManager.clearToken()\n          failureReason = new Error(\n            `[${response.status}] ${response.statusText}`\n          )\n        } else if (response.status === 400) {\n          // https://segment.com/docs/connections/sources/catalog/libraries/server/http-api/#max-request-size\n          // Request either malformed or size exceeded - don't retry.\n          resolveFailedBatch(\n            batch,\n            new Error(`[${response.status}] ${response.statusText}`)\n          )\n          return\n        } else if (response.status === 429) {\n          // Rate limited, wait for the reset time\n          if (response.headers && 'x-ratelimit-reset' in response.headers) {\n            const rateLimitResetTimestamp = parseInt(\n              response.headers['x-ratelimit-reset'],\n              10\n            )\n            if (isFinite(rateLimitResetTimestamp)) {\n              requestedRetryTimeout = rateLimitResetTimestamp - Date.now()\n            }\n          }\n          failureReason = new Error(\n            `[${response.status}] ${response.statusText}`\n          )\n        } else {\n          // Treat other errors as transient and retry.\n          failureReason = new Error(\n            `[${response.status}] ${response.statusText}`\n          )\n        }\n      } catch (err) {\n        // Network errors get thrown, retry them.\n        failureReason = err\n      }\n\n      // Final attempt failed, update context and resolve events.\n      if (currentAttempt === maxAttempts) {\n        resolveFailedBatch(batch, failureReason)\n        return\n      }\n\n      // Retry after attempt-based backoff.\n      await sleep(\n        requestedRetryTimeout\n          ? requestedRetryTimeout\n          : backoff({\n              attempt: currentAttempt,\n              minTimeout: 25,\n              maxTimeout: 1000,\n            })\n      )\n    }\n  }\n}\n\nfunction resolveFailedBatch(batch: ContextBatch, reason: unknown) {\n  batch.getContexts().forEach((ctx) => ctx.setFailedDelivery({ reason }))\n  batch.resolveEvents()\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2205, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/lib/env.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/lib/env.ts"],"sourcesContent":["/* eslint-disable no-restricted-globals */\nexport type RuntimeEnv =\n  | 'node'\n  | 'browser'\n  | 'web-worker'\n  | 'cloudflare-worker'\n  | 'vercel-edge'\n  | 'unknown'\n\nexport const detectRuntime = (): RuntimeEnv => {\n  if (\n    typeof process === 'object' &&\n    process &&\n    typeof process.env === 'object' &&\n    process.env &&\n    typeof process.version === 'string'\n  ) {\n    return 'node'\n  }\n\n  if (typeof window === 'object') {\n    return 'browser'\n  }\n\n  // @ts-ignore\n  if (typeof WebSocketPair !== 'undefined') {\n    return 'cloudflare-worker'\n  }\n\n  // @ts-ignore\n  if (typeof EdgeRuntime === 'string') {\n    return 'vercel-edge'\n  }\n\n  if (\n    // @ts-ignore\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // @ts-ignore\n    typeof importScripts === 'function'\n  ) {\n    return 'web-worker'\n  }\n\n  return 'unknown'\n}\n"],"names":[],"mappings":";;;;AASO,MAAM,aAAa,GAAG,GAAe,EAAE;IAC5C,IACE,OAAO,OAAO,KAAK,QAAQ,IAC3B,OAAO,IACP,OAAO,OAAO,CAAC,GAAG,KAAK,QAAQ,IAC/B,OAAO,CAAC,GAAG,IACX,OAAO,OAAO,CAAC,OAAO,KAAK,QAAQ,EACnC;QACA,OAAO,MAAM,CAAA;KACd;IAED,IAAI,OAAO,MAAM,KAAK,QAAQ,EAAE;;IAIhC,aAAa;IACb,IAAI,OAAO,aAAa,KAAK,WAAW,EAAE;QACxC,OAAO,mBAAmB,CAAA;KAC3B;IAED,aAAa;IACb,IAAI,OAAO,WAAW,KAAK,QAAQ,EAAE;QACnC,OAAO,aAAa,CAAA;KACrB;IAED,IACE,aAAa;IACb,OAAO,iBAAiB,KAAK,WAAW,IACxC,aAAa;IACb,OAAO,aAAa,KAAK,UAAU,EACnC;QACA,OAAO,YAAY,CAAA;KACpB;IAED,OAAO,SAAS,CAAA;AAClB,CAAC,CAAA"}},
    {"offset": {"line": 2234, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/plugins/segmentio/index.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/plugins/segmentio/index.ts"],"sourcesContent":["import { Publisher, PublisherProps } from './publisher'\nimport { version } from '../../generated/version'\nimport { detectRuntime } from '../../lib/env'\nimport { Plugin } from '../../app/types'\nimport { Context } from '../../app/context'\nimport { NodeEmitter } from '../../app/emitter'\n\nfunction normalizeEvent(ctx: Context) {\n  ctx.updateEvent('context.library.name', '@segment/analytics-node')\n  ctx.updateEvent('context.library.version', version)\n  const runtime = detectRuntime()\n  if (runtime === 'node') {\n    // eslint-disable-next-line no-restricted-globals\n    ctx.updateEvent('_metadata.nodeVersion', process.version)\n  }\n  ctx.updateEvent('_metadata.jsRuntime', runtime)\n}\n\ntype DefinedPluginFields =\n  | 'name'\n  | 'type'\n  | 'version'\n  | 'isLoaded'\n  | 'load'\n  | 'alias'\n  | 'group'\n  | 'identify'\n  | 'page'\n  | 'screen'\n  | 'track'\n\ntype SegmentNodePlugin = Plugin & Required<Pick<Plugin, DefinedPluginFields>>\n\nexport type ConfigureNodePluginProps = PublisherProps\n\nexport function createNodePlugin(publisher: Publisher): SegmentNodePlugin {\n  function action(ctx: Context): Promise<Context> {\n    normalizeEvent(ctx)\n    return publisher.enqueue(ctx)\n  }\n\n  return {\n    name: 'Segment.io',\n    type: 'destination',\n    version: '1.0.0',\n    isLoaded: () => true,\n    load: () => Promise.resolve(),\n    alias: action,\n    group: action,\n    identify: action,\n    page: action,\n    screen: action,\n    track: action,\n  }\n}\n\nexport const createConfiguredNodePlugin = (\n  props: ConfigureNodePluginProps,\n  emitter: NodeEmitter\n) => {\n  const publisher = new Publisher(props, emitter)\n  return {\n    publisher: publisher,\n    plugin: createNodePlugin(publisher),\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA,OAAO,EAAE,SAAS,EAAkB,MAAM,aAAa,CAAA;AACvD,OAAO,EAAE,OAAO,EAAE,MAAM,yBAAyB,CAAA;AACjD,OAAO,EAAE,aAAa,EAAE,MAAM,eAAe,CAAA;;;;AAK7C,SAAS,cAAc,CAAC,GAAY;IAClC,GAAG,CAAC,WAAW,CAAC,sBAAsB,EAAE,yBAAyB,CAAC,CAAA;IAClE,GAAG,CAAC,WAAW,CAAC,yBAAyB,EAAE,kMAAO,CAAC,CAAA;IACnD,MAAM,OAAO,OAAG,8LAAa,EAAE,CAAA;IAC/B,IAAI,OAAO,KAAK,MAAM,EAAE;QACtB,iDAAiD;QACjD,GAAG,CAAC,WAAW,CAAC,uBAAuB,EAAE,OAAO,CAAC,OAAO,CAAC,CAAA;KAC1D;IACD,GAAG,CAAC,WAAW,CAAC,qBAAqB,EAAE,OAAO,CAAC,CAAA;AACjD,CAAC;AAmBK,SAAU,gBAAgB,CAAC,SAAoB;IACnD,SAAS,MAAM,CAAC,GAAY;QAC1B,cAAc,CAAC,GAAG,CAAC,CAAA;QACnB,OAAO,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,CAAA;IAC/B,CAAC;IAED,OAAO;QACL,IAAI,EAAE,YAAY;QAClB,IAAI,EAAE,aAAa;QACnB,OAAO,EAAE,OAAO;QAChB,QAAQ,EAAE,GAAG,CAAG,CAAD,GAAK;QACpB,IAAI,EAAE,GAAG,CAAG,CAAD,MAAQ,CAAC,OAAO,EAAE;QAC7B,KAAK,EAAE,MAAM;QACb,KAAK,EAAE,MAAM;QACb,QAAQ,EAAE,MAAM;QAChB,IAAI,EAAE,MAAM;QACZ,MAAM,EAAE,MAAM;QACd,KAAK,EAAE,MAAM;KACd,CAAA;AACH,CAAC;AAEM,MAAM,0BAA0B,GAAG,CACxC,KAA+B,EAC/B,OAAoB,EACpB,EAAE;IACF,MAAM,SAAS,GAAG,IAAI,iNAAS,CAAC,KAAK,EAAE,OAAO,CAAC,CAAA;IAC/C,OAAO;QACL,SAAS,EAAE,SAAS;QACpB,MAAM,EAAE,gBAAgB,CAAC,SAAS,CAAC;KACpC,CAAA;AACH,CAAC,CAAA"}},
    {"offset": {"line": 2286, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/lib/get-message-id.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/lib/get-message-id.ts"],"sourcesContent":["import { uuid } from './uuid'\n\n/**\n * get a unique messageId with a very low chance of collisions\n * using @lukeed/uuid/secure uses the node crypto module, which is the fastest\n * @example \"node-next-1668208232027-743be593-7789-4b74-8078-cbcc8894c586\"\n */\nexport const createMessageId = (): string => {\n  return `node-next-${Date.now()}-${uuid()}`\n}\n"],"names":[],"mappings":";;;;;AAAA,OAAO,EAAE,IAAI,EAAE,MAAM,QAAQ,CAAA;;AAOtB,MAAM,eAAe,GAAG,GAAW,EAAE;IAC1C,OAAO,CAAA,UAAA,EAAa,IAAI,CAAC,GAAG,EAAE,CAAA,CAAA,MAAI,0LAAI,EAAE,GAAE,CAAA;AAC5C,CAAC,CAAA"}},
    {"offset": {"line": 2300, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/app/event-factory.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/app/event-factory.ts"],"sourcesContent":["import { assertUserIdentity, CoreEventFactory } from '@segment/analytics-core'\nimport { createMessageId } from '../lib/get-message-id'\nimport { SegmentEvent } from './types'\n\n// use declaration merging to downcast CoreSegmentEvent without adding any runtime code.\n// if/when we decide to add an actual implementation to NodeEventFactory that actually changes the event shape, we can remove this.\nexport interface NodeEventFactory {\n  alias(...args: Parameters<CoreEventFactory['alias']>): SegmentEvent\n  group(...args: Parameters<CoreEventFactory['group']>): SegmentEvent\n  identify(...args: Parameters<CoreEventFactory['identify']>): SegmentEvent\n  track(...args: Parameters<CoreEventFactory['track']>): SegmentEvent\n  page(...args: Parameters<CoreEventFactory['page']>): SegmentEvent\n  screen(...args: Parameters<CoreEventFactory['screen']>): SegmentEvent\n}\n\nexport class NodeEventFactory extends CoreEventFactory {\n  constructor() {\n    super({\n      createMessageId,\n      onFinishedEvent: (event) => {\n        assertUserIdentity(event)\n      },\n    })\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,OAAO,EAAE,kBAAkB,EAAE,gBAAgB,EAAE,MAAM,yBAAyB,CAAA;AAC9E,OAAO,EAAE,eAAe,EAAE,MAAM,uBAAuB,CAAA;;;AAcjD,MAAO,gBAAiB,SAAQ,sNAAgB;IACpD,aAAA;QACE,KAAK,CAAC;6BACJ,iNAAe;YACf,eAAe,EAAE,CAAC,KAAK,EAAE,EAAE;oBACzB,iNAAkB,EAAC,KAAK,CAAC,CAAA;YAC3B,CAAC;SACF,CAAC,CAAA;IACJ,CAAC;CACF"}},
    {"offset": {"line": 2323, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/app/context.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/app/context.ts"],"sourcesContent":["// create a derived class since we may want to add node specific things to Context later\n\nimport { CoreContext } from '@segment/analytics-core'\nimport { SegmentEvent } from './types'\n\n// While this is not a type, it is a definition\nexport class Context extends CoreContext<SegmentEvent> {\n  static override system() {\n    return new this({ type: 'track', event: 'system' })\n  }\n}\n"],"names":[],"mappings":"AAAA,wFAAwF;;;;;AAExF,OAAO,EAAE,WAAW,EAAE,MAAM,yBAAyB,CAAA;;AAI/C,MAAO,OAAQ,SAAQ,kMAAyB;IACpD,MAAM,CAAU,MAAM,GAAA;QACpB,OAAO,IAAI,IAAI,CAAC;YAAE,IAAI,EAAE,OAAO;YAAE,KAAK,EAAE,QAAQ;QAAA,CAAE,CAAC,CAAA;IACrD,CAAC;CACF"}},
    {"offset": {"line": 2342, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/app/dispatch-emit.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/app/dispatch-emit.ts"],"sourcesContent":["import { dispatch } from '@segment/analytics-core'\nimport type { NodeEmitter } from './emitter'\nimport { Context } from './context'\nimport { NodeEventQueue } from './event-queue'\nimport { SegmentEvent } from './types'\n\nexport type Callback = (err?: unknown, ctx?: Context) => void\n\nconst normalizeDispatchCb = (cb: Callback) => (ctx: Context) => {\n  const failedDelivery = ctx.failedDelivery()\n  return failedDelivery ? cb(failedDelivery.reason, ctx) : cb(undefined, ctx)\n}\n\n/* Dispatch function, but swallow promise rejections and use event emitter instead */\nexport const dispatchAndEmit = async (\n  event: SegmentEvent,\n  queue: NodeEventQueue,\n  emitter: NodeEmitter,\n  callback?: Callback\n): Promise<void> => {\n  try {\n    const context = new Context(event)\n    const ctx = await dispatch(context, queue, emitter, {\n      ...(callback ? { callback: normalizeDispatchCb(callback) } : {}),\n    })\n    const failedDelivery = ctx.failedDelivery()\n    if (failedDelivery) {\n      emitter.emit('error', {\n        code: 'delivery_failure',\n        reason: failedDelivery.reason,\n        ctx: ctx,\n      })\n    } else {\n      emitter.emit(event.type, ctx)\n    }\n  } catch (err) {\n    emitter.emit('error', {\n      code: 'unknown',\n      reason: err,\n    })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA,OAAO,EAAE,QAAQ,EAAE,MAAM,yBAAyB,CAAA;AAElD,OAAO,EAAE,OAAO,EAAE,MAAM,WAAW,CAAA;;;AAMnC,MAAM,mBAAmB,GAAG,CAAC,EAAY,EAAE,CAAG,CAAD,AAAE,GAAY,EAAE,EAAE;QAC7D,MAAM,cAAc,GAAG,GAAG,CAAC,cAAc,EAAE,CAAA;QAC3C,OAAO,cAAc,CAAC,CAAC,CAAC,EAAE,CAAC,cAAc,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,SAAS,EAAE,GAAG,CAAC,CAAA;IAC7E,CAAC,CAAA;AAGM,MAAM,eAAe,GAAG,KAAK,EAClC,KAAmB,EACnB,KAAqB,EACrB,OAAoB,EACpB,QAAmB,EACJ,EAAE;IACjB,IAAI;QACF,MAAM,OAAO,GAAG,IAAI,4LAAO,CAAC,KAAK,CAAC,CAAA;QAClC,MAAM,GAAG,GAAG,UAAM,oMAAQ,EAAC,OAAO,EAAE,KAAK,EAAE,OAAO,EAAE;YAClD,GAAG,AAAC,QAAQ,CAAC,CAAC,CAAC;gBAAE,QAAQ,EAAE,mBAAmB,CAAC,QAAQ,CAAC;YAAA,CAAE,CAAC,CAAC,CAAC,CAAA,CAAE,CAAC;SACjE,CAAC,CAAA;QACF,MAAM,cAAc,GAAG,GAAG,CAAC,cAAc,EAAE,CAAA;QAC3C,IAAI,cAAc,EAAE;YAClB,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE;gBACpB,IAAI,EAAE,kBAAkB;gBACxB,MAAM,EAAE,cAAc,CAAC,MAAM;gBAC7B,GAAG,EAAE,GAAG;aACT,CAAC,CAAA;SACH,MAAM;YACL,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,GAAG,CAAC,CAAA;SAC9B;KACF,CAAC,OAAO,GAAG,EAAE;QACZ,OAAO,CAAC,IAAI,CAAC,OAAO,EAAE;YACpB,IAAI,EAAE,SAAS;YACf,MAAM,EAAE,GAAG;SACZ,CAAC,CAAA;KACH;AACH,CAAC,CAAA"}},
    {"offset": {"line": 2383, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/app/emitter.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/app/emitter.ts"],"sourcesContent":["import type { CoreEmitterContract } from '@segment/analytics-core'\nimport { Emitter } from '@segment/analytics-generic-utils'\nimport { Context } from './context'\nimport type { AnalyticsSettings } from './settings'\nimport { SegmentEvent } from './types'\n\n/**\n * Map of emitter event names to method args.\n */\nexport type NodeEmitterEvents = CoreEmitterContract<Context> & {\n  initialize: [AnalyticsSettings]\n  call_after_close: [SegmentEvent] // any event that did not get dispatched due to close\n  http_request: [\n    {\n      url: string\n      method: string\n      headers: Record<string, string>\n      body: string\n    }\n  ]\n  drained: []\n}\n\nexport class NodeEmitter extends Emitter<NodeEmitterEvents> {}\n"],"names":[],"mappings":";;;;AACA,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAA;;AAsBpD,MAAO,WAAY,SAAQ,4MAA0B;CAAG"}},
    {"offset": {"line": 2395, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/app/event-queue.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/app/event-queue.ts"],"sourcesContent":["import { CoreEventQueue, PriorityQueue } from '@segment/analytics-core'\nimport type { Plugin } from '../app/types'\nimport type { Context } from './context'\n\nclass NodePriorityQueue extends PriorityQueue<Context> {\n  constructor() {\n    super(1, [])\n  }\n  // do not use an internal \"seen\" map\n  getAttempts(ctx: Context): number {\n    return ctx.attempts ?? 0\n  }\n  updateAttempts(ctx: Context): number {\n    ctx.attempts = this.getAttempts(ctx) + 1\n    return this.getAttempts(ctx)\n  }\n}\n\nexport class NodeEventQueue extends CoreEventQueue<Context, Plugin> {\n  constructor() {\n    super(new NodePriorityQueue())\n  }\n}\n"],"names":[],"mappings":";;;;;AAAA,OAAO,EAAE,cAAc,EAAE,aAAa,EAAE,MAAM,yBAAyB,CAAA;;AAIvE,MAAM,iBAAkB,SAAQ,8MAAsB;IACpD,aAAA;QACE,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAA;IACd,CAAC;IACD,oCAAoC;IACpC,WAAW,CAAC,GAAY,EAAA;QACtB,OAAO,GAAG,CAAC,QAAQ,IAAI,CAAC,CAAA;IAC1B,CAAC;IACD,cAAc,CAAC,GAAY,EAAA;QACzB,GAAG,CAAC,QAAQ,GAAG,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,CAAC,CAAA;QACxC,OAAO,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAA;IAC9B,CAAC;CACF;AAEK,MAAO,cAAe,SAAQ,4MAA+B;IACjE,aAAA;QACE,KAAK,CAAC,IAAI,iBAAiB,EAAE,CAAC,CAAA;IAChC,CAAC;CACF"}},
    {"offset": {"line": 2424, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/lib/abort.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/lib/abort.ts"],"sourcesContent":["/**\n * use non-native event emitter for the benefit of non-node runtimes like CF workers.\n */\nimport { Emitter } from '@segment/analytics-generic-utils'\nimport { detectRuntime } from './env'\n\n/**\n * adapted from: https://www.npmjs.com/package/node-abort-controller\n */\nexport class AbortSignal {\n  onabort: globalThis.AbortSignal['onabort'] = null\n  aborted = false\n  eventEmitter = new Emitter()\n\n  toString() {\n    return '[object AbortSignal]'\n  }\n  get [Symbol.toStringTag]() {\n    return 'AbortSignal'\n  }\n  removeEventListener(...args: Parameters<Emitter['off']>) {\n    this.eventEmitter.off(...args)\n  }\n  addEventListener(...args: Parameters<Emitter['on']>) {\n    this.eventEmitter.on(...args)\n  }\n  dispatchEvent(type: string) {\n    const event = { type, target: this }\n\n    const handlerName = `on${type}`\n\n    if (typeof (this as any)[handlerName] === 'function') {\n      ;(this as any)[handlerName](event)\n    }\n\n    this.eventEmitter.emit(type, event)\n  }\n}\n\n/**\n * This polyfill is only neccessary to support versions of node < 14.17.\n * Can be removed once node 14 support is dropped.\n */\nexport class AbortController {\n  signal = new AbortSignal()\n  abort() {\n    if (this.signal.aborted) return\n\n    this.signal.aborted = true\n    this.signal.dispatchEvent('abort')\n  }\n  toString() {\n    return '[object AbortController]'\n  }\n  get [Symbol.toStringTag]() {\n    return 'AbortController'\n  }\n}\n\n/**\n * @param timeoutMs - Set a request timeout, after which the request is cancelled.\n */\nexport const abortSignalAfterTimeout = (timeoutMs: number) => {\n  if (detectRuntime() === 'cloudflare-worker') {\n    return [] // TODO: this is broken in cloudflare workers, otherwise results in \"A hanging Promise was canceled...\" error.\n  }\n  const ac = new (globalThis.AbortController || AbortController)()\n\n  const timeoutId = setTimeout(() => {\n    ac.abort()\n  }, timeoutMs)\n\n  // Allow Node.js processes to exit early if only the timeout is running\n  timeoutId?.unref?.()\n\n  return [ac.signal, timeoutId] as const\n}\n"],"names":[],"mappings":"AAAA;;GAEG;;;;;;;;AACH,OAAO,EAAE,OAAO,EAAE,MAAM,kCAAkC,CAAA;AAC1D,OAAO,EAAE,aAAa,EAAE,MAAM,OAAO,CAAA;;;AAK/B,MAAO,WAAW;IACtB,OAAO,GAAsC,IAAI,CAAA;IACjD,OAAO,GAAG,KAAK,CAAA;IACf,YAAY,GAAG,IAAI,4MAAO,EAAE,CAAA;IAE5B,QAAQ,GAAA;QACN,OAAO,sBAAsB,CAAA;IAC/B,CAAC;IACD,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,GAAA;QACtB,OAAO,aAAa,CAAA;IACtB,CAAC;IACD,mBAAmB,CAAC,GAAG,IAAgC,EAAA;QACrD,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,GAAG,IAAI,CAAC,CAAA;IAChC,CAAC;IACD,gBAAgB,CAAC,GAAG,IAA+B,EAAA;QACjD,IAAI,CAAC,YAAY,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,CAAA;IAC/B,CAAC;IACD,aAAa,CAAC,IAAY,EAAA;QACxB,MAAM,KAAK,GAAG;YAAE,IAAI;YAAE,MAAM,EAAE,IAAI;QAAA,CAAE,CAAA;QAEpC,MAAM,WAAW,GAAG,CAAA,EAAA,EAAK,IAAI,EAAE,CAAA;QAE/B,IAAI,OAAQ,IAAY,CAAC,WAAW,CAAC,KAAK,UAAU,EAAE;;YAClD,IAAY,CAAC,WAAW,CAAC,CAAC,KAAK,CAAC,CAAA;SACnC;QAED,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,EAAE,KAAK,CAAC,CAAA;IACrC,CAAC;CACF;AAMK,MAAO,eAAe;IAC1B,MAAM,GAAG,IAAI,WAAW,EAAE,CAAA;IAC1B,KAAK,GAAA;QACH,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,OAAM;QAE/B,IAAI,CAAC,MAAM,CAAC,OAAO,GAAG,IAAI,CAAA;QAC1B,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,CAAA;IACpC,CAAC;IACD,QAAQ,GAAA;QACN,OAAO,0BAA0B,CAAA;IACnC,CAAC;IACD,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,GAAA;QACtB,OAAO,iBAAiB,CAAA;IAC1B,CAAC;CACF;AAKM,MAAM,uBAAuB,GAAG,CAAC,SAAiB,EAAE,EAAE;IAC3D,QAAI,8LAAa,EAAE,MAAK,mBAAmB,EAAE;QAC3C,OAAO,EAAE,CAAA,CAAC,8GAA8G;KACzH;IACD,MAAM,EAAE,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,IAAI,eAAe,CAAC,EAAE,CAAA;IAEhE,MAAM,SAAS,GAAG,UAAU,CAAC,GAAG,EAAE;QAChC,EAAE,CAAC,KAAK,EAAE,CAAA;IACZ,CAAC,EAAE,SAAS,CAAC,CAAA;IAEb,uEAAuE;IACvE,SAAS,EAAE,KAAK,EAAE,EAAE,CAAA;IAEpB,OAAO;QAAC,EAAE,CAAC,MAAM;QAAE,SAAS;KAAU,CAAA;AACxC,CAAC,CAAA"}},
    {"offset": {"line": 2500, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/lib/fetch.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/lib/fetch.ts"],"sourcesContent":["import type { HTTPFetchFn } from './http-client'\n\nexport const fetch: HTTPFetchFn = async (...args) => {\n  if (globalThis.fetch) {\n    return globalThis.fetch(...args)\n  }\n  // This guard causes is important, as it causes dead-code elimination to be enabled inside this block.\n  // @ts-ignore\n  else if (typeof EdgeRuntime !== 'string') {\n    return (await import('node-fetch')).default(...args)\n  } else {\n    throw new Error(\n      'Invariant: an edge runtime that does not support fetch should not exist'\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAEO,MAAM,KAAK,GAAgB,KAAK,EAAE,GAAG,IAAI,EAAE,EAAE;IAClD,IAAI,UAAU,CAAC,KAAK,EAAE;QACpB,OAAO,UAAU,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,CAAA;KACjC,MAGI,IAAI,OAAO,WAAW,KAAK,QAAQ,EAAE;QACxC,OAAO,CAAC,MAAM,MAAM,CAAC,YAAY,8FAAC,CAAC,CAAC,OAAO,CAAC,GAAG,IAAI,CAAC,CAAA;KACrD,MAAM;QACL,MAAM,IAAI,KAAK,CACb,yEAAyE,CAC1E,CAAA;KACF;AACH,CAAC,CAAA"}},
    {"offset": {"line": 2517, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/lib/http-client.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/lib/http-client.ts"],"sourcesContent":["import { abortSignalAfterTimeout } from './abort'\nimport { fetch as defaultFetch } from './fetch'\n\n/**\n * This interface is meant to be compatible with different fetch implementations (node and browser).\n * Using the ambient fetch type is not possible because the AbortSignal type is not compatible with node-fetch.\n * @link https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API\n */\nexport interface HTTPFetchFn {\n  (url: string, requestInit: HTTPFetchRequest): Promise<HTTPResponse>\n}\n\n/**\n * This interface is meant to be compatible with the Request interface.\n * @link https://developer.mozilla.org/en-US/docs/Web/API/Request\n */\nexport interface HTTPFetchRequest {\n  headers: Record<string, string>\n  body: string\n  method: HTTPClientRequest['method']\n  signal: any // AbortSignal type does not play nicely with node-fetch\n}\n\n/**\n * This interface is meant to be compatible with the Headers interface.\n * @link https://developer.mozilla.org/en-US/docs/Web/API/Headers\n */\nexport interface HTTPHeaders {\n  get: (key: string) => string | null\n  has: (key: string) => boolean\n  entries: () => IterableIterator<[string, any]>\n}\n\n/**\n * This interface is meant to very minimally conform to the Response interface.\n * @link https://developer.mozilla.org/en-US/docs/Web/API/Response\n */\nexport interface HTTPResponse {\n  headers?: Record<string, any> | HTTPHeaders\n  text?: () => Promise<string>\n  status: number\n  statusText: string\n}\n\n/**\n * This interface is meant to be a generic interface for making HTTP requests.\n * While it may overlap with fetch's Request interface, it is not coupled to it.\n */\nexport interface HTTPClientRequest {\n  /**\n   * URL to be used for the request\n   * @example 'https://api.segment.io/v1/batch'\n   */\n  url: string\n  /**\n   * HTTP method to be used for the request. This will always be a 'POST' request.\n   **/\n  method: 'POST'\n  /**\n   * Headers to be sent with the request\n   */\n  headers: Record<string, string>\n  /**\n   * Data to be sent with the request\n   */\n  body: string\n  /**\n   * Specifies the timeout (in milliseconds) for an HTTP client to get an HTTP response from the server\n   * @example 10000\n   */\n  httpRequestTimeout: number\n}\n\n/**\n * HTTP client interface for making requests\n */\nexport interface HTTPClient {\n  makeRequest(_options: HTTPClientRequest): Promise<HTTPResponse>\n}\n\n/**\n * Default HTTP client implementation using fetch\n */\nexport class FetchHTTPClient implements HTTPClient {\n  private _fetch: HTTPFetchFn\n  constructor(fetchFn?: HTTPFetchFn) {\n    this._fetch = fetchFn ?? defaultFetch\n  }\n  async makeRequest(options: HTTPClientRequest): Promise<HTTPResponse> {\n    const [signal, timeoutId] = abortSignalAfterTimeout(\n      options.httpRequestTimeout\n    )\n\n    const requestInit = {\n      url: options.url,\n      method: options.method,\n      headers: options.headers,\n      body: options.body,\n      signal: signal,\n    }\n\n    return this._fetch(options.url, requestInit).finally(() =>\n      clearTimeout(timeoutId)\n    )\n  }\n}\n"],"names":[],"mappings":";;;;AAAA,OAAO,EAAE,uBAAuB,EAAE,MAAM,SAAS,CAAA;AACjD,OAAO,EAAE,KAAK,IAAI,YAAY,EAAE,MAAM,SAAS,CAAA;;;AAkFzC,MAAO,eAAe;IAClB,MAAM,CAAa;IAC3B,YAAY,OAAqB,CAAA;QAC/B,IAAI,CAAC,MAAM,GAAG,OAAO,IAAI,wLAAY,CAAA;IACvC,CAAC;IACD,KAAK,CAAC,WAAW,CAAC,OAA0B,EAAA;QAC1C,MAAM,CAAC,MAAM,EAAE,SAAS,CAAC,OAAG,0MAAuB,EACjD,OAAO,CAAC,kBAAkB,CAC3B,CAAA;QAED,MAAM,WAAW,GAAG;YAClB,GAAG,EAAE,OAAO,CAAC,GAAG;YAChB,MAAM,EAAE,OAAO,CAAC,MAAM;YACtB,OAAO,EAAE,OAAO,CAAC,OAAO;YACxB,IAAI,EAAE,OAAO,CAAC,IAAI;YAClB,MAAM,EAAE,MAAM;SACf,CAAA;QAED,OAAO,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,EAAE,WAAW,CAAC,CAAC,OAAO,CAAC,GAAG,CACtD,CADwD,WAC5C,CAAC,SAAS,CAAC,CACxB,CAAA;IACH,CAAC;CACF"}},
    {"offset": {"line": 2546, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/app/analytics-node.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/app/analytics-node.ts"],"sourcesContent":["import { CoreAnalytics, bindAll, pTimeout } from '@segment/analytics-core'\nimport { AnalyticsSettings, validateSettings } from './settings'\nimport { version } from '../generated/version'\nimport { createConfiguredNodePlugin } from '../plugins/segmentio'\nimport { NodeEventFactory } from './event-factory'\nimport { Callback, dispatchAndEmit } from './dispatch-emit'\nimport { NodeEmitter } from './emitter'\nimport {\n  AliasParams,\n  GroupParams,\n  IdentifyParams,\n  PageParams,\n  TrackParams,\n  Plugin,\n  SegmentEvent,\n  FlushParams,\n  CloseAndFlushParams,\n} from './types'\nimport { Context } from './context'\nimport { NodeEventQueue } from './event-queue'\nimport { FetchHTTPClient } from '../lib/http-client'\n\nexport class Analytics extends NodeEmitter implements CoreAnalytics {\n  private readonly _eventFactory: NodeEventFactory\n  private _isClosed = false\n  private _pendingEvents = 0\n  private readonly _closeAndFlushDefaultTimeout: number\n  private readonly _publisher: ReturnType<\n    typeof createConfiguredNodePlugin\n  >['publisher']\n\n  private _isFlushing = false\n\n  private readonly _queue: NodeEventQueue\n\n  ready: Promise<void>\n\n  constructor(settings: AnalyticsSettings) {\n    super()\n    validateSettings(settings)\n\n    this._eventFactory = new NodeEventFactory()\n    this._queue = new NodeEventQueue()\n\n    const flushInterval = settings.flushInterval ?? 10000\n\n    this._closeAndFlushDefaultTimeout = flushInterval * 1.25 // add arbitrary multiplier in case an event is in a plugin.\n\n    const { plugin, publisher } = createConfiguredNodePlugin(\n      {\n        writeKey: settings.writeKey,\n        host: settings.host,\n        path: settings.path,\n        maxRetries: settings.maxRetries ?? 3,\n        flushAt: settings.flushAt ?? settings.maxEventsInBatch ?? 15,\n        httpRequestTimeout: settings.httpRequestTimeout,\n        disable: settings.disable,\n        flushInterval,\n        httpClient:\n          typeof settings.httpClient === 'function'\n            ? new FetchHTTPClient(settings.httpClient)\n            : settings.httpClient ?? new FetchHTTPClient(),\n        oauthSettings: settings.oauthSettings,\n      },\n      this as NodeEmitter\n    )\n    this._publisher = publisher\n\n    this.ready = this.register(plugin).then(() => undefined)\n\n    this.emit('initialize', settings)\n\n    bindAll(this)\n  }\n\n  get VERSION() {\n    return version\n  }\n\n  /**\n   * Call this method to stop collecting new events and flush all existing events.\n   * This method also waits for any event method-specific callbacks to be triggered,\n   * and any of their subsequent promises to be resolved/rejected.\n   */\n  public closeAndFlush({\n    timeout = this._closeAndFlushDefaultTimeout,\n  }: CloseAndFlushParams = {}): Promise<void> {\n    return this.flush({ timeout, close: true })\n  }\n\n  /**\n   * Call this method to flush all existing events..\n   * This method also waits for any event method-specific callbacks to be triggered,\n   * and any of their subsequent promises to be resolved/rejected.\n   */\n  public async flush({\n    timeout,\n    close = false,\n  }: FlushParams = {}): Promise<void> {\n    if (this._isFlushing) {\n      // if we're already flushing, then we don't need to do anything\n      console.warn(\n        'Overlapping flush calls detected. Please wait for the previous flush to finish before calling .flush again'\n      )\n      return\n    } else {\n      this._isFlushing = true\n    }\n    if (close) {\n      this._isClosed = true\n    }\n    this._publisher.flush(this._pendingEvents)\n    const promise = new Promise<void>((resolve) => {\n      if (!this._pendingEvents) {\n        resolve()\n      } else {\n        this.once('drained', () => {\n          resolve()\n        })\n      }\n    }).finally(() => {\n      this._isFlushing = false\n    })\n    return timeout ? pTimeout(promise, timeout).catch(() => undefined) : promise\n  }\n\n  private _dispatch(segmentEvent: SegmentEvent, callback?: Callback) {\n    if (this._isClosed) {\n      this.emit('call_after_close', segmentEvent as SegmentEvent)\n      return undefined\n    }\n\n    this._pendingEvents++\n\n    dispatchAndEmit(segmentEvent, this._queue, this, callback)\n      .catch((ctx) => ctx)\n      .finally(() => {\n        this._pendingEvents--\n\n        if (!this._pendingEvents) {\n          this.emit('drained')\n        }\n      })\n  }\n\n  /**\n   * Combines two unassociated user identities.\n   * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#alias\n   */\n  alias(\n    {\n      userId,\n      previousId,\n      context,\n      timestamp,\n      integrations,\n      messageId,\n    }: AliasParams,\n    callback?: Callback\n  ): void {\n    const segmentEvent = this._eventFactory.alias(userId, previousId, {\n      context,\n      integrations,\n      timestamp,\n      messageId,\n    })\n    this._dispatch(segmentEvent, callback)\n  }\n\n  /**\n   * Associates an identified user with a collective.\n   *  @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#group\n   */\n  group(\n    {\n      timestamp,\n      groupId,\n      userId,\n      anonymousId,\n      traits = {},\n      context,\n      integrations,\n      messageId,\n    }: GroupParams,\n    callback?: Callback\n  ): void {\n    const segmentEvent = this._eventFactory.group(groupId, traits, {\n      context,\n      anonymousId,\n      userId,\n      timestamp,\n      integrations,\n      messageId,\n    })\n\n    this._dispatch(segmentEvent, callback)\n  }\n\n  /**\n   * Includes a unique userId and (maybe anonymousId) and any optional traits you know about them.\n   * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#identify\n   */\n  identify(\n    {\n      userId,\n      anonymousId,\n      traits = {},\n      context,\n      timestamp,\n      integrations,\n      messageId,\n    }: IdentifyParams,\n    callback?: Callback\n  ): void {\n    const segmentEvent = this._eventFactory.identify(userId, traits, {\n      context,\n      anonymousId,\n      userId,\n      timestamp,\n      integrations,\n      messageId,\n    })\n    this._dispatch(segmentEvent, callback)\n  }\n\n  /**\n   * The page method lets you record page views on your website, along with optional extra information about the page being viewed.\n   * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#page\n   */\n  page(\n    {\n      userId,\n      anonymousId,\n      category,\n      name,\n      properties,\n      context,\n      timestamp,\n      integrations,\n      messageId,\n    }: PageParams,\n    callback?: Callback\n  ): void {\n    const segmentEvent = this._eventFactory.page(\n      category ?? null,\n      name ?? null,\n      properties,\n      { context, anonymousId, userId, timestamp, integrations, messageId }\n    )\n    this._dispatch(segmentEvent, callback)\n  }\n\n  /**\n   * Records screen views on your app, along with optional extra information\n   * about the screen viewed by the user.\n   *\n   * TODO: This is not documented on the segment docs ATM (for node).\n   */\n  screen(\n    {\n      userId,\n      anonymousId,\n      category,\n      name,\n      properties,\n      context,\n      timestamp,\n      integrations,\n      messageId,\n    }: PageParams,\n    callback?: Callback\n  ): void {\n    const segmentEvent = this._eventFactory.screen(\n      category ?? null,\n      name ?? null,\n      properties,\n      { context, anonymousId, userId, timestamp, integrations, messageId }\n    )\n\n    this._dispatch(segmentEvent, callback)\n  }\n\n  /**\n   * Records actions your users perform.\n   * @link https://segment.com/docs/connections/sources/catalog/libraries/server/node/#track\n   */\n  track(\n    {\n      userId,\n      anonymousId,\n      event,\n      properties,\n      context,\n      timestamp,\n      integrations,\n      messageId,\n    }: TrackParams,\n    callback?: Callback\n  ): void {\n    const segmentEvent = this._eventFactory.track(event, properties, {\n      context,\n      userId,\n      anonymousId,\n      timestamp,\n      integrations,\n      messageId,\n    })\n\n    this._dispatch(segmentEvent, callback)\n  }\n\n  /**\n   * Registers one or more plugins to augment Analytics functionality.\n   * @param plugins\n   */\n  register(...plugins: Plugin[]): Promise<void> {\n    return this._queue.criticalTasks.run(async () => {\n      const ctx = Context.system()\n\n      const registrations = plugins.map((xt) =>\n        this._queue.register(ctx, xt, this)\n      )\n      await Promise.all(registrations)\n      this.emit(\n        'register',\n        plugins.map((el) => el.name)\n      )\n    })\n  }\n\n  /**\n   * Deregisters one or more plugins based on their names.\n   * @param pluginNames - The names of one or more plugins to deregister.\n   */\n  async deregister(...pluginNames: string[]): Promise<void> {\n    const ctx = Context.system()\n\n    const deregistrations = pluginNames.map((pl) => {\n      const plugin = this._queue.plugins.find((p) => p.name === pl)\n      if (plugin) {\n        return this._queue.deregister(ctx, plugin, this)\n      } else {\n        ctx.log('warn', `plugin ${pl} not found`)\n      }\n    })\n\n    await Promise.all(deregistrations)\n    this.emit('deregister', pluginNames)\n  }\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2775, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/index.common.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/index.common.ts"],"sourcesContent":["export { Analytics } from './app/analytics-node'\nexport { Context } from './app/context'\nexport {\n  HTTPClient,\n  FetchHTTPClient,\n  HTTPFetchRequest,\n  HTTPResponse,\n  HTTPFetchFn,\n  HTTPClientRequest,\n} from './lib/http-client'\n\nexport { OAuthSettings } from './lib/types'\n\nexport type {\n  Plugin,\n  GroupTraits,\n  UserTraits,\n  TrackParams,\n  IdentifyParams,\n  AliasParams,\n  GroupParams,\n  PageParams,\n} from './app/types'\nexport type { AnalyticsSettings } from './app/settings'\n"],"names":[],"mappings":";AAAA,OAAO,EAAE,SAAS,EAAE,MAAM,sBAAsB,CAAA;AAChD,OAAO,EAAE,OAAO,EAAE,MAAM,eAAe,CAAA;AACvC,OAAO,EAEL,eAAe,GAKhB,MAAM,mBAAmB,CAAA"}},
    {"offset": {"line": 2786, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-node/dist/esm/index.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-node/src/index.ts"],"sourcesContent":["export * from './index.common'\n\n// export Analytics as both a named export and a default export (for backwards-compat. reasons)\nimport { Analytics } from './index.common'\nexport default Analytics\n"],"names":[],"mappings":";;;;AAAA,cAAc,gBAAgB,CAAA;AAE9B,+FAA+F;AAC/F,OAAO,EAAE,SAAS,EAAE,MAAM,gBAAgB,CAAA;;;uCAC3B,wMAAS,CAAA"}},
    {"offset": {"line": 2833, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-generic-utils/dist/esm/create-deferred/create-deferred.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-generic-utils/src/create-deferred/create-deferred.ts"],"sourcesContent":["/**\n * Return a promise that can be externally resolved\n */\nexport const createDeferred = <T>() => {\n  let resolve!: (value: T | PromiseLike<T>) => void\n  let reject!: (reason: any) => void\n  let settled = false\n  const promise = new Promise<T>((_resolve, _reject) => {\n    resolve = (...args) => {\n      settled = true\n      _resolve(...args)\n    }\n    reject = (...args) => {\n      settled = true\n      _reject(...args)\n    }\n  })\n\n  return {\n    resolve,\n    reject,\n    promise,\n    isSettled: () => settled,\n  }\n}\n"],"names":[],"mappings":"AAAA;;GAEG;;;;AACI,IAAM,cAAc,GAAG;IAC5B,IAAI,OAA6C,CAAA;IACjD,IAAI,MAA8B,CAAA;IAClC,IAAI,OAAO,GAAG,KAAK,CAAA;IACnB,IAAM,OAAO,GAAG,IAAI,OAAO,CAAI,SAAC,QAAQ,EAAE,OAAO;QAC/C,OAAO,GAAG;YAAC,IAAA,OAAA,EAAA,CAAO;gBAAP,IAAA,KAAA,CAAO,EAAP,KAAA,UAAA,MAAO,EAAP,IAAO,CAAA;gBAAP,IAAA,CAAA,GAAA,GAAA,SAAA,CAAA,GAAA,CAAO;;YAChB,OAAO,GAAG,IAAI,CAAA;YACd,QAAQ,CAAA,KAAA,CAAA,KAAA,GAAI,IAAI,EAAC;QACnB,CAAC,CAAA;QACD,MAAM,GAAG;YAAC,IAAA,OAAA,EAAA,CAAO;gBAAP,IAAA,KAAA,CAAO,EAAP,KAAA,UAAA,MAAO,EAAP,IAAO,CAAA;gBAAP,IAAA,CAAA,GAAA,GAAA,SAAA,CAAA,GAAA,CAAO;;YACf,OAAO,GAAG,IAAI,CAAA;YACd,OAAO,CAAA,KAAA,CAAA,KAAA,GAAI,IAAI,EAAC;QAClB,CAAC,CAAA;IACH,CAAC,CAAC,CAAA;IAEF,OAAO;QACL,OAAO,EAAA,OAAA;QACP,MAAM,EAAA,MAAA;QACN,OAAO,EAAA,OAAA;QACP,SAAS,EAAE;YAAM,OAAA,OAAO;QAAP,CAAO;KACzB,CAAA;AACH,CAAC,CAAA"}},
    {"offset": {"line": 2874, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@segment/analytics-generic-utils/dist/esm/emitter/emitter.js","sources":["file:///Volumes/External/dev/Projects/Work%20Projects/RAG/new_rag/questions/node_modules/%40segment/analytics-generic-utils/src/emitter/emitter.ts"],"sourcesContent":["type EventName = string\ntype EventFnArgs = any[]\ntype EmitterContract = Record<EventName, EventFnArgs>\n\nexport interface EmitterOptions {\n  /** How many event listeners for a particular event before emitting a warning (0 = disabled)\n   *  @default 10\n   **/\n  maxListeners?: number\n}\n\n/**\n * Event Emitter that takes the expected contract as a generic\n * @example\n * ```ts\n *  type Contract = {\n *    delivery_success: [DeliverySuccessResponse, Metrics],\n *    delivery_failure: [DeliveryError]\n * }\n *  new Emitter<Contract>()\n *  .on('delivery_success', (res, metrics) => ...)\n *  .on('delivery_failure', (err) => ...)\n * ```\n */\nexport class Emitter<Contract extends EmitterContract = EmitterContract> {\n  maxListeners: number\n  constructor(options?: EmitterOptions) {\n    this.maxListeners = options?.maxListeners ?? 10\n  }\n  private callbacks: Partial<Contract> = {}\n  private warned = false\n\n  private warnIfPossibleMemoryLeak<EventName extends keyof Contract>(\n    event: EventName\n  ) {\n    if (this.warned) {\n      return\n    }\n    if (\n      this.maxListeners &&\n      this.callbacks[event]!.length > this.maxListeners\n    ) {\n      console.warn(\n        `Event Emitter: Possible memory leak detected; ${String(\n          event\n        )} has exceeded ${this.maxListeners} listeners.`\n      )\n      this.warned = true\n    }\n  }\n\n  on<EventName extends keyof Contract>(\n    event: EventName,\n    callback: (...args: Contract[EventName]) => void\n  ): this {\n    if (!this.callbacks[event]) {\n      this.callbacks[event] = [callback] as Contract[EventName]\n    } else {\n      this.callbacks[event]!.push(callback)\n      this.warnIfPossibleMemoryLeak(event)\n    }\n    return this\n  }\n\n  once<EventName extends keyof Contract>(\n    event: EventName,\n    callback: (...args: Contract[EventName]) => void\n  ): this {\n    const on = (...args: Contract[EventName]): void => {\n      this.off(event, on)\n      callback.apply(this, args)\n    }\n\n    this.on(event, on)\n    return this\n  }\n\n  off<EventName extends keyof Contract>(\n    event: EventName,\n    callback: (...args: Contract[EventName]) => void\n  ): this {\n    const fns = this.callbacks[event] ?? []\n    const without = fns.filter((fn) => fn !== callback) as Contract[EventName]\n    this.callbacks[event] = without\n    return this\n  }\n\n  emit<EventName extends keyof Contract>(\n    event: EventName,\n    ...args: Contract[EventName]\n  ): this {\n    const callbacks = this.callbacks[event] ?? []\n    callbacks.forEach((callback) => {\n      callback.apply(this, args)\n    })\n    return this\n  }\n}\n"],"names":[],"mappings":"AAWA;;;;;;;;;;;;GAYG;;;;AACH,IAAA,UAAA;IAEE,SAAA,QAAY,OAAwB;;QAG5B,IAAA,CAAA,SAAS,GAAsB,CAAA,CAAE,CAAA;QACjC,IAAA,CAAA,MAAM,GAAG,KAAK,CAAA;QAHpB,IAAI,CAAC,YAAY,GAAG,CAAA,KAAA,OAAO,KAAA,QAAP,OAAO,KAAA,KAAA,IAAA,KAAA,IAAP,OAAO,CAAE,YAAY,MAAA,QAAA,OAAA,KAAA,IAAA,KAAI,EAAE,CAAA;IACjD,CAAC;IAIO,QAAA,SAAA,CAAA,wBAAwB,GAAhC,SACE,KAAgB;QAEhB,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,OAAM;SACP;QACD,IACE,IAAI,CAAC,YAAY,IACjB,IAAI,CAAC,SAAS,CAAC,KAAK,CAAE,CAAC,MAAM,GAAG,IAAI,CAAC,YAAY,EACjD;YACA,OAAO,CAAC,IAAI,CACV,iDAAA,MAAA,CAAiD,MAAM,CACrD,KAAK,CACN,EAAA,kBAAA,MAAA,CAAiB,IAAI,CAAC,YAAY,EAAA,cAAa,CACjD,CAAA;YACD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;SACnB;IACH,CAAC;IAED,QAAA,SAAA,CAAA,EAAE,GAAF,SACE,KAAgB,EAChB,QAAgD;QAEhD,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;YAC1B,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG;gBAAC,QAAQ;aAAwB,CAAA;SAC1D,MAAM;YACL,IAAI,CAAC,SAAS,CAAC,KAAK,CAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAA;YACrC,IAAI,CAAC,wBAAwB,CAAC,KAAK,CAAC,CAAA;SACrC;QACD,OAAO,IAAI,CAAA;IACb,CAAC;IAED,QAAA,SAAA,CAAA,IAAI,GAAJ,SACE,KAAgB,EAChB,QAAgD;QAFlD,IAAA,QAAA,IAAA,CAWC;QAPC,IAAM,EAAE,GAAG;YAAC,IAAA,OAAA,EAAA,CAA4B;gBAA5B,IAAA,KAAA,CAA4B,EAA5B,KAAA,UAAA,MAA4B,EAA5B,IAA4B,CAAA;gBAA5B,IAAA,CAAA,GAAA,GAAA,SAAA,CAAA,GAAA,CAA4B;;YACtC,KAAI,CAAC,GAAG,CAAC,KAAK,EAAE,EAAE,CAAC,CAAA;YACnB,QAAQ,CAAC,KAAK,CAAC,KAAI,EAAE,IAAI,CAAC,CAAA;QAC5B,CAAC,CAAA;QAED,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,CAAA;QAClB,OAAO,IAAI,CAAA;IACb,CAAC;IAED,QAAA,SAAA,CAAA,GAAG,GAAH,SACE,KAAgB,EAChB,QAAgD;;QAEhD,IAAM,GAAG,GAAG,CAAA,KAAA,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAA,QAAA,OAAA,KAAA,IAAA,KAAI,EAAE,CAAA;QACvC,IAAM,OAAO,GAAG,GAAG,CAAC,MAAM,CAAC,SAAC,EAAE;YAAK,OAAA,EAAE,KAAK,QAAQ;QAAf,CAAe,CAAwB,CAAA;QAC1E,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,OAAO,CAAA;QAC/B,OAAO,IAAI,CAAA;IACb,CAAC;IAED,QAAA,SAAA,CAAA,IAAI,GAAJ,SACE,KAAgB;QADlB,IAAA,QAAA,IAAA,CASC;;QAPC,IAAA,OAAA,EAAA,CAA4B;YAA5B,IAAA,KAAA,CAA4B,EAA5B,KAAA,UAAA,MAA4B,EAA5B,IAA4B,CAAA;YAA5B,IAAA,CAAA,KAAA,EAAA,GAAA,SAAA,CAAA,GAAA,CAA4B;;QAE5B,IAAM,SAAS,GAAG,CAAA,KAAA,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,MAAA,QAAA,OAAA,KAAA,IAAA,KAAI,EAAE,CAAA;QAC7C,SAAS,CAAC,OAAO,CAAC,SAAC,QAAQ;YACzB,QAAQ,CAAC,KAAK,CAAC,KAAI,EAAE,IAAI,CAAC,CAAA;QAC5B,CAAC,CAAC,CAAA;QACF,OAAO,IAAI,CAAA;IACb,CAAC;IACH,OAAA,OAAC;AAAD,CAAC,AAzED,IAyEC"}}]
}