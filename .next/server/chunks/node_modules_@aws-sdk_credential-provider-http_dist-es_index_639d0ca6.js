module.exports=[838788,e=>{"use strict";e.s([],197329),e.i(197329);var t=e.i(609212),r=e.i(184912),o=e.i(60400),n=e.i(924868),s=e.i(389073),a=e.i(19898),i=e.i(845786);async function l(e,t){let r=(0,i.sdkStreamMixin)(e.body),n=await r.transformToString();if(200===e.statusCode){let e=JSON.parse(n);if("string"!=typeof e.AccessKeyId||"string"!=typeof e.SecretAccessKey||"string"!=typeof e.Token||"string"!=typeof e.Expiration)throw new o.CredentialsProviderError("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:t});return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:(0,a.parseRfc3339DateTime)(e.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let r={};try{r=JSON.parse(n)}catch(e){}throw Object.assign(new o.CredentialsProviderError(`Server responded with status: ${e.statusCode}`,{logger:t}),{Code:r.Code,Message:r.Message})}throw new o.CredentialsProviderError(`Server responded with status: ${e.statusCode}`,{logger:t})}e.s(["fromHttp",0,(e={})=>{let a,i,c,d;e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");let h=e.awsContainerCredentialsRelativeUri??process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI,p=e.awsContainerCredentialsFullUri??process.env.AWS_CONTAINER_CREDENTIALS_FULL_URI,u=e.awsContainerAuthorizationToken??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN,w=e.awsContainerAuthorizationTokenFile??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE,C=e.logger?.constructor?.name!=="NoOpLogger"&&e.logger?.warn?e.logger.warn.bind(e.logger):console.warn;if(h&&p&&(C("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),C("awsContainerCredentialsFullUri will take precedence.")),u&&w&&(C("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),C("awsContainerAuthorizationToken will take precedence.")),p)a=p;else if(h)a=`http://169.254.170.2${h}`;else throw new o.CredentialsProviderError(`No HTTP credential provider host provided.
Set AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.`,{logger:e.logger});let g=new URL(a);((e,t)=>{if("https:"!==e.protocol&&"169.254.170.2"!==e.hostname&&"169.254.170.23"!==e.hostname&&"[fd00:ec2::23]"!==e.hostname){if(e.hostname.includes("[")){if("[::1]"===e.hostname||"[0000:0000:0000:0000:0000:0000:0000:0001]"===e.hostname)return}else{if("localhost"===e.hostname)return;let t=e.hostname.split("."),r=e=>{let t=parseInt(e,10);return 0<=t&&t<=255};if("127"===t[0]&&r(t[1])&&r(t[2])&&r(t[3])&&4===t.length)return}throw new o.CredentialsProviderError(`URL not accepted. It must either be HTTPS or match one of the following:
  - loopback CIDR 127.0.0.0/8 or [::1/128]
  - ECS container host 169.254.170.2
  - EKS container host 169.254.170.23 or [fd00:ec2::23]`,{logger:t})}})(g,e.logger);let T=r.NodeHttpHandler.create({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return i=async()=>{let r=new s.HttpRequest({protocol:g.protocol,hostname:g.hostname,port:Number(g.port),path:g.pathname,query:Array.from(g.searchParams.entries()).reduce((e,[t,r])=>(e[t]=r,e),{}),fragment:g.hash});u?r.headers.Authorization=u:w&&(r.headers.Authorization=(await n.default.readFile(w)).toString());try{let e=await T.handle(r);return l(e.response).then(e=>(0,t.setCredentialFeature)(e,"CREDENTIALS_HTTP","z"))}catch(t){throw new o.CredentialsProviderError(String(t),{logger:e.logger})}},c=e.maxRetries??3,d=e.timeout??1e3,async()=>{for(let e=0;e<c;++e)try{return await i()}catch(e){await new Promise(e=>setTimeout(e,d))}return await i()}}],838788)}];

//# sourceMappingURL=node_modules_%40aws-sdk_credential-provider-http_dist-es_index_639d0ca6.js.map