module.exports=[826709,e=>{"use strict";e.s([],223957),e.i(223957);var r=e.i(60400),i=e.i(881355),o=e.i(861981),s=e.i(876535);let t=e=>e&&("string"==typeof e.sso_start_url||"string"==typeof e.sso_account_id||"string"==typeof e.sso_session||"string"==typeof e.sso_region||"string"==typeof e.sso_role_name);e.s(["isSsoProfile",0,t],970487);var n=e.i(609212),l=e.i(713308),a=e.i(823897);let g=async({ssoStartUrl:i,ssoSession:o,ssoAccountId:s,ssoRegion:t,ssoRoleName:g,ssoClient:f,clientConfig:d,parentClientConfig:c,profile:h,filepath:p,configFilepath:u,ignoreCache:w,logger:S})=>{let _,C,m="To refresh this SSO session run aws sso login with the corresponding profile.";if(o)try{let e=await (0,l.fromSso)({profile:h,filepath:p,configFilepath:u,ignoreCache:w})();_={accessToken:e.token,expiresAt:new Date(e.expiration).toISOString()}}catch(e){throw new r.CredentialsProviderError(e.message,{tryNextLink:!1,logger:S})}else try{_=await (0,a.getSSOTokenFromFile)(i)}catch(e){throw new r.CredentialsProviderError(`The SSO session associated with this profile is invalid. ${m}`,{tryNextLink:!1,logger:S})}if(new Date(_.expiresAt).getTime()-Date.now()<=0)throw new r.CredentialsProviderError(`The SSO session associated with this profile has expired. ${m}`,{tryNextLink:!1,logger:S});let{accessToken:y}=_,{SSOClient:v,GetRoleCredentialsCommand:P}=await e.A(694624),O=f||new v(Object.assign({},d??{},{logger:d?.logger??c?.logger,region:d?.region??t,userAgentAppId:d?.userAgentAppId??c?.userAgentAppId}));try{C=await O.send(new P({accountId:s,roleName:g,accessToken:y}))}catch(e){throw new r.CredentialsProviderError(e,{tryNextLink:!1,logger:S})}let{roleCredentials:{accessKeyId:k,secretAccessKey:A,sessionToken:E,expiration:x,credentialScope:N,accountId:L}={}}=C;if(!k||!A||!E||!x)throw new r.CredentialsProviderError("SSO returns an invalid temporary credential.",{tryNextLink:!1,logger:S});let I={accessKeyId:k,secretAccessKey:A,sessionToken:E,expiration:new Date(x),...N&&{credentialScope:N},...L&&{accountId:L}};return o?(0,n.setCredentialFeature)(I,"CREDENTIALS_SSO","s"):(0,n.setCredentialFeature)(I,"CREDENTIALS_SSO_LEGACY","u"),I},f=(e,i)=>{let{sso_start_url:o,sso_account_id:s,sso_region:t,sso_role_name:n}=e;if(!o||!s||!t||!n)throw new r.CredentialsProviderError(`Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got ${Object.keys(e).join(", ")}
Reference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html`,{tryNextLink:!1,logger:i});return e};e.s(["validateSsoProfile",0,f],661980);let d=(e={})=>async({callerClientConfig:n}={})=>{e.logger?.debug("@aws-sdk/credential-provider-sso - fromSSO");let{ssoStartUrl:l,ssoAccountId:a,ssoRegion:d,ssoRoleName:c,ssoSession:h}=e,{ssoClient:p}=e,u=(0,i.getProfileName)({profile:e.profile??n?.profile});if(l||a||d||c||h)if(l&&a&&d&&c)return g({ssoStartUrl:l,ssoSession:h,ssoAccountId:a,ssoRegion:d,ssoRoleName:c,ssoClient:p,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,profile:u,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger});else throw new r.CredentialsProviderError('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"',{tryNextLink:!1,logger:e.logger});{let i=(await (0,s.parseKnownFiles)(e))[u];if(!i)throw new r.CredentialsProviderError(`Profile ${u} was not found.`,{logger:e.logger});if(!t(i))throw new r.CredentialsProviderError(`Profile ${u} is not configured with SSO credentials.`,{logger:e.logger});if(i?.sso_session){let s=(await (0,o.loadSsoSessionData)(e))[i.sso_session],t=` configurations in profile ${u} and sso-session ${i.sso_session}`;if(d&&d!==s.sso_region)throw new r.CredentialsProviderError("Conflicting SSO region"+t,{tryNextLink:!1,logger:e.logger});if(l&&l!==s.sso_start_url)throw new r.CredentialsProviderError("Conflicting SSO start_url"+t,{tryNextLink:!1,logger:e.logger});i.sso_region=s.sso_region,i.sso_start_url=s.sso_start_url}let{sso_start_url:n,sso_account_id:a,sso_region:c,sso_role_name:h,sso_session:w}=f(i,e.logger);return g({ssoStartUrl:n,ssoSession:w,ssoAccountId:a,ssoRegion:c,ssoRoleName:h,ssoClient:p,clientConfig:e.clientConfig,parentClientConfig:e.parentClientConfig,profile:u,filepath:e.filepath,configFilepath:e.configFilepath,ignoreCache:e.ignoreCache,logger:e.logger})}};e.s(["fromSSO",0,d],375670),e.i(375670),e.i(970487),e.s([],10105),e.i(10105),e.i(661980),e.s(["fromSSO",0,d,"isSsoProfile",0,t,"validateSsoProfile",0,f],826709)},694624,e=>{e.v(r=>Promise.all(["server/chunks/a9bf9_@smithy_core_dist-es_util-identity-and-auth_httpAuthSchemes_noAuth_4c92f3ab.js","server/chunks/node_modules_@aws-sdk_6f97efc0._.js"].map(r=>e.l(r))).then(()=>r(756690)))}];

//# sourceMappingURL=node_modules_%40aws-sdk_credential-provider-sso_dist-es_31d9426a._.js.map